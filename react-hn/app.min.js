!function e(t,n,s){function i(r,a){if(!n[r]){if(!t[r]){var m="function"==typeof require&&require;if(!a&&m)return m(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){var n=t[r][1][e];return i(n?n:e)},d,d.exports,e,t,n,s)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)i(s[r]);return i}({1:[function(e){"use strict";e("setimmediate");var t=e("react"),n=e("react-router"),s=e("./stores/TopStore"),i=e("./stores/UpdatesStore"),o=e("./stores/SettingsStore"),r=e("./PermalinkedComment"),a=e("./Item"),m=e("./Settings"),l=e("./TopStories"),d=e("./Updates"),c=e("./UserProfile"),u=n.DefaultRoute,p=n.Link,h=n.NotFoundRoute,f=n.Route,C=n.Routes,g=t.createClass({displayName:"App",getInitialState:function(){return{showSettings:!1}},componentWillMount:function(){o.load(),s.loadSession(),i.loadSession(),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},handleBeforeUnload:function(){s.stop(),s.saveSession(),i.saveSession()},toggleSettings:function(e){e.preventDefault(),this.setState({showSettings:!this.state.showSettings})},render:function(){return t.DOM.div({className:"App"},t.DOM.div({className:"App__header"},t.DOM.img({src:"logo.png",width:"16",height:"16",alt:""})," ",p({to:"news",className:"App__homelink"},"React HN")," ",p({to:"newest"},"new")," | ",p({to:"newcomments"},"comments"),t.DOM.a({className:"App__settings",tabIndex:"0",onClick:this.toggleSettings,onKeyPress:this.toggleSettings},this.state.showSettings?"hide settings":"settings"),this.state.showSettings&&m({key:"settings"})),t.DOM.div({className:"App__content"},this.props.activeRouteHandler(null)),t.DOM.div({className:"App__footer"},"react-hn v","0.1.0"," | ",t.DOM.a({href:"https://github.com/insin/react-hn"},"insin/react-hn")))}}),v=t.createClass({displayName:"NotFound",render:function(){return t.DOM.h2(null,"Not found")}}),S=C({location:"hash"},f({name:"app",path:"/",handler:g},u({handler:l}),h({handler:v}),f({name:"news",path:"news",handler:l}),f({name:"item",path:"item/:id",handler:a}),f({name:"job",path:"job/:id",handler:a}),f({name:"poll",path:"poll/:id",handler:a}),f({name:"story",path:"story/:id",handler:a}),f({name:"comment",path:"comment/:id",handler:r}),f({name:"newest",path:"newest",handler:d,type:"links"}),f({name:"newcomments",path:"newcomments",handler:d,type:"comments"}),f({name:"user",path:"user/:id",handler:c})));window.React=t,t.renderComponent(S,document.getElementById("app"))},{"./Item":5,"./PermalinkedComment":7,"./Settings":9,"./TopStories":11,"./Updates":13,"./UserProfile":14,"./stores/SettingsStore":22,"./stores/TopStore":24,"./stores/UpdatesStore":25,react:"react","react-router":"react-router",setimmediate:34}],2:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./stores/CommentThreadStore"),o=e("./services/HNService"),r=e("./stores/SettingsStore"),a=e("./mixins/CommentMixin"),m=e("./utils/buildClassName"),l=n.createClass({displayName:"Comment",mixins:[a,s],propTypes:{id:n.PropTypes.number.isRequired,level:n.PropTypes.number.isRequired,loadingSpinner:n.PropTypes.bool,threadStore:n.PropTypes.instanceOf(i).isRequired},getDefaultProps:function(){return{loadingSpinner:!1}},getInitialState:function(){return{comment:{}}},componentWillMount:function(){this.bindFirebaseRef()},componentWillUnmount:function(){this.clearDelayTimeout()},componentDidUpdate:function(e,t){if(t.comment.id){if(!t.comment.deleted&&this.state.comment.deleted&&this.props.threadStore.commentDeleted(this.state.comment),!t.comment.dead&&this.state.comment.dead)this.props.threadStore.commentDied(this.state.comment);else if(t.comment!==this.state.comment&&this.props.threadStore.loading){var n=this.state.comment.kids?this.state.comment.kids.length:0,s=t.comment.kids?t.comment.kids.length:0;this.props.threadStore.adjustExpectedComments(n-s)}}else this.state.comment.id&&(t.comment.delayed&&this.clearDelayTimeout(),this.props.threadStore.commentAdded(this.state.comment)),!t.comment.delayed&&this.state.comment.delayed&&this.props.threadStore.commentDelayed(this.props.id)},bindFirebaseRef:function(){this.bindAsObject(o.itemRef(this.props.id),"comment",this.handleFirebaseRefCancelled),this.timeout&&(this.timeout=null)},handleFirebaseRefCancelled:function(e){this.unbind("comment"),this.timeout=setTimeout(this.bindFirebaseRef,3e4),this.state.comment.delayed||(this.state.comment.delayed=!0,this.forceUpdate())},clearDelayTimeout:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},toggleCollapse:function(e){e.preventDefault(),this.props.threadStore.toggleCollapse(this.state.comment.id)},render:function(){var e=this.state.comment,t=this.props;if(!e.id)return this.renderCommentLoading(e);if(e.deleted)return r.showDeleted?this.renderCommentDeleted(e,{className:"Comment Comment--deleted Comment--level"+t.level}):null;var s=t.threadStore.isNew[e.id],i=!!t.threadStore.isCollapsed[e.id],o=i&&t.threadStore.getChildCounts(e);i&&s&&(o.newComments=0);var a=m("Comment Comment--level"+t.level,{"Comment--collapsed":i,"Comment--dead":e.dead,"Comment--new":s});return n.DOM.div({className:a},n.DOM.div({className:"Comment__content"},this.renderCommentMeta(e,{collapsible:!0,collapsed:i,link:!0,childCounts:o}),(!e.dead||r.showDead)&&this.renderCommentText(e)),e.kids&&n.DOM.div({className:"Comment__kids"},e.kids.map(function(e){return l({key:e,id:e,level:t.level+1,loadingSpinner:t.loadingSpinner,threadStore:t.threadStore})})))}});t.exports=l},{"./mixins/CommentMixin":15,"./services/HNService":19,"./stores/CommentThreadStore":20,"./stores/SettingsStore":22,"./utils/buildClassName":26,react:"react",reactfire:"reactfire"}],3:[function(e,t){"use strict";var n=e("react"),s=e("./stores/SettingsStore"),i=e("./mixins/CommentMixin"),o=e("./utils/buildClassName"),r=n.createClass({displayName:"DisplayComment",mixins:[i],propTypes:{comment:n.PropTypes.object.isRequired},getInitialState:function(){return{op:{},parent:{type:"comment"}}},componentWillMount:function(){this.fetchAncestors(this.props.comment)},render:function(){if(this.props.comment.deleted)return null;if(this.props.comment.dead&&!s.showDead)return null;var e=this.props.comment,t=o("Comment Comment--level0",{"Comment--dead":e.dead});return n.DOM.div({className:t},n.DOM.div({className:"Comment__content"},this.renderCommentMeta(e,{link:!0,parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!=this.state.op.id,op:!!this.state.op.id}),this.renderCommentText(e)))}});t.exports=r},{"./mixins/CommentMixin":15,"./stores/SettingsStore":22,"./utils/buildClassName":26,react:"react"}],4:[function(e,t){"use strict";var n=e("react"),s=e("./stores/StoryCommentThreadStore"),i=e("./mixins/ItemMixin"),o=e("./mixins/ListItemMixin"),r=n.createClass({displayName:"DisplayListItem",mixins:[i,o],propTypes:{item:n.PropTypes.object.isRequired},componentWillMount:function(){this.threadState=s.loadState(this.props.item.id)},render:function(){return this.renderListItem(this.props.item,this.threadState)}});t.exports=r},{"./mixins/ItemMixin":16,"./mixins/ListItemMixin":17,"./stores/StoryCommentThreadStore":23,react:"react"}],5:[function(e,t){"use strict";function n(e){return e.fromNow(!0).replace(/^an? /,"")}var s=e("react"),i=e("reactfire"),o=e("./services/HNService"),r=e("./stores/StoryCommentThreadStore"),a=e("./stores/ItemStore"),m=e("./Comment"),l=e("./PollOption"),d=e("./Spinner"),c=e("./mixins/ItemMixin"),u=e("./utils/buildClassName"),p=e("./utils/setTitle"),h=s.createClass({displayName:"Item",mixins:[c,i],getInitialState:function(){return{item:a.getCachedStory(Number(this.props.params.id))||{}}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.params.id),"item"),this.state.item.id&&(this.threadStore=new r(this.state.item,this.handleCommentsChanged,{cached:!0}),p(this.state.item.title)),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){this.threadStore.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillReceiveProps:function(e){if(this.props.params.id!=e.params.id){this.threadStore.dispose(),this.threadStore=null,this.unbind("item");var t=a.getCachedStory(Number(e.params.id));t&&(this.threadStore=new r(t,this.handleCommentsChanged,{cached:!0}),p(t.title)),this.bindAsObject(o.itemRef(e.params.id),"item"),this.setState({item:t||{}})}},componentWillUpdate:function(e,t){!this.state.item.id&&t.item.id&&p(t.item.title)},componentDidUpdate:function(e,t){if(t.item.id!=this.state.item.id)this.threadStore&&this.threadStore.itemId==this.state.item.id||(this.threadStore=new r(this.state.item,this.handleCommentsChanged,{cached:!1}),p(this.state.item.title),this.forceUpdate());else if(t.item!==this.state.item&&this.threadStore.loading){var n=this.state.item.kids?this.state.item.kids.length:0,s=t.item.kids?t.item.kids.length:0;this.threadStore.adjustExpectedComments(n-s)}},handleBeforeUnload:function(){this.threadStore.dispose()},handleCommentsChanged:function(){this.forceUpdate()},autoCollapse:function(e){e.preventDefault(),this.threadStore.collapseThreadsWithoutNewComments()},markAsRead:function(e){e.preventDefault(),this.threadStore.markAsRead(),this.forceUpdate()},render:function(){var e=this.state,t=e.item,i=this.threadStore;return t.id&&i?s.DOM.div({className:u("Item",{"Item--dead":t.dead})},s.DOM.div({className:"Item__content"},this.renderItemTitle(t),this.renderItemMeta(t,i,null!==i.lastVisit&&i.newCommentCount>0&&s.DOM.span(null," ","(",s.DOM.em(null,i.newCommentCount," new")," in the last ",n(i.lastVisit),") | ",s.DOM.span({className:"control",tabIndex:"0",onClick:this.autoCollapse,onKeyPress:this.autoCollapse,title:"Collapse threads without new comments"},"auto collapse")," | ",s.DOM.span({className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),t.text&&s.DOM.div({className:"Item__text"},s.DOM.div({dangerouslySetInnerHTML:{__html:t.text}})),"poll"==t.type&&s.DOM.div({className:"Item__poll"},t.parts.map(function(e){return l({key:e,id:e})}))),t.kids&&s.DOM.div({className:"Item__kids"},t.kids.map(function(e,t){return m({key:e,id:e,level:0,loadingSpinner:0===t,threadStore:i})}))):s.DOM.div({className:"Item Item--loading"},d({size:"20"}))}});t.exports=h},{"./Comment":2,"./PollOption":8,"./Spinner":10,"./mixins/ItemMixin":16,"./services/HNService":19,"./stores/ItemStore":21,"./stores/StoryCommentThreadStore":23,"./utils/buildClassName":26,"./utils/setTitle":32,react:"react",reactfire:"reactfire"}],6:[function(e,t){"use strict";var n=e("react"),s=e("react-router"),i=s.Link,o=n.createClass({displayName:"Paginator",render:function(){return 1!=this.props.page||this.props.hasNext?n.DOM.div({className:"Paginator"},this.props.page>1&&n.DOM.span({className:"Paginator__prev"},i({to:this.props.route,query:{page:this.props.page-1}},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&n.DOM.span({className:"Paginator__next"},i({to:this.props.route,query:{page:this.props.page+1}},"More"))):null}});t.exports=o},{react:"react","react-router":"react-router"}],7:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("react-router"),o=e("./stores/CommentThreadStore"),r=e("./services/HNService"),a=e("./stores/SettingsStore"),m=e("./stores/UpdatesStore"),l=e("./Comment"),d=e("./mixins/CommentMixin"),c=e("./utils/buildClassName"),u=e("./utils/setTitle"),p=i.Navigation,h=n.createClass({displayName:"PermalinkedComment",mixins:[d,s,p],getDefaultProps:function(){return{level:0}},getInitialState:function(){return{comment:m.getComment(this.props.params.id)||{},parent:{type:"comment"},op:{}}},componentWillMount:function(){this.bindAsObject(r.itemRef(this.props.params.id),"comment"),this.state.comment.id&&this.commentLoaded(this.state.comment)},componentWillReceiveProps:function(e){if(e.params.id!=this.props.params.id){var t=m.getComment(e.params.id);t&&(this.commentLoaded(t),this.setState({comment:t})),this.unbind("comment"),this.bindAsObject(r.itemRef(e.params.id),"comment")}},componentWillUpdate:function(e,t){if(this.state.comment.id!=t.comment.id){if(!t.comment.deleted&&"comment"!=t.comment.type)return void this.replaceWith(t.comment.type,{id:t.comment.id});this.threadStore&&this.threadStore.itemId==t.comment.id||this.commentLoaded(t.comment)}},commentLoaded:function(e){this.setTitle(e),e.deleted||(this.threadStore=new o(e,this.handleCommentsChanged),this.fetchAncestors(e))},setTitle:function(e){if(e.deleted)return u("Deleted comment");var t="Comment by "+e.by;this.state.op.id&&(t+=" | "+this.state.op.title),u(t)},handleCommentsChanged:function(e){"collapse"==e.type&&this.forceUpdate()},render:function(){var e=this.state.comment;if(!e.id)return this.renderCommentLoading(e);if(e.deleted)return this.renderCommentDeleted(e,{className:"Comment Comment--level0 Comment--deleted"});if("comment"!=e.type)return null;var t=c("PermalinkedComment Comment Comment--level0",{"Comment--dead":e.dead}),s=this.threadStore;return n.DOM.div({className:t},n.DOM.div({className:"Comment__content"},this.renderCommentMeta(e,{parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!=this.state.op.id,op:!!this.state.op.id}),(!e.dead||a.showDead)&&this.renderCommentText(e)),e.kids&&n.DOM.div({className:"Comment__kids"},e.kids.map(function(e,t){return l({key:e,id:e,level:0,loadingSpinner:0===t,threadStore:s})})))}});t.exports=h},{"./Comment":2,"./mixins/CommentMixin":15,"./services/HNService":19,"./stores/CommentThreadStore":20,"./stores/SettingsStore":22,"./stores/UpdatesStore":25,"./utils/buildClassName":26,"./utils/setTitle":32,react:"react","react-router":"react-router",reactfire:"reactfire"}],8:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./services/HNService"),o=e("./Spinner"),r=e("./utils/pluralise"),a=n.createClass({displayName:"PollOption",mixins:[s],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(i.itemRef(this.props.id),"pollopt")},render:function(){var e=this.state.pollopt;return e.id?n.DOM.div({className:"PollOption"},n.DOM.div({className:"PollOption__text"},e.text),n.DOM.div({className:"PollOption__score"},e.score," point",r(e.score))):n.DOM.div({className:"PollOption PollOption--loading"},o({size:"20"}))}});t.exports=a},{"./Spinner":10,"./services/HNService":19,"./utils/pluralise":31,react:"react",reactfire:"reactfire"}],9:[function(e,t){"use strict";var n=e("react"),s=e("./stores/SettingsStore"),i=n.createClass({displayName:"Settings",componentDidMount:function(){this.refs.container.getDOMNode().focus()},onChange:function(e){s[e.target.name]=e.target.checked,this.forceUpdate(),s.save()},render:function(){return n.DOM.div({ref:"container",className:"Settings",tabIndex:"-1"},n.DOM.form({onChange:this.onChange},n.DOM.div({className:"Settings__setting Settings__setting--checkbox"},n.DOM.label({htmlFor:"autoCollapse"},n.DOM.input({type:"checkbox",name:"autoCollapse",id:"autoCollapse",checked:s.autoCollapse})," auto collapse"),n.DOM.p(null,"Automatically collapse comment threads without new comments on page load.")),n.DOM.div({className:"Settings__setting Settings__setting--checkbox"},n.DOM.label({htmlFor:"showDead"},n.DOM.input({type:"checkbox",name:"showDead",id:"showDead",checked:s.showDead})," show dead"),n.DOM.p(null,"Show items flagged as dead.")),n.DOM.div({className:"Settings__setting Settings__setting--checkbox"},n.DOM.label({htmlFor:"showDeleted"},n.DOM.input({type:"checkbox",name:"showDeleted",id:"showDeleted",checked:s.showDeleted})," show deleted"),n.DOM.p(null,"Show comments flagged as deleted in threads."))))}});t.exports=i},{"./stores/SettingsStore":22,react:"react"}],10:[function(e,t){"use strict";var n=e("react"),s=n.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var e=this.props.size+"px",t={height:e,width:e,marginRight:this.props.spacing+"px"};return n.DOM.div({className:"Spinner",style:{width:3*(this.props.size+this.props.spacing)+"px"}},n.DOM.div({className:"bounce1",style:t}),n.DOM.div({className:"bounce2",style:t}),n.DOM.div({className:"bounce3",style:t}))}});t.exports=s},{react:"react"}],11:[function(e,t){"use strict";var n=e("react"),s=e("./stores/TopStore"),i=e("./mixins/PageNumberMixin"),o=e("./Paginator"),r=e("./Spinner"),a=e("./TopStoryListItem"),m=e("./utils/constants"),l=e("./utils/pageCalc"),d=e("./utils/setTitle"),c=m.ITEMS_PER_PAGE,u=m.TOP_STORIES,p=n.createClass({displayName:"TopStories",mixins:[i],getInitialState:function(){return s.getTopStories()},componentWillMount:function(){s.on("update",this.handleUpdate),s.start(),d()},componentWillUnmount:function(){s.off("update",this.handleUpdate)},handleUpdate:function(e){this.isMounted()&&this.setState(e)},render:function(){var e=l(this.getPageNumber(),c,u);if(0===this.state.topStories.length&&0===this.state.topStoryIds.length){for(var t=[],s=e.startIndex;s<e.endIndex;s++)t.push(n.DOM.li({className:"ListItem ListItem--loading"},r(null)));return n.DOM.div({className:"Items Items--loading"},n.DOM.ol({className:"Items__list",start:e.startIndex+1},t),o({route:"news",page:e.pageNum,hasNext:e.hasNext}))}return n.DOM.div({className:"Items"},n.DOM.ol({className:"Items__list",start:e.startIndex+1},this.renderItems(e.startIndex,e.endIndex)),o({route:"news",page:e.pageNum,hasNext:e.hasNext}))},renderItems:function(e,t){for(var n=[],s=e;t>s;s++){var i=this.state.topStories[s],o=this.state.topStoryIds[s];n.push(o?a({key:o,id:o,topIndex:s,cachedItem:i}):a({cachedItem:i}))}return n}});t.exports=p},{"./Paginator":6,"./Spinner":10,"./TopStoryListItem":12,"./mixins/PageNumberMixin":18,"./stores/TopStore":24,"./utils/constants":28,"./utils/pageCalc":30,"./utils/setTitle":32,react:"react"}],12:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./stores/StoryCommentThreadStore"),o=e("./services/HNService"),r=e("./stores/TopStore"),a=e("./mixins/ItemMixin"),m=e("./mixins/ListItemMixin"),l=e("./Spinner"),d=n.createClass({displayName:"TopStoryListItem",mixins:[a,m,s],propTypes:{id:n.PropTypes.number,cachedItem:n.PropTypes.object,topIndex:n.PropTypes.number},getDefaultProps:function(){return{id:null,cachedItem:null,topIndex:null}},getInitialState:function(){return{item:this.props.cachedItem||{}}},componentWillMount:function(){null!=this.props.id?this.initLiveItem():null!=this.props.cachedItem&&(this.threadState=i.loadState(this.state.item.id))},componentWillReceiveProps:function(e){null==this.props.id&&null!=e.id&&this.initLiveItem()},componentWillUpdate:function(e,t){this.state.item!==t.item&&r.setItem(this.props.topIndex,t.item)},initLiveItem:function(){this.bindAsObject(o.itemRef(this.props.id),"item"),this.threadState=i.loadState(this.props.id)},render:function(){return this.state.item.id?this.renderListItem(this.state.item,this.threadState):n.DOM.li({className:"ListItem ListItem--loading"},l(null))}});t.exports=d},{"./Spinner":10,"./mixins/ItemMixin":16,"./mixins/ListItemMixin":17,"./services/HNService":19,"./stores/StoryCommentThreadStore":23,"./stores/TopStore":24,react:"react",reactfire:"reactfire"}],13:[function(e,t){"use strict";function n(e){return!e.dead}function s(e){return o.showDead?e:{comments:e.comments.filter(n),stories:e.stories.filter(n)}}var i=e("react"),o=e("./stores/SettingsStore"),r=e("./stores/UpdatesStore"),a=e("./DisplayListItem"),m=e("./DisplayComment"),l=e("./Paginator"),d=e("./Spinner"),c=e("./mixins/PageNumberMixin"),u=e("./utils/constants"),p=e("./utils/pageCalc"),h=e("./utils/setTitle"),f=u.ITEMS_PER_PAGE,C=i.createClass({displayName:"Updates",mixins:[c],getInitialState:function(){return s(r.getUpdates())},componentWillMount:function(){this.setTitle(this.props.type),r.start(),r.on("updates",this.handleUpdates)},componentWillUnmount:function(){r.off("updates",this.handleUpdates),r.stop()},componentWillReceiveProps:function(e){this.props.type!=e.type&&this.setTitle(e.type)},setTitle:function(e){h("New "+("comments"==e?"Comments":"Links"))},handleUpdates:function(e){this.isMounted()&&this.setState(s(e))},render:function(){var e="comments"==this.props.type?this.state.comments:this.state.stories;if(0===e.length)return i.DOM.div({className:"Updates Updates--loading"},d({size:"20"}));var t=p(this.getPageNumber(),f,e.length);return"comments"==this.props.type?i.DOM.div({className:"Updates Comments"},e.slice(t.startIndex,t.endIndex).map(function(e){return m({key:e.id,id:e.id,comment:e})}),l({route:"newcomments",page:t.pageNum,hasNext:t.hasNext})):i.DOM.div({className:"Updates Items"},i.DOM.ol({className:"Items__list",start:t.startIndex+1},e.slice(t.startIndex,t.endIndex).map(function(e){return a({key:e.id,item:e})})),l({route:"newest",page:t.pageNum,hasNext:t.hasNext}))}});t.exports=C},{"./DisplayComment":3,"./DisplayListItem":4,"./Paginator":6,"./Spinner":10,"./mixins/PageNumberMixin":18,"./stores/SettingsStore":22,"./stores/UpdatesStore":25,"./utils/constants":28,"./utils/pageCalc":30,"./utils/setTitle":32,react:"react"}],14:[function(e,t){"use strict";var n=e("moment"),s=e("react"),i=e("reactfire"),o=e("./services/HNService"),r=e("./Spinner"),a=e("./utils/setTitle"),m=s.createClass({displayName:"UserProfile",mixins:[i],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(o.userRef(this.props.params.id),"user")},componentWillUpdate:function(e,t){this.state.user.id!=t.user.id&&a("Profile: "+t.user.id)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("user"),this.bindAsObject(o.userRef(e.params.id),"user"))},render:function(){var e=this.state.user;if(!e.id)return s.DOM.div({className:"UserProfile UserProfile--loading"},s.DOM.h4(null,this.props.params.id),r({size:"20"}));var t=n(1e3*e.created);return s.DOM.div({className:"UserProfile"},s.DOM.h4(null,e.id),s.DOM.dl(null,s.DOM.dt(null,"Created"),s.DOM.dd(null,t.fromNow()," (",t.format("LL"),")"),s.DOM.dt(null,"Karma"),s.DOM.dd(null,e.karma),s.DOM.dt(null,"Delay"),s.DOM.dd(null,e.delay),e.about&&s.DOM.dt(null,"About"),e.about&&s.DOM.dd(null,s.DOM.div({className:"UserProfile__about",dangerouslySetInnerHTML:{__html:e.about}}))))}});t.exports=m},{"./Spinner":10,"./services/HNService":19,"./utils/setTitle":32,moment:"moment",react:"react",reactfire:"reactfire"}],15:[function(e,t){"use strict";var n=e("moment"),s=e("react"),i=e("react-router"),o=e("../stores/ItemStore"),r=e("../stores/SettingsStore"),a=e("../Spinner"),m=e("../utils/pluralise"),l=i.Link,d={fetchAncestors:function(e){o.fetchCommentAncestors(e,function(e){this.isMounted()&&this.setState({parent:e.parent,op:e.op})}.bind(this))},renderCommentLoading:function(e){return s.DOM.div({className:"Comment Comment--loading Comment--level"+this.props.level},(this.props.loadingSpinner||e.error)&&a({size:"20"}),e.error&&s.DOM.p(null,"Unable to load comment – this usually indicates the author has configured a delay. Trying again in 30 seconds."))},renderCommentDeleted:function(e,t){return s.DOM.div({className:t.className},s.DOM.div({className:"Comment__content"},s.DOM.div({className:"Comment__meta"},"[deleted] | ",s.DOM.a({href:"https://news.ycombinator.com/item?id="+e.id},"view on Hacker News"))))},renderCollapseControl:function(e){return s.DOM.span({className:"Comment__collapse",onClick:this.toggleCollapse,onKeyPress:this.toggleCollapse,tabIndex:"0"},"[",e?"+":"–","]")},renderCommentMeta:function(e,t){return e.dead&&!r.showDead?s.DOM.div({className:"Comment__meta"},t.collapsible&&this.renderCollapseControl(t.collapsed),t.collapsible&&" ","[dead]",t.childCounts&&" | ("+t.childCounts.children+" child"+m(t.childCounts.children,",ren"),t.childCounts&&t.childCounts.newComments>0&&", ",t.childCounts&&t.childCounts.newComments>0&&s.DOM.em(null,t.childCounts.newComments," new"),t.childCounts&&")"):s.DOM.div({className:"Comment__meta"},t.collapsible&&this.renderCollapseControl(t.collapsed),t.collapsible&&" ",l({to:"user",params:{id:e.by},className:"Comment__user"},e.by)," ",n(1e3*e.time).fromNow(),t.link&&" | ",t.link&&l({to:"comment",params:{id:e.id}},"link"),t.parent&&" | ",t.parent&&l({to:this.state.parent.type,params:{id:e.parent}},"parent"),t.op&&" | on: ",t.op&&l({to:this.state.op.type,params:{id:this.state.op.id}},this.state.op.title),e.dead&&" | [dead]",t.childCounts&&" | ("+t.childCounts.children+" child"+m(t.childCounts.children,",ren"),t.childCounts&&t.childCounts.newComments>0&&", ",t.childCounts&&t.childCounts.newComments>0&&s.DOM.em(null,t.childCounts.newComments," new"),t.childCounts&&")")},renderCommentText:function(e){return s.DOM.div({className:"Comment__text"},!e.dead||r.showDead?s.DOM.div({dangerouslySetInnerHTML:{__html:e.text}}):"[dead]")}};t.exports=d},{"../Spinner":10,"../stores/ItemStore":21,"../stores/SettingsStore":22,"../utils/pluralise":31,moment:"moment",react:"react","react-router":"react-router"}],16:[function(e,t){"use strict";var n=e("react"),s=e("moment"),i=e("react-router"),o=e("../utils/pluralise"),r=i.Link,a=function(){var e=document.createElement("a");return function(t){e.href=t;var n=e.hostname.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}}(),m={renderItemMeta:function(e,t,i){var a=s(1e3*e.time),m=e.kids&&e.kids.length>0?"comments":"discuss";return t.commentCount>0&&(m=t.commentCount+" comment"+o(t.commentCount)),-1!=this.constructor.displayName.indexOf("ListItem")&&(m=r({to:e.type,params:{id:e.id}},m)),"job"==e.type?n.DOM.div({className:"Item__meta"},n.DOM.span({className:"Item__time"},a.fromNow())):n.DOM.div({className:"Item__meta"},n.DOM.span({className:"Item__score"},e.score," point",o(e.score))," ",n.DOM.span({className:"Item__by"},"by ",r({to:"user",params:{id:e.by}},e.by))," ",n.DOM.span({className:"Item__time"},a.fromNow())," | ",m,i)},renderItemTitle:function(e){var t,s=!!e.url;return t=e.dead?"[dead] "+e.title:s?n.DOM.a({href:e.url},e.title):r({to:e.type,params:{id:e.id}},e.title),n.DOM.div({className:"Item__title"},t,s&&" ",s&&n.DOM.span({className:"Item__host"},"(",a(e.url),")"))}};t.exports=m},{"../utils/pluralise":31,moment:"moment",react:"react","react-router":"react-router"}],17:[function(e,t){"use strict";function n(e,t){return e?e.filter(t):[]}var s=e("react"),i=e("react-router"),o=e("../utils/buildClassName"),r=e("../utils/pluralise"),a=i.Link,m={getNewThreadCount:function(e,t){return null===t.lastVisit?0:n(e.kids,function(e){return e>t.maxCommentId}).length},renderListItem:function(e,t){if(e.deleted)return null;var n=this.getNewThreadCount(e,t),i=n>0;return s.DOM.li({className:o("ListItem",{"ListItem--dead":e.dead})},this.renderItemTitle(e),this.renderItemMeta(e,t,null!==t.lastVisit&&s.DOM.span(null," ","(",t.lastVisit.fromNow(),")",i&&" | ",i&&a({to:e.type,params:{id:e.id}},s.DOM.em(null,n," new thread",r(n))))))}};t.exports=m},{"../utils/buildClassName":26,"../utils/pluralise":31,react:"react","react-router":"react-router"}],18:[function(e,t){"use strict";var n={getPageNumber:function(e){return"undefined"==typeof e&&(e=this.props.query.page),e&&/^\d+$/.test(e)?Math.max(1,Number(e)):1}};t.exports=n},{}],19:[function(e,t){"use strict";function n(e,t){o(e).once("value",function(e){t(e.val())})}function s(e,t){function s(n){i.push(n),i.length>=e.length&&t(i)}var i=[];e.forEach(function(e){n(e,s)})}function i(){return l.child("topstories")}function o(e){return l.child("item/"+e)}function r(e){return l.child("user/"+e)}function a(){return l.child("updates/items")}var m=e("firebase"),l=new m("https://hacker-news.firebaseio.com/v0");t.exports={fetchItem:n,fetchItems:s,topStoriesRef:i,itemRef:o,userRef:r,updatesRef:a}},{firebase:"firebase"}],20:[function(e,t){"use strict";function n(e,t){this.itemId=e.id,this.onCommentsChanged=t,this.children={},this.children[e.id]=[],this.isNew={},this.isCollapsed={}}var s=e("../utils/extend");s(n.prototype,{getChildCounts:function(e){for(var t=0,n=0,s=[e.id];s.length;){for(var i=[],o=0,r=s.length;r>o;o++){var a=this.children[s[o]];a.length&&i.push.apply(i,a)}for(o=0,r=i.length;r>o;o++)this.isNew[i[o]]&&n++;t+=i.length,s=i}return{children:t,newComments:n}},commentAdded:function(e){e.deleted||(this.children[e.id]=[],this.children[e.parent].push(e.id))},commentDeleted:function(e){var t=this.children[e.parent];t.splice(t.indexOf(e.id),1)},toggleCollapse:function(e){this.isCollapsed[e]=!this.isCollapsed[e],this.onCommentsChanged({type:"collapse"})}}),t.exports=n},{"../utils/extend":29}],21:[function(e,t){"use strict";function n(e,t,n){for(var i=e.id,o=e.parent;a[o]||m[o];){if(n.itemCount++,n.cacheHits++,m[o])return 1==n.itemCount&&(n.parent=m[o]),n.op=m[o],void t(n);a[o]&&(1==n.itemCount&&(n.parent={id:o,type:"comment"}),i=o,o=a[o])}l.getItem(o,function(e){n.itemCount++,a[i]=o,"comment"==e.type&&(a[e.id]=e.parent),s(e,t,n)},n)}function s(e,t,s){1==s.itemCount&&(s.parent=e),"comment"!=e.type?(s.op=e,m[e.id]={id:e.id,type:e.type,title:e.title},t(s)):n(e,t,s)}var i=e("../services/HNService"),o=e("./TopStore"),r=e("./UpdatesStore"),a={},m={},l={getItem:function(e,t,n){var s=this.getCachedItem(e);s?(n&&n.cacheHits++,setImmediate(t,s)):i.fetchItem(e,t)},getCachedItem:function(e){return o.getItem(e)||r.getItem(e)||null},getCachedStory:function(e){return o.getItem(e)||r.getStory(e)||null},fetchCommentAncestors:function(e,t){var s=Date.now(),i={itemCount:0,cacheHits:0};n(e,function(){i.timeTaken=Date.now()-s,setImmediate(t,i)},i)}};t.exports=l},{"../services/HNService":19,"./TopStore":24,"./UpdatesStore":25}],22:[function(e,t){"use strict";var n=e("../utils/extend"),s=e("../utils/storage"),i="settings",o={autoCollapse:!0,showDead:!1,showDeleted:!1,load:function(){var e=s.get(i);e&&n(this,JSON.parse(e))},save:function(){s.set(i,JSON.stringify({autoCollapse:this.autoCollapse,showDead:this.showDead,showDeleted:this.showDeleted}))}};t.exports=o},{"../utils/extend":29,"../utils/storage":33}],23:[function(e,t){"use strict";function n(e){var t=l.get(e+c,null);return{lastVisit:null!==t?i(Number(t)):null,commentCount:Number(l.get(e+d,"0")),maxCommentId:Number(l.get(e+u,"0"))}}function s(e,t,s){o.call(this,e,t),this.startedLoading=Date.now(),this.parents={},this.commentCount=0,this.newCommentCount=0,this.maxCommentId=0,this.loading=!0,this.expectedComments=e.kids?e.kids.length:0;var i=n(e.id);this.lastVisit=i.lastVisit,this.prevMaxCommentId=i.maxCommentId,this.isFirstVisit=null===i.lastVisit,s.cached||this.checkLoadCompletion()}var i=e("moment"),o=e("./CommentThreadStore"),r=e("./SettingsStore"),a=e("../utils/cancellableDebounce"),m=e("../utils/extend"),l=e("../utils/storage"),d=":cc",c=":lv",u=":mc";s.loadState=n,s.prototype=m(Object.create(o.prototype),{constructor:s,numberOfCommentsChanged:a(function(){this.onCommentsChanged({type:"number"})},123),firstLoadComplete:function(){this.lastVisit=i(Date.now()),this.prevMaxCommentId=this.maxCommentId,this.isFirstVisit=!1,this.onCommentsChanged({type:"first_load_complete"})},checkLoadCompletion:function(){this.loading&&this.commentCount>=this.expectedComments&&(this.loading=!1,this.isFirstVisit?this.firstLoadComplete():r.autoCollapse&&this.newCommentCount>0&&this.collapseThreadsWithoutNewComments())},_storeState:function(){l.set(this.itemId+d,this.commentCount),l.set(this.itemId+c,Date.now()),l.set(this.itemId+u,this.maxCommentId)},commentAdded:function(e){return e.deleted?void(this.loading&&(this.expectedComments--,this.checkLoadCompletion())):(o.prototype.commentAdded.call(this,e),e.dead&&!r.showDead?this.expectedComments--:this.commentCount++,this.loading&&e.kids&&(this.expectedComments+=e.kids.length),this.prevMaxCommentId>0&&e.id>this.prevMaxCommentId&&(!e.dead||r.showDead)&&(this.newCommentCount++,this.isNew[e.id]=!0),e.id>this.maxCommentId&&(this.maxCommentId=e.id),e.parent!=this.itemId&&(this.parents[e.id]=e.parent),this.numberOfCommentsChanged(),void(this.loading&&this.checkLoadCompletion()))},commentDelayed:function(){this.expectedComments--},commentDeleted:function(e){o.prototype.commentDeleted.call(this,e),this.commentCount--,this.isNew[e.id]&&(this.newCommentCount--,delete this.isNew[e.id]),delete this.parents[e.id],this.numberOfCommentsChanged()
},commentDied:function(e){r.showDead||(this.commentCount--,this.isNew[e.id]&&(this.newCommentCount--,delete this.isNew[e.id]))},adjustExpectedComments:function(e){this.expectedComments+=e,this.checkLoadCompletion()},collapseThreadsWithoutNewComments:function(){for(var e=Object.keys(this.isNew),t={},n=0,s=e.length;s>n;n++)for(var i=this.parents[e[n]];i&&!t[i];)t[i]=!0,i=this.parents[i];for(var o={},r=this.children[this.itemId];r.length;){var a=[];for(n=0,s=r.length;s>n;n++){var m=r[n];if(t[m]){var l=this.children[m];l.length&&a.push.apply(a,l)}else this.isNew[m]||(o[m]=!0)}r=a}this.isCollapsed=o,this.onCommentsChanged({type:"collapse"})},markAsRead:function(){this.lastVisit=i(Date.now()),this.newCommentCount=0,this.prevMaxCommentId=this.maxCommentId,this.isNew={},this._storeState()},dispose:function(){this.numberOfCommentsChanged.cancel(),this._storeState()}}),t.exports=s},{"../utils/cancellableDebounce":27,"../utils/extend":29,"../utils/storage":33,"./CommentThreadStore":20,"./SettingsStore":22,moment:"moment"}],24:[function(e,t){"use strict";function n(){for(var e=0,t=m.length;t>e;e++)d[e]=l[m[e]]||null}function s(e){m=e.val(),n(),c.emit("update",c.getTopStories())}var i=e("events").EventEmitter,o=e("../services/HNService"),r=e("../utils/extend"),a=null,m=null,l=null,d=[],c=r(new i,{loadSession:function(){var e=sessionStorage.topStories;l=e?JSON.parse(e):{},e=sessionStorage.topStoryIds,m=e?JSON.parse(e):[],n()},saveSession:function(){sessionStorage.topStories=JSON.stringify(l),sessionStorage.topStoryIds=JSON.stringify(m)},start:function(){null===a&&(a=o.topStoriesRef(),a.on("value",s))},stop:function(){null!==a&&(a.off(),a=null)},getItem:function(e){return l[e]||null},getTopStories:function(){return{topStories:d,topStoryIds:m}},setItem:function(e,t){d[e]=t,l[t.id]=t}});c.off=c.removeListener,t.exports=c},{"../services/HNService":19,"../utils/extend":29,events:"events"}],25:[function(e,t){"use strict";function n(e,t){return t.time-e.time}function s(e){var t=Object.keys(e).map(function(t){return e[t]});return t.sort(n),t}function i(){h.comments=o(p.comments),h.stories=o(p.stories)}function o(e){var t=s(e);return t.splice(c,Math.max(0,t.length-c)).forEach(function(t){delete e[t.id]}),t}function r(e){for(var t=0,n=e.length;n>t;t++){var s=e[t];s.deleted||"undefined"!=typeof f[s.type]&&("comment"==s.type?p.comments[s.id]=s:p.stories[s.id]=s)}i(),C.emit("updates",h)}var a=e("events").EventEmitter,m=e("../services/HNService"),l=e("../utils/constants"),d=e("../utils/extend"),c=l.UPDATES_CACHE_SIZE,u=null,p=null,h={},f={comment:!0,job:!0,poll:!0,story:!0},C=d(new a,{loadSession:function(){var e=sessionStorage.updates;p=e?JSON.parse(e):{comments:{},stories:{}},i()},saveSession:function(){sessionStorage.updates=JSON.stringify(p)},start:function(){null===u&&(u=m.updatesRef(),u.on("value",function(e){m.fetchItems(e.val(),r)}))},stop:function(){u.off(),u=null},getUpdates:function(){return h},getItem:function(e){return p.comments[e]||p.stories[e]||null},getComment:function(e){return p.comments[e]||null},getStory:function(e){return p.stories[e]||null}});C.off=C.removeListener,t.exports=C},{"../services/HNService":19,"../utils/constants":28,"../utils/extend":29,events:"events"}],26:[function(e,t){"use strict";function n(e,t){var n=[];"undefined"==typeof t?t=e:n.push(e);for(var s=Object.keys(t),i=0,o=s.length;o>i;i++)t[s[i]]&&n.push(s[i]);return n.join(" ")}t.exports=n},{}],27:[function(e,t){"use strict";function n(e,t,n){var s,i,o,r,a,m=function(){var l=Date.now()-r;t>l&&l>0?s=setTimeout(m,t-l):(s=null,n||(a=e.apply(o,i),s||(o=i=null)))},l=function(){o=this,i=arguments,r=Date.now();var l=n&&!s;return s||(s=setTimeout(m,t)),l&&(a=e.apply(o,i),o=i=null),a};return l.cancel=function(){s&&clearTimeout(s)},l}t.exports=n},{}],28:[function(e,t){"use strict";t.exports={ITEMS_PER_PAGE:30,SITE_TITLE:"React HN",TOP_STORIES:100,UPDATES_CACHE_SIZE:200}},{}],29:[function(e,t){"use strict";function n(e,t,n){for(var s=Object.keys(t),i=0,o=s.length;o>i;i++)e[s[i]]=t[s[i]];if(n)for(s=Object.keys(n),i=0,o=s.length;o>i;i++)e[s[i]]=n[s[i]];return e}t.exports=n},{}],30:[function(e,t){"use strict";function n(e,t,n){var s=(e-1)*t,i=Math.min(n,s+t),o=n-1>i;return{pageNum:e,startIndex:s,endIndex:i,hasNext:o}}t.exports=n},{}],31:[function(e,t){"use strict";function n(e,t){return(t||",s").split(",")[1==e?0:1]}t.exports=n},{}],32:[function(e,t){"use strict";function n(e){document.title=e?e+" | "+s:s}var s=e("./constants").SITE_TITLE;t.exports=n},{"./constants":28}],33:[function(e,t){"use strict";t.exports={get:function(e,t){var n=localStorage[e];return"undefined"!=typeof n?n:t},set:function(e,t){localStorage[e]=t}}},{}],34:[function(){!function(e,t){"use strict";function n(e){return h[p]=s.apply(t,e),p++}function s(e){var n=[].slice.call(arguments,1);return function(){"function"==typeof e?e.apply(t,n):new Function(""+e)()}}function i(e){if(f)setTimeout(s(i,e),0);else{var t=h[e];if(t){f=!0;try{t()}finally{o(e),f=!1}}}}function o(e){delete h[e]}function r(){u=function(){var e=n(arguments);return process.nextTick(s(i,e)),e}}function a(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function m(){var t="setImmediate$"+Math.random()+"$",s=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&i(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),u=function(){var s=n(arguments);return e.postMessage(t+s,"*"),s}}function l(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;i(t)},u=function(){var t=n(arguments);return e.port2.postMessage(t),t}}function d(){var e=C.documentElement;u=function(){var t=n(arguments),s=C.createElement("script");return s.onreadystatechange=function(){i(t),s.onreadystatechange=null,e.removeChild(s),s=null},e.appendChild(s),t}}function c(){u=function(){var e=n(arguments);return setTimeout(s(i,e),0),e}}if(!e.setImmediate){var u,p=1,h={},f=!1,C=e.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(e);g=g&&g.setTimeout?g:e,"[object process]"==={}.toString.call(e.process)?r():a()?m():e.MessageChannel?l():C&&"onreadystatechange"in C.createElement("script")?d():c(),g.setImmediate=u,g.clearImmediate=o}}(new Function("return this")())},{}]},{},[1]);