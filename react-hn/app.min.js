!function e(t,n,s){function i(o,a){if(!n[o]){if(!t[o]){var m="function"==typeof require&&require;if(!a&&m)return m(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return i(n?n:e)},c,c.exports,e,t,n,s)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<s.length;o++)i(s[o]);return i}({1:[function(e){"use strict";function t(e){return n.createClass({render:function(){return n.createElement(d,n.__spread({},this.props,{type:e}))}})}e("setimmediate");var n=e("react"),s=e("react-router"),i=e("./stores/TopStore"),r=e("./stores/UpdatesStore"),o=e("./stores/SettingsStore"),a=e("./PermalinkedComment"),m=e("./Item"),l=e("./Settings"),c=e("./TopStories"),d=e("./Updates"),u=e("./UserProfile"),p=s,h=p.DefaultRoute,f=p.Link,g=p.NotFoundRoute,C=p.Route,S=p.RouteHandler,v=n.createClass({displayName:"App",getInitialState:function(){return{showSettings:!1}},componentWillMount:function(){o.load(),i.loadSession(),r.loadSession(),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},handleBeforeUnload:function(){i.stop(),i.saveSession(),r.saveSession()},toggleSettings:function(e){e.preventDefault(),this.setState({showSettings:!this.state.showSettings})},render:function(){return n.createElement("div",{className:"App"},n.createElement("div",{className:"App__header"},n.createElement("img",{src:"logo.png",width:"16",height:"16",alt:""})," ",n.createElement(f,{to:"news",className:"App__homelink"},"React HN")," ",n.createElement(f,{to:"newest"},"new")," | ",n.createElement(f,{to:"newcomments"},"comments"),n.createElement("a",{className:"App__settings",tabIndex:"0",onClick:this.toggleSettings,onKeyPress:this.toggleSettings},this.state.showSettings?"hide settings":"settings"),this.state.showSettings&&n.createElement(l,{key:"settings"})),n.createElement("div",{className:"App__content"},n.createElement(S,n.__spread({},this.props))),n.createElement("div",{className:"App__footer"},"react-hn v","1.0.3"," | ",n.createElement("a",{href:"https://github.com/insin/react-hn"},"insin/react-hn")))}}),E=n.createClass({displayName:"NotFound",render:function(){return n.createElement("h2",null,"Not found")}}),y=n.createElement(C,{name:"app",path:"/",handler:v},n.createElement(h,{handler:c}),n.createElement(g,{handler:E}),n.createElement(C,{name:"news",path:"news",handler:c}),n.createElement(C,{name:"item",path:"item/:id",handler:m}),n.createElement(C,{name:"job",path:"job/:id",handler:m}),n.createElement(C,{name:"poll",path:"poll/:id",handler:m}),n.createElement(C,{name:"story",path:"story/:id",handler:m}),n.createElement(C,{name:"comment",path:"comment/:id",handler:a}),n.createElement(C,{name:"newest",path:"newest",handler:t("links")}),n.createElement(C,{name:"newcomments",path:"newcomments",handler:t("comments")}),n.createElement(C,{name:"user",path:"user/:id",handler:u}));s.run(y,function(e,t){n.render(n.createElement(e,{params:t.params,query:t.query}),document.getElementById("app"))})},{"./Item":5,"./PermalinkedComment":7,"./Settings":9,"./TopStories":11,"./Updates":13,"./UserProfile":14,"./stores/SettingsStore":22,"./stores/TopStore":24,"./stores/UpdatesStore":25,react:"react","react-router":"react-router",setimmediate:34}],2:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./stores/CommentThreadStore"),r=e("./services/HNService"),o=e("./stores/SettingsStore"),a=e("./mixins/CommentMixin"),m=e("./utils/buildClassName"),l=n.createClass({displayName:"Comment",mixins:[a,s],propTypes:{id:n.PropTypes.number.isRequired,level:n.PropTypes.number.isRequired,loadingSpinner:n.PropTypes.bool,threadStore:n.PropTypes.instanceOf(i).isRequired},getDefaultProps:function(){return{loadingSpinner:!1}},getInitialState:function(){return{comment:{}}},componentWillMount:function(){this.bindFirebaseRef()},componentWillUnmount:function(){this.clearDelayTimeout()},componentDidUpdate:function(e,t){if(t.comment.id){if(!t.comment.deleted&&this.state.comment.deleted&&this.props.threadStore.commentDeleted(this.state.comment),!t.comment.dead&&this.state.comment.dead)this.props.threadStore.commentDied(this.state.comment);else if(t.comment!==this.state.comment&&this.props.threadStore.loading){var n=this.state.comment.kids?this.state.comment.kids.length:0,s=t.comment.kids?t.comment.kids.length:0;this.props.threadStore.adjustExpectedComments(n-s)}}else this.state.comment.id&&(t.comment.delayed&&this.clearDelayTimeout(),this.props.threadStore.commentAdded(this.state.comment)),!t.comment.delayed&&this.state.comment.delayed&&this.props.threadStore.commentDelayed(this.props.id)},bindFirebaseRef:function(){this.bindAsObject(r.itemRef(this.props.id),"comment",this.handleFirebaseRefCancelled),this.timeout&&(this.timeout=null)},handleFirebaseRefCancelled:function(e){this.unbind("comment"),this.timeout=setTimeout(this.bindFirebaseRef,3e4),this.state.comment.delayed||(this.state.comment.delayed=!0,this.forceUpdate())},clearDelayTimeout:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},toggleCollapse:function(e){e.preventDefault(),this.props.threadStore.toggleCollapse(this.state.comment.id)},render:function(){var e=this.state.comment,t=this.props;if(!e.id)return this.renderCommentLoading(e);if(e.deleted)return o.showDeleted?this.renderCommentDeleted(e,{className:"Comment Comment--deleted Comment--level"+t.level}):null;var s=t.threadStore.isNew[e.id],i=!!t.threadStore.isCollapsed[e.id],r=i&&t.threadStore.getChildCounts(e);i&&s&&(r.newComments=0);var a=m("Comment Comment--level"+t.level,{"Comment--collapsed":i,"Comment--dead":e.dead,"Comment--new":s});return n.createElement("div",{className:a},n.createElement("div",{className:"Comment__content"},this.renderCommentMeta(e,{collapsible:!0,collapsed:i,link:!0,childCounts:r}),(!e.dead||o.showDead)&&this.renderCommentText(e,{replyLink:!0})),e.kids&&n.createElement("div",{className:"Comment__kids"},e.kids.map(function(e){return n.createElement(l,{key:e,id:e,level:t.level+1,loadingSpinner:t.loadingSpinner,threadStore:t.threadStore})})))}});t.exports=l},{"./mixins/CommentMixin":15,"./services/HNService":19,"./stores/CommentThreadStore":20,"./stores/SettingsStore":22,"./utils/buildClassName":26,react:"react",reactfire:"reactfire"}],3:[function(e,t){"use strict";var n=e("react"),s=e("./stores/SettingsStore"),i=e("./mixins/CommentMixin"),r=e("./utils/buildClassName"),o=n.createClass({displayName:"DisplayComment",mixins:[i],propTypes:{comment:n.PropTypes.object.isRequired},getInitialState:function(){return{op:{},parent:{type:"comment"}}},componentWillMount:function(){this.fetchAncestors(this.props.comment)},render:function(){if(this.props.comment.deleted)return null;if(this.props.comment.dead&&!s.showDead)return null;var e=this.props.comment,t=r("Comment Comment--level0",{"Comment--dead":e.dead});return n.createElement("div",{className:t},n.createElement("div",{className:"Comment__content"},this.renderCommentMeta(e,{link:!0,parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!=this.state.op.id,op:!!this.state.op.id}),this.renderCommentText(e,{replyLink:!1})))}});t.exports=o},{"./mixins/CommentMixin":15,"./stores/SettingsStore":22,"./utils/buildClassName":26,react:"react"}],4:[function(e,t){"use strict";var n=e("react"),s=e("./stores/StoryCommentThreadStore"),i=e("./mixins/ItemMixin"),r=e("./mixins/ListItemMixin"),o=n.createClass({displayName:"DisplayListItem",mixins:[i,r],propTypes:{item:n.PropTypes.object.isRequired},componentWillMount:function(){this.threadState=s.loadState(this.props.item.id)},render:function(){return this.renderListItem(this.props.item,this.threadState)}});t.exports=o},{"./mixins/ItemMixin":16,"./mixins/ListItemMixin":17,"./stores/StoryCommentThreadStore":23,react:"react"}],5:[function(e,t){"use strict";function n(e){return e.fromNow(!0).replace(/^an? /,"")}var s=e("react"),i=e("reactfire"),r=e("./services/HNService"),o=e("./stores/StoryCommentThreadStore"),a=e("./stores/ItemStore"),m=e("./Comment"),l=e("./PollOption"),c=e("./Spinner"),d=e("./mixins/ItemMixin"),u=e("./utils/buildClassName"),p=e("./utils/setTitle"),h=s.createClass({displayName:"Item",mixins:[d,i],getInitialState:function(){return{item:a.getCachedStory(Number(this.props.params.id))||{}}},componentWillMount:function(){this.bindAsObject(r.itemRef(this.props.params.id),"item"),this.state.item.id&&(this.threadStore=new o(this.state.item,this.handleCommentsChanged,{cached:!0}),p(this.state.item.title)),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){this.threadStore.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillReceiveProps:function(e){if(this.props.params.id!=e.params.id){this.threadStore.dispose(),this.threadStore=null,this.unbind("item");var t=a.getCachedStory(Number(e.params.id));t&&(this.threadStore=new o(t,this.handleCommentsChanged,{cached:!0}),p(t.title)),this.bindAsObject(r.itemRef(e.params.id),"item"),this.setState({item:t||{}})}},componentWillUpdate:function(e,t){!this.state.item.id&&t.item.id&&p(t.item.title)},componentDidUpdate:function(e,t){if(t.item.id!=this.state.item.id)this.threadStore&&this.threadStore.itemId==this.state.item.id||(this.threadStore=new o(this.state.item,this.handleCommentsChanged,{cached:!1}),p(this.state.item.title),this.forceUpdate());else if(t.item!==this.state.item&&this.threadStore.loading){var n=this.state.item.kids?this.state.item.kids.length:0,s=t.item.kids?t.item.kids.length:0;this.threadStore.adjustExpectedComments(n-s)}},handleBeforeUnload:function(){this.threadStore.dispose()},handleCommentsChanged:function(){this.forceUpdate()},autoCollapse:function(e){e.preventDefault(),this.threadStore.collapseThreadsWithoutNewComments()},markAsRead:function(e){e.preventDefault(),this.threadStore.markAsRead(),this.forceUpdate()},render:function(){var e=this.state,t=e.item,i=this.threadStore;return t.id&&i?s.createElement("div",{className:u("Item",{"Item--dead":t.dead})},s.createElement("div",{className:"Item__content"},this.renderItemTitle(t),this.renderItemMeta(t,i,null!==i.lastVisit&&i.newCommentCount>0&&s.createElement("span",null," ","(",s.createElement("em",null,i.newCommentCount," new")," in the last ",n(i.lastVisit),") | ",s.createElement("span",{className:"control",tabIndex:"0",onClick:this.autoCollapse,onKeyPress:this.autoCollapse,title:"Collapse threads without new comments"},"auto collapse")," | ",s.createElement("span",{className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),t.text&&s.createElement("div",{className:"Item__text"},s.createElement("div",{dangerouslySetInnerHTML:{__html:t.text}})),"poll"==t.type&&s.createElement("div",{className:"Item__poll"},t.parts.map(function(e){return s.createElement(l,{key:e,id:e})}))),t.kids&&s.createElement("div",{className:"Item__kids"},t.kids.map(function(e,t){return s.createElement(m,{key:e,id:e,level:0,loadingSpinner:0===t,threadStore:i})}))):s.createElement("div",{className:"Item Item--loading"},s.createElement(c,{size:"20"}))}});t.exports=h},{"./Comment":2,"./PollOption":8,"./Spinner":10,"./mixins/ItemMixin":16,"./services/HNService":19,"./stores/ItemStore":21,"./stores/StoryCommentThreadStore":23,"./utils/buildClassName":26,"./utils/setTitle":32,react:"react",reactfire:"reactfire"}],6:[function(e,t){"use strict";var n=e("react"),s=e("react-router"),i=s.Link,r=n.createClass({displayName:"Paginator",render:function(){return 1!=this.props.page||this.props.hasNext?n.createElement("div",{className:"Paginator"},this.props.page>1&&n.createElement("span",{className:"Paginator__prev"},n.createElement(i,{to:this.props.route,query:{page:this.props.page-1}},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&n.createElement("span",{className:"Paginator__next"},n.createElement(i,{to:this.props.route,query:{page:this.props.page+1}},"More"))):null}});t.exports=r},{react:"react","react-router":"react-router"}],7:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("react-router"),r=i.Navigation,o=e("./stores/CommentThreadStore"),a=e("./services/HNService"),m=e("./stores/SettingsStore"),l=e("./stores/UpdatesStore"),c=e("./Comment"),d=e("./mixins/CommentMixin"),u=e("./utils/buildClassName"),p=e("./utils/setTitle"),h=n.createClass({displayName:"PermalinkedComment",mixins:[d,s,r],getDefaultProps:function(){return{level:0}},getInitialState:function(){return{comment:l.getComment(this.props.params.id)||{},parent:{type:"comment"},op:{}}},componentWillMount:function(){this.bindAsObject(a.itemRef(this.props.params.id),"comment"),this.state.comment.id&&this.commentLoaded(this.state.comment)},componentWillReceiveProps:function(e){if(e.params.id!=this.props.params.id){var t=l.getComment(e.params.id);t&&(this.commentLoaded(t),this.setState({comment:t})),this.unbind("comment"),this.bindAsObject(a.itemRef(e.params.id),"comment")}},componentWillUpdate:function(e,t){if(this.state.comment.id!=t.comment.id){if(!t.comment.deleted&&"comment"!=t.comment.type)return void this.replaceWith(t.comment.type,{id:t.comment.id});this.threadStore&&this.threadStore.itemId==t.comment.id||this.commentLoaded(t.comment)}},commentLoaded:function(e){this.setTitle(e),e.deleted||(this.threadStore=new o(e,this.handleCommentsChanged),this.fetchAncestors(e))},setTitle:function(e){if(e.deleted)return p("Deleted comment");var t="Comment by "+e.by;this.state.op.id&&(t+=" | "+this.state.op.title),p(t)},handleCommentsChanged:function(e){"collapse"==e.type&&this.forceUpdate()},render:function(){var e=this.state.comment;if(!e.id)return this.renderCommentLoading(e);if(e.deleted)return this.renderCommentDeleted(e,{className:"Comment Comment--level0 Comment--deleted"});if("comment"!=e.type)return null;var t=u("PermalinkedComment Comment Comment--level0",{"Comment--dead":e.dead}),s=this.threadStore;return n.createElement("div",{className:t},n.createElement("div",{className:"Comment__content"},this.renderCommentMeta(e,{parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!=this.state.op.id,op:!!this.state.op.id}),(!e.dead||m.showDead)&&this.renderCommentText(e,{replyLink:!0})),e.kids&&n.createElement("div",{className:"Comment__kids"},e.kids.map(function(e,t){return n.createElement(c,{key:e,id:e,level:0,loadingSpinner:0===t,threadStore:s})})))}});t.exports=h},{"./Comment":2,"./mixins/CommentMixin":15,"./services/HNService":19,"./stores/CommentThreadStore":20,"./stores/SettingsStore":22,"./stores/UpdatesStore":25,"./utils/buildClassName":26,"./utils/setTitle":32,react:"react","react-router":"react-router",reactfire:"reactfire"}],8:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./services/HNService"),r=e("./Spinner"),o=e("./utils/pluralise"),a=n.createClass({displayName:"PollOption",mixins:[s],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(i.itemRef(this.props.id),"pollopt")},render:function(){var e=this.state.pollopt;return e.id?n.createElement("div",{className:"PollOption"},n.createElement("div",{className:"PollOption__text"},e.text),n.createElement("div",{className:"PollOption__score"},e.score," point",o(e.score))):n.createElement("div",{className:"PollOption PollOption--loading"},n.createElement(r,{size:"20"}))}});t.exports=a},{"./Spinner":10,"./services/HNService":19,"./utils/pluralise":31,react:"react",reactfire:"reactfire"}],9:[function(e,t){"use strict";var n=e("react"),s=e("./stores/SettingsStore"),i=n.createClass({displayName:"Settings",componentDidMount:function(){this.refs.container.getDOMNode().focus()},onChange:function(e){s[e.target.name]=e.target.checked,this.forceUpdate(),s.save()},render:function(){return n.createElement("div",{ref:"container",className:"Settings",tabIndex:"-1"},n.createElement("form",{onChange:this.onChange},n.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},n.createElement("label",{htmlFor:"autoCollapse"},n.createElement("input",{type:"checkbox",name:"autoCollapse",id:"autoCollapse",checked:s.autoCollapse})," auto collapse"),n.createElement("p",null,"Automatically collapse comment threads without new comments on page load.")),n.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},n.createElement("label",{htmlFor:"replyLinks"},n.createElement("input",{type:"checkbox",name:"replyLinks",id:"replyLinks",checked:s.replyLinks})," show reply links"),n.createElement("p",null,'Show "reply" links to Hacker News')),n.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},n.createElement("label",{htmlFor:"showDead"},n.createElement("input",{type:"checkbox",name:"showDead",id:"showDead",checked:s.showDead})," show dead"),n.createElement("p",null,"Show items flagged as dead.")),n.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},n.createElement("label",{htmlFor:"showDeleted"},n.createElement("input",{type:"checkbox",name:"showDeleted",id:"showDeleted",checked:s.showDeleted})," show deleted"),n.createElement("p",null,"Show comments flagged as deleted in threads."))))}});t.exports=i},{"./stores/SettingsStore":22,react:"react"}],10:[function(e,t){"use strict";var n=e("react"),s=n.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var e=this.props.size+"px",t={height:e,width:e,marginRight:this.props.spacing+"px"};return n.createElement("div",{className:"Spinner",style:{width:3*(Number(this.props.size)+Number(this.props.spacing))+"px"}},n.createElement("div",{className:"bounce1",style:t}),n.createElement("div",{className:"bounce2",style:t}),n.createElement("div",{className:"bounce3",style:t}))}});t.exports=s},{react:"react"}],11:[function(e,t){"use strict";var n=e("react"),s=e("./stores/TopStore"),i=e("./mixins/PageNumberMixin"),r=e("./Paginator"),o=e("./Spinner"),a=e("./TopStoryListItem"),m=e("./utils/constants"),l=m.ITEMS_PER_PAGE,c=m.TOP_STORIES,d=e("./utils/pageCalc"),u=e("./utils/setTitle"),p=n.createClass({displayName:"TopStories",mixins:[i],getInitialState:function(){return s.getTopStories()},componentWillMount:function(){s.on("update",this.handleUpdate),s.start(),s.listenToStorage(),u()},componentWillUnmount:function(){s.off("update",this.handleUpdate),s.stopListeningToStorage()},handleUpdate:function(e){this.isMounted()&&this.setState(e)},render:function(){var e=d(this.getPageNumber(),l,c);if(0===this.state.topStories.length&&0===this.state.topStoryIds.length){for(var t=[],s=e.startIndex;s<e.endIndex;s++)t.push(n.createElement("li",{className:"ListItem ListItem--loading"},n.createElement(o,null)));return n.createElement("div",{className:"Items Items--loading"},n.createElement("ol",{className:"Items__list",start:e.startIndex+1},t),n.createElement(r,{route:"news",page:e.pageNum,hasNext:e.hasNext}))}return n.createElement("div",{className:"Items"},n.createElement("ol",{className:"Items__list",start:e.startIndex+1},this.renderItems(e.startIndex,e.endIndex)),n.createElement(r,{route:"news",page:e.pageNum,hasNext:e.hasNext}))},renderItems:function(e,t){for(var s=[],i=e;t>i;i++){var r=this.state.topStories[i],o=this.state.topStoryIds[i];s.push(o?n.createElement(a,{key:o,id:o,topIndex:i,cachedItem:r}):n.createElement(a,{cachedItem:r}))}return s}});t.exports=p},{"./Paginator":6,"./Spinner":10,"./TopStoryListItem":12,"./mixins/PageNumberMixin":18,"./stores/TopStore":24,"./utils/constants":28,"./utils/pageCalc":30,"./utils/setTitle":32,react:"react"}],12:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./stores/StoryCommentThreadStore"),r=e("./services/HNService"),o=e("./stores/TopStore"),a=e("./mixins/ItemMixin"),m=e("./mixins/ListItemMixin"),l=e("./Spinner"),c=n.createClass({displayName:"TopStoryListItem",mixins:[a,m,s],propTypes:{id:n.PropTypes.number,cachedItem:n.PropTypes.object,topIndex:n.PropTypes.number},getDefaultProps:function(){return{id:null,cachedItem:null,topIndex:null}},getInitialState:function(){return{item:this.props.cachedItem||{}}},componentWillMount:function(){o.on(this.props.id,this.updateThreadState),null!=this.props.id?this.initLiveItem():null!=this.props.cachedItem&&(this.threadState=i.loadState(this.state.item.id))},componentWillUnmount:function(){o.off(this.props.id,this.updateThreadState)},componentWillReceiveProps:function(e){null==this.props.id&&null!=e.id&&this.initLiveItem()},componentWillUpdate:function(e,t){this.state.item!==t.item&&o.setItem(this.props.topIndex,t.item)},initLiveItem:function(){this.bindAsObject(r.itemRef(this.props.id),"item"),this.threadState=i.loadState(this.props.id)},updateThreadState:function(){this.threadState=i.loadState(this.props.id),this.forceUpdate()},render:function(){return this.state.item.id?this.renderListItem(this.state.item,this.threadState):n.createElement("li",{className:"ListItem ListItem--loading"},n.createElement(l,null))}});t.exports=c},{"./Spinner":10,"./mixins/ItemMixin":16,"./mixins/ListItemMixin":17,"./services/HNService":19,"./stores/StoryCommentThreadStore":23,"./stores/TopStore":24,react:"react",reactfire:"reactfire"}],13:[function(e,t){"use strict";function n(e){return!e.dead}function s(e){return r.showDead?e:{comments:e.comments.filter(n),stories:e.stories.filter(n)}}var i=e("react"),r=e("./stores/SettingsStore"),o=e("./stores/UpdatesStore"),a=e("./DisplayListItem"),m=e("./DisplayComment"),l=e("./Paginator"),c=e("./Spinner"),d=e("./mixins/PageNumberMixin"),u=e("./utils/constants"),p=u.ITEMS_PER_PAGE,h=e("./utils/pageCalc"),f=e("./utils/setTitle"),g=i.createClass({displayName:"Updates",mixins:[d],getInitialState:function(){return s(o.getUpdates())},componentWillMount:function(){this.setTitle(this.props.type),o.start(),o.on("updates",this.handleUpdates)},componentWillUnmount:function(){o.off("updates",this.handleUpdates),o.stop()},componentWillReceiveProps:function(e){this.props.type!=e.type&&this.setTitle(e.type)},setTitle:function(e){f("New "+("comments"==e?"Comments":"Links"))},handleUpdates:function(e){this.isMounted()&&this.setState(s(e))},render:function(){var e="comments"==this.props.type?this.state.comments:this.state.stories;if(0===e.length)return i.createElement("div",{className:"Updates Updates--loading"},i.createElement(c,{size:"20"}));var t=h(this.getPageNumber(),p,e.length);return"comments"==this.props.type?i.createElement("div",{className:"Updates Comments"},e.slice(t.startIndex,t.endIndex).map(function(e){return i.createElement(m,{key:e.id,id:e.id,comment:e})}),i.createElement(l,{route:"newcomments",page:t.pageNum,hasNext:t.hasNext})):i.createElement("div",{className:"Updates Items"},i.createElement("ol",{className:"Items__list",start:t.startIndex+1},e.slice(t.startIndex,t.endIndex).map(function(e){return i.createElement(a,{key:e.id,item:e})})),i.createElement(l,{route:"newest",page:t.pageNum,hasNext:t.hasNext}))}});t.exports=g},{"./DisplayComment":3,"./DisplayListItem":4,"./Paginator":6,"./Spinner":10,"./mixins/PageNumberMixin":18,"./stores/SettingsStore":22,"./stores/UpdatesStore":25,"./utils/constants":28,"./utils/pageCalc":30,"./utils/setTitle":32,react:"react"}],14:[function(e,t){"use strict";var n=e("moment"),s=e("react"),i=e("reactfire"),r=e("./services/HNService"),o=e("./Spinner"),a=e("./utils/setTitle"),m=s.createClass({displayName:"UserProfile",mixins:[i],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(r.userRef(this.props.params.id),"user")},componentWillUpdate:function(e,t){this.state.user.id!=t.user.id&&a("Profile: "+t.user.id)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("user"),this.bindAsObject(r.userRef(e.params.id),"user"))},render:function(){var e=this.state.user;if(!e.id)return s.createElement("div",{className:"UserProfile UserProfile--loading"},s.createElement("h4",null,this.props.params.id),s.createElement(o,{size:"20"}));var t=n(1e3*e.created);return s.createElement("div",{className:"UserProfile"},s.createElement("h4",null,e.id),s.createElement("dl",null,s.createElement("dt",null,"Created"),s.createElement("dd",null,t.fromNow()," (",t.format("LL"),")"),s.createElement("dt",null,"Karma"),s.createElement("dd",null,e.karma),s.createElement("dt",null,"Delay"),s.createElement("dd",null,e.delay),e.about&&s.createElement("dt",null,"About"),e.about&&s.createElement("dd",null,s.createElement("div",{className:"UserProfile__about",dangerouslySetInnerHTML:{__html:e.about}}))))}});t.exports=m},{"./Spinner":10,"./services/HNService":19,"./utils/setTitle":32,moment:"moment",react:"react",reactfire:"reactfire"}],15:[function(e,t){"use strict";var n=e("moment"),s=e("react"),i=e("react-router"),r=i.Link,o=e("../stores/ItemStore"),a=e("../stores/SettingsStore"),m=e("../Spinner"),l=e("../utils/pluralise"),c={fetchAncestors:function(e){o.fetchCommentAncestors(e,function(e){this.isMounted()&&this.setState({parent:e.parent,op:e.op})}.bind(this))},renderCommentLoading:function(e){return s.createElement("div",{className:"Comment Comment--loading Comment--level"+this.props.level},(this.props.loadingSpinner||e.delayed)&&s.createElement(m,{size:"20"}),e.delayed&&s.createElement("div",{className:"Comment__text"},"Unable to load comment – this usually indicates the author has configured a delay. Trying again in 30 seconds."))},renderCommentDeleted:function(e,t){return s.createElement("div",{className:t.className},s.createElement("div",{className:"Comment__content"},s.createElement("div",{className:"Comment__meta"},"[deleted] | ",s.createElement("a",{href:"https://news.ycombinator.com/item?id="+e.id},"view on Hacker News"))))},renderCollapseControl:function(e){return s.createElement("span",{className:"Comment__collapse",onClick:this.toggleCollapse,onKeyPress:this.toggleCollapse,tabIndex:"0"},"[",e?"+":"–","]")},renderCommentMeta:function(e,t){return e.dead&&!a.showDead?s.createElement("div",{className:"Comment__meta"},t.collapsible&&this.renderCollapseControl(t.collapsed),t.collapsible&&" ","[dead]",t.childCounts&&" | ("+t.childCounts.children+" child"+l(t.childCounts.children,",ren"),t.childCounts&&t.childCounts.newComments>0&&", ",t.childCounts&&t.childCounts.newComments>0&&s.createElement("em",null,t.childCounts.newComments," new"),t.childCounts&&")"):s.createElement("div",{className:"Comment__meta"},t.collapsible&&this.renderCollapseControl(t.collapsed),t.collapsible&&" ",s.createElement(r,{to:"user",params:{id:e.by},className:"Comment__user"},e.by)," ",n(1e3*e.time).fromNow(),t.link&&" | ",t.link&&s.createElement(r,{to:"comment",params:{id:e.id}},"link"),t.parent&&" | ",t.parent&&s.createElement(r,{to:this.state.parent.type,params:{id:e.parent}},"parent"),t.op&&" | on: ",t.op&&s.createElement(r,{to:this.state.op.type,params:{id:this.state.op.id}},this.state.op.title),e.dead&&" | [dead]",t.childCounts&&" | ("+t.childCounts.children+" child"+l(t.childCounts.children,",ren"),t.childCounts&&t.childCounts.newComments>0&&", ",t.childCounts&&t.childCounts.newComments>0&&s.createElement("em",null,t.childCounts.newComments," new"),t.childCounts&&")")},renderCommentText:function(e,t){return s.createElement("div",{className:"Comment__text"},!e.dead||a.showDead?s.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}}):"[dead]",a.replyLinks&&t.replyLink&&!e.dead&&s.createElement("p",null,s.createElement("a",{href:"https://news.ycombinator.com/reply?id="+e.id},"reply")))}};t.exports=c},{"../Spinner":10,"../stores/ItemStore":21,"../stores/SettingsStore":22,"../utils/pluralise":31,moment:"moment",react:"react","react-router":"react-router"}],16:[function(e,t){"use strict";var n=e("react"),s=e("moment"),i=e("react-router"),r=i.Link,o=e("../utils/pluralise"),a=function(){var e=document.createElement("a");return function(t){e.href=t;var n=e.hostname.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}}(),m={renderItemMeta:function(e,t,i){var a=s(1e3*e.time),m=e.kids&&e.kids.length>0?"comments":"discuss";return t.commentCount>0&&(m=t.commentCount+" comment"+o(t.commentCount)),-1!=this.constructor.displayName.indexOf("ListItem")&&(null===t.lastVisit&&e.kids&&e.kids.length&&(m=e.kids.length+" thread"+o(e.kids.length)),m=n.createElement(r,{to:e.type,params:{id:e.id}},m)),"job"==e.type?n.createElement("div",{className:"Item__meta"},n.createElement("span",{className:"Item__time"},a.fromNow())):n.createElement("div",{className:"Item__meta"},n.createElement("span",{className:"Item__score"},e.score," point",o(e.score))," ",n.createElement("span",{className:"Item__by"},"by ",n.createElement(r,{to:"user",params:{id:e.by}},e.by))," ",n.createElement("span",{className:"Item__time"},a.fromNow())," | ",m,i)},renderItemTitle:function(e){var t,s=!!e.url;return t=e.dead?"[dead] "+e.title:s?n.createElement("a",{href:e.url},e.title):n.createElement(r,{to:e.type,params:{id:e.id}},e.title),n.createElement("div",{className:"Item__title"},t,s&&" ",s&&n.createElement("span",{className:"Item__host"},"(",a(e.url),")"))}};t.exports=m},{"../utils/pluralise":31,moment:"moment",react:"react","react-router":"react-router"}],17:[function(e,t){"use strict";function n(e,t){return e?e.filter(t):[]}var s=e("react"),i=e("react-router"),r=i.Link,o=e("../utils/buildClassName"),a=e("../utils/pluralise"),m={getNewThreadCount:function(e,t){return null===t.lastVisit?0:n(e.kids,function(e){return e>t.maxCommentId}).length},renderListItem:function(e,t){if(e.deleted)return null;var n=this.getNewThreadCount(e,t),i=n>0;return s.createElement("li",{className:o("ListItem",{"ListItem--dead":e.dead})},this.renderItemTitle(e),this.renderItemMeta(e,t,null!==t.lastVisit&&s.createElement("span",null," ","(",t.lastVisit.fromNow(),")",i&&" | ",i&&s.createElement(r,{to:e.type,params:{id:e.id}},n," new thread",a(n)))))}};t.exports=m},{"../utils/buildClassName":26,"../utils/pluralise":31,react:"react","react-router":"react-router"}],18:[function(e,t){"use strict";var n={getPageNumber:function(e){return"undefined"==typeof e&&(e=this.props.query.page),e&&/^\d+$/.test(e)?Math.max(1,Number(e)):1}};t.exports=n},{}],19:[function(e,t){"use strict";function n(e,t){r(e).once("value",function(e){t(e.val())})}function s(e,t){function s(n){i.push(n),i.length>=e.length&&t(i)}var i=[];e.forEach(function(e){n(e,s)})}function i(){return l.child("topstories")}function r(e){return l.child("item/"+e)}function o(e){return l.child("user/"+e)}function a(){return l.child("updates/items")}var m=e("firebase"),l=new m("https://hacker-news.firebaseio.com/v0");t.exports={fetchItem:n,fetchItems:s,topStoriesRef:i,itemRef:r,userRef:o,updatesRef:a}},{firebase:"firebase"}],20:[function(e,t){"use strict";function n(e,t){this.itemId=e.id,this.onCommentsChanged=t,this.children={},this.children[e.id]=[],this.isNew={},this.isCollapsed={}}var s=e("../utils/extend");s(n.prototype,{getChildCounts:function(e){for(var t=0,n=0,s=[e.id];s.length;){for(var i=[],r=0,o=s.length;o>r;r++){var a=this.children[s[r]];a.length&&i.push.apply(i,a)}for(r=0,o=i.length;o>r;r++)this.isNew[i[r]]&&n++;t+=i.length,s=i}return{children:t,newComments:n}},commentAdded:function(e){e.deleted||(this.children[e.id]=[],this.children[e.parent].push(e.id))},commentDeleted:function(e){var t=this.children[e.parent];t.splice(t.indexOf(e.id),1)},toggleCollapse:function(e){this.isCollapsed[e]=!this.isCollapsed[e],this.onCommentsChanged({type:"collapse"})}}),t.exports=n},{"../utils/extend":29}],21:[function(e,t){"use strict";function n(e,t,n){for(var i=e.id,r=e.parent;a[r]||m[r];){if(n.itemCount++,n.cacheHits++,m[r])return 1==n.itemCount&&(n.parent=m[r]),n.op=m[r],void t(n);a[r]&&(1==n.itemCount&&(n.parent={id:r,type:"comment"}),i=r,r=a[r])}l.getItem(r,function(e){n.itemCount++,a[i]=r,"comment"==e.type&&(a[e.id]=e.parent),s(e,t,n)},n)}function s(e,t,s){1==s.itemCount&&(s.parent=e),"comment"!=e.type?(s.op=e,m[e.id]={id:e.id,type:e.type,title:e.title},t(s)):n(e,t,s)}var i=e("../services/HNService"),r=e("./TopStore"),o=e("./UpdatesStore"),a={},m={},l={getItem:function(e,t,n){var s=this.getCachedItem(e);
s?(n&&n.cacheHits++,setImmediate(t,s)):i.fetchItem(e,t)},getCachedItem:function(e){return r.getItem(e)||o.getItem(e)||null},getCachedStory:function(e){return r.getItem(e)||o.getStory(e)||null},fetchCommentAncestors:function(e,t){var s=Date.now(),i={itemCount:0,cacheHits:0};n(e,function(){i.timeTaken=Date.now()-s,setImmediate(t,i)},i)}};t.exports=l},{"../services/HNService":19,"./TopStore":24,"./UpdatesStore":25}],22:[function(e,t){"use strict";var n=e("../utils/extend"),s=e("../utils/storage"),i="settings",r={autoCollapse:!0,replyLinks:!0,showDead:!1,showDeleted:!1,load:function(){var e=s.get(i);e&&n(this,JSON.parse(e))},save:function(){s.set(i,JSON.stringify({autoCollapse:this.autoCollapse,showDead:this.showDead,showDeleted:this.showDeleted}))}};t.exports=r},{"../utils/extend":29,"../utils/storage":33}],23:[function(e,t){"use strict";function n(e){var t=l.get(e);if(t){var n=JSON.parse(t);return n.lastVisit=i(n.lastVisit),n}return{lastVisit:null,commentCount:0,maxCommentId:0}}function s(e,t,s){r.call(this,e,t),this.startedLoading=Date.now(),this.parents={},this.commentCount=0,this.newCommentCount=0,this.maxCommentId=0,this.loading=!0,this.expectedComments=e.kids?e.kids.length:0;var i=n(e.id);this.lastVisit=i.lastVisit,this.prevMaxCommentId=i.maxCommentId,this.isFirstVisit=null===i.lastVisit,s.cached||this.checkLoadCompletion()}var i=e("moment"),r=e("./CommentThreadStore"),o=e("./SettingsStore"),a=e("../utils/cancellableDebounce"),m=e("../utils/extend"),l=(e("../utils/pluralise"),e("../utils/storage"));s.loadState=n,s.prototype=m(Object.create(r.prototype),{constructor:s,numberOfCommentsChanged:a(function(){this.onCommentsChanged({type:"number"})},123),firstLoadComplete:function(){this.lastVisit=i(Date.now()),this.prevMaxCommentId=this.maxCommentId,this.isFirstVisit=!1,this.onCommentsChanged({type:"first_load_complete"})},checkLoadCompletion:function(){this.loading&&this.commentCount>=this.expectedComments&&(this.loading=!1,this.isFirstVisit?this.firstLoadComplete():o.autoCollapse&&this.newCommentCount>0&&this.collapseThreadsWithoutNewComments(),this._storeState())},_storeState:function(){l.set(this.itemId,JSON.stringify({lastVisit:Date.now(),commentCount:this.commentCount,maxCommentId:this.maxCommentId}))},commentAdded:function(e){return e.deleted?void(this.loading&&(this.expectedComments--,this.checkLoadCompletion())):(r.prototype.commentAdded.call(this,e),e.dead&&!o.showDead?this.expectedComments--:this.commentCount++,this.loading&&e.kids&&(this.expectedComments+=e.kids.length),this.prevMaxCommentId>0&&e.id>this.prevMaxCommentId&&(!e.dead||o.showDead)&&(this.newCommentCount++,this.isNew[e.id]=!0),e.id>this.maxCommentId&&(this.maxCommentId=e.id),e.parent!=this.itemId&&(this.parents[e.id]=e.parent),this.numberOfCommentsChanged(),void(this.loading&&this.checkLoadCompletion()))},commentDelayed:function(){this.expectedComments--},commentDeleted:function(e){r.prototype.commentDeleted.call(this,e),this.commentCount--,this.isNew[e.id]&&(this.newCommentCount--,delete this.isNew[e.id]),delete this.parents[e.id],this.numberOfCommentsChanged()},commentDied:function(e){o.showDead||(this.commentCount--,this.isNew[e.id]&&(this.newCommentCount--,delete this.isNew[e.id]))},adjustExpectedComments:function(e){this.expectedComments+=e,this.checkLoadCompletion()},collapseThreadsWithoutNewComments:function(){for(var e=Object.keys(this.isNew),t={},n=0,s=e.length;s>n;n++)for(var i=this.parents[e[n]];i&&!t[i];)t[i]=!0,i=this.parents[i];for(var r={},o=this.children[this.itemId];o.length;){var a=[];for(n=0,s=o.length;s>n;n++){var m=o[n];if(t[m]){var l=this.children[m];l.length&&a.push.apply(a,l)}else this.isNew[m]||(r[m]=!0)}o=a}this.isCollapsed=r,this.onCommentsChanged({type:"collapse"})},markAsRead:function(){this.lastVisit=i(Date.now()),this.newCommentCount=0,this.prevMaxCommentId=this.maxCommentId,this.isNew={},this._storeState()},dispose:function(){this.numberOfCommentsChanged.cancel(),this._storeState()}}),t.exports=s},{"../utils/cancellableDebounce":27,"../utils/extend":29,"../utils/pluralise":31,"../utils/storage":33,"./CommentThreadStore":20,"./SettingsStore":22,moment:"moment"}],24:[function(e,t){"use strict";function n(){for(var e=0,t=c.length;t>e;e++)u[e]=d[c[e]]||null}function s(e){c=e.val(),n(),p.emit("update",p.getTopStories())}function i(e){d[e.key]&&p.emit(e.key)}var r=e("events"),o=r.EventEmitter,a=e("../services/HNService"),m=e("../utils/extend"),l=null,c=null,d=null,u=[],p=m(new o,{loadSession:function(){var e=sessionStorage.topStories;d=e?JSON.parse(e):{},e=sessionStorage.topStoryIds,c=e?JSON.parse(e):[],n()},saveSession:function(){sessionStorage.topStories=JSON.stringify(d),sessionStorage.topStoryIds=JSON.stringify(c)},start:function(){null===l&&(l=a.topStoriesRef(),l.on("value",s))},stop:function(){null!==l&&(l.off(),l=null)},getItem:function(e){return d[e]||null},getTopStories:function(){return{topStories:u,topStoryIds:c}},setItem:function(e,t){u[e]=t,d[t.id]=t},listenToStorage:function(){window.addEventListener("storage",i)},stopListeningToStorage:function(){window.removeEventListener("storage",i)}});p.off=p.removeListener,t.exports=p},{"../services/HNService":19,"../utils/extend":29,events:"events"}],25:[function(e,t){"use strict";function n(e,t){return t.time-e.time}function s(e){var t=Object.keys(e).map(function(t){return e[t]});return t.sort(n),t}function i(){h.comments=r(p.comments),h.stories=r(p.stories)}function r(e){var t=s(e);return t.splice(c,Math.max(0,t.length-c)).forEach(function(t){delete e[t.id]}),t}function o(e){for(var t=0,n=e.length;n>t;t++){var s=e[t];s.deleted||"undefined"!=typeof f[s.type]&&("comment"==s.type?p.comments[s.id]=s:p.stories[s.id]=s)}i(),g.emit("updates",h)}var a=e("events").EventEmitter,m=e("../services/HNService"),l=e("../utils/constants"),c=l.UPDATES_CACHE_SIZE,d=e("../utils/extend"),u=null,p=null,h={},f={comment:!0,job:!0,poll:!0,story:!0},g=d(new a,{loadSession:function(){var e=sessionStorage.updates;p=e?JSON.parse(e):{comments:{},stories:{}},i()},saveSession:function(){sessionStorage.updates=JSON.stringify(p)},start:function(){null===u&&(u=m.updatesRef(),u.on("value",function(e){m.fetchItems(e.val(),o)}))},stop:function(){u.off(),u=null},getUpdates:function(){return h},getItem:function(e){return p.comments[e]||p.stories[e]||null},getComment:function(e){return p.comments[e]||null},getStory:function(e){return p.stories[e]||null}});g.off=g.removeListener,t.exports=g},{"../services/HNService":19,"../utils/constants":28,"../utils/extend":29,events:"events"}],26:[function(e,t){"use strict";function n(e,t){var n=[];"undefined"==typeof t?t=e:n.push(e);for(var s=Object.keys(t),i=0,r=s.length;r>i;i++)t[s[i]]&&n.push(s[i]);return n.join(" ")}t.exports=n},{}],27:[function(e,t){"use strict";function n(e,t,n){var s,i,r,o,a,m=function(){var l=Date.now()-o;t>l&&l>0?s=setTimeout(m,t-l):(s=null,n||(a=e.apply(r,i),s||(r=i=null)))},l=function(){r=this,i=arguments,o=Date.now();var l=n&&!s;return s||(s=setTimeout(m,t)),l&&(a=e.apply(r,i),r=i=null),a};return l.cancel=function(){s&&clearTimeout(s)},l}t.exports=n},{}],28:[function(e,t){"use strict";t.exports={ITEMS_PER_PAGE:30,SITE_TITLE:"React HN",TOP_STORIES:100,UPDATES_CACHE_SIZE:200}},{}],29:[function(e,t){"use strict";function n(e,t,n){for(var s=Object.keys(t),i=0,r=s.length;r>i;i++)e[s[i]]=t[s[i]];if(n)for(s=Object.keys(n),i=0,r=s.length;r>i;i++)e[s[i]]=n[s[i]];return e}t.exports=n},{}],30:[function(e,t){"use strict";function n(e,t,n){var s=(e-1)*t,i=Math.min(n,s+t),r=n-1>i;return{pageNum:e,startIndex:s,endIndex:i,hasNext:r}}t.exports=n},{}],31:[function(e,t){"use strict";function n(e,t){return(t||",s").split(",")[1==e?0:1]}t.exports=n},{}],32:[function(e,t){"use strict";function n(e){document.title=e?e+" | "+i:i}var s=e("./constants"),i=s.SITE_TITLE;t.exports=n},{"./constants":28}],33:[function(e,t){"use strict";t.exports={get:function(e,t){var n=localStorage[e];return"undefined"!=typeof n?n:t},set:function(e,t){localStorage[e]=t}}},{}],34:[function(){!function(e,t){"use strict";function n(e){return h[p]=s.apply(t,e),p++}function s(e){var n=[].slice.call(arguments,1);return function(){"function"==typeof e?e.apply(t,n):new Function(""+e)()}}function i(e){if(f)setTimeout(s(i,e),0);else{var t=h[e];if(t){f=!0;try{t()}finally{r(e),f=!1}}}}function r(e){delete h[e]}function o(){u=function(){var e=n(arguments);return process.nextTick(s(i,e)),e}}function a(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function m(){var t="setImmediate$"+Math.random()+"$",s=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&i(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),u=function(){var s=n(arguments);return e.postMessage(t+s,"*"),s}}function l(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;i(t)},u=function(){var t=n(arguments);return e.port2.postMessage(t),t}}function c(){var e=g.documentElement;u=function(){var t=n(arguments),s=g.createElement("script");return s.onreadystatechange=function(){i(t),s.onreadystatechange=null,e.removeChild(s),s=null},e.appendChild(s),t}}function d(){u=function(){var e=n(arguments);return setTimeout(s(i,e),0),e}}if(!e.setImmediate){var u,p=1,h={},f=!1,g=e.document,C=Object.getPrototypeOf&&Object.getPrototypeOf(e);C=C&&C.setTimeout?C:e,"[object process]"==={}.toString.call(e.process)?o():a()?m():e.MessageChannel?l():g&&"onreadystatechange"in g.createElement("script")?c():d(),C.setImmediate=u,C.clearImmediate=r}}(new Function("return this")())},{}]},{},[1]);