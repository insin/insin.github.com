!function e(t,n,r){function s(a,o){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!o&&l)return l(a,!0);if(i)return i(a,!0);var m=new Error("Cannot find module '"+a+"'");throw m.code="MODULE_NOT_FOUND",m}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return s(n?n:e)},u,u.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)s(r[a]);return s}({1:[function(e){"use strict";var t=e("react"),n=e("react-router"),r=e("./Comment"),s=e("./Item"),i=e("./Items"),a=e("./UserProfile"),o=n.DefaultRoute,l=n.Link,m=n.NotFoundRoute,u=n.Route,c=n.Routes,d=t.createClass({displayName:"App",render:function(){return t.DOM.div({className:"App"},t.DOM.div({className:"App__header"},t.DOM.img({src:"logo.png",width:"16",height:"16",alt:""})," ",l({to:"news",className:"App__homelink"},"React Hacker News")),t.DOM.div({className:"App__content"},this.props.activeRouteHandler(null)),t.DOM.div({className:"App__footer"},t.DOM.a({href:"https://github.com/insin/react-hn"},"Source on GitHub")))}}),p=t.createClass({displayName:"NotFound",render:function(){return t.DOM.h2(null,"Not found")}}),h=c({location:"hash"},u({name:"app",path:"/",handler:d},o({handler:i}),m({handler:p}),u({name:"news",path:"news",handler:i}),u({name:"item",path:"item/:id",handler:s}),u({name:"job",path:"job/:id",handler:s}),u({name:"poll",path:"poll/:id",handler:s}),u({name:"story",path:"story/:id",handler:s}),u({name:"comment",path:"comment/:id",handler:r,permalinked:!0}),u({name:"user",path:"user/:id",handler:a})));window.React=t,t.renderComponent(h,document.getElementById("app"))},{"./Comment":2,"./Item":3,"./Items":4,"./UserProfile":9,react:"react","react-router":"react-router"}],2:[function(e,t){"use strict";var n=e("moment"),r=e("react"),s=e("reactfire"),i=e("react-router"),a=e("./stores/CommentThreadStore"),o=e("./stores/ItemStore"),l=e("./Spinner"),m=e("./utils/buildClassName"),u=e("./utils/setTitle"),c=i.Link,d=i.Navigation,p=r.createClass({displayName:"Comment",mixins:[s,d],getDefaultProps:function(){return{showSpinner:!1,permalink:!1,permalinkThread:!1,level:0,maxCommentId:0}},getInitialState:function(){return{comment:{},parent:{type:"comment"},collapsed:!1}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.id||this.props.params.id),"comment")},componentWillUpdate:function(e,t){if(this.props.permalinked&&this.state.comment.id!=t.comment.id){if("comment"!=t.comment.type)return void this.replaceWith(t.comment.type,{id:t.comment.id});u("Comment by "+t.comment.by)}},componentDidUpdate:function(e,t){this.isInPermalinkThread()?this.props.permalinked&&this.state.comment.parent!=t.comment.parent&&o.fetchItem(this.state.comment.parent,function(e){this.setState({parent:e})}.bind(this)):t.comment.id||!this.state.comment.id||this.state.comment.deleted?t.comment.id&&!t.comment.deleted&&this.state.comment.deleted&&a.deleteComment(this.props.id):a.addComment(this.props.id)},componentWillReceiveProps:function(e){this.props.permalinked&&this.props.params.id!=e.params.id&&(this.unbind("comment"),this.bindAsObject(o.itemRef(e.params.id),"comment"))},isInPermalinkThread:function(){return this.props.permalinked||this.props.permalinkThread},isNew:function(){return this.props.maxCommentId>0&&this.props.id>this.props.maxCommentId},toggleCollapsed:function(e){e.preventDefault(),this.setState({collapsed:!this.state.collapsed})},render:function(){var e=this.props,t=this.state.comment;return t.id?"comment"!=t.type?null:t.deleted&&!t.kids?null:r.DOM.div({className:m("Comment Comment--level"+e.level,{"Comment--collapsed":this.state.collapsed,"Comment--dead":t.dead,"Comment--deleted":t.deleted,"Comment--new":this.isNew()})},r.DOM.div({className:"Comment__content"},t.deleted&&r.DOM.div({className:"Comment__meta"},this.renderCollapseControl()," ","[deleted]"),!t.deleted&&r.DOM.div({className:"Comment__meta"},this.renderCollapseControl()," ",c({to:"user",params:{id:t.by},className:"Comment__user"},t.by)," ",n(1e3*t.time).fromNow()," | ",!e.permalinked&&c({to:"comment",params:{id:t.id}},"link"),e.permalinked&&c({to:this.state.parent.type,params:{id:t.parent}},"parent"),t.dead&&" | [dead]"),!t.deleted&&r.DOM.div({className:"Comment__text"},r.DOM.div({dangerouslySetInnerHTML:{__html:t.text}}))),t.kids&&r.DOM.div({className:"Comment__kids"},t.kids.map(function(t,n){return p({key:t,id:t,level:e.level+1,showSpinner:e.showSpinner||e.permalinked&&0===n,permalinkThread:e.permalinkThread||e.permalinked,maxCommentId:e.maxCommentId})}))):r.DOM.div({className:m("Comment Comment--loading Comment--level"+e.level,{"Comment--new":this.isNew()})},(e.permalinked||e.showSpinner)&&l({size:"20"}),t.error&&r.DOM.p(null,"Error loading comment - this may be because the author has configured a delay."))},renderCollapseControl:function(){return r.DOM.span({className:"Comment__collapse",onClick:this.toggleCollapsed,onKeyPress:this.toggleCollapsed,tabIndex:"0"},"[",this.state.collapsed?"+":"â€“","]")}});t.exports=p},{"./Spinner":8,"./stores/CommentThreadStore":12,"./stores/ItemStore":13,"./utils/buildClassName":14,"./utils/setTitle":17,moment:"moment",react:"react","react-router":"react-router",reactfire:"reactfire"}],3:[function(e,t){"use strict";function n(e){return e.fromNow(!0).replace(/^an? /,"")}var r=e("react"),s=e("reactfire"),i=e("./Comment"),a=e("./stores/CommentThreadStore"),o=e("./stores/ItemStore"),l=e("./PollOption"),m=e("./Spinner"),u=e("./utils/buildClassName"),c=e("./renderItemTitle"),d=e("./renderItemMeta"),p=e("./utils/setTitle"),h=r.createClass({displayName:"Item",mixins:[s],getInitialState:function(){return{item:{},lastVisit:null,commentCount:0,maxCommentId:0,newCommentCount:0}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.params.id),"item"),this.setState(a.init(this.props.params.id,this.handleCommentsAdded)),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){a.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillUpdate:function(e,t){this.state.item.id!=t.item.id&&p(t.item.title)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("item"),this.bindAsObject(o.itemRef(e.params.id),"item"),a.dispose(),this.setState(a.init(e.params.id,this.handleCommentsAdded)))},handleBeforeUnload:function(){a.dispose()},handleCommentsAdded:function(e){this.setState(e)},markAsRead:function(e){e.preventDefault(),this.setState(a.markAsRead())},render:function(){var e=this.state,t=e.item;return t.id?r.DOM.div({className:u("Item",{"Item--dead":t.dead})},r.DOM.div({className:"Item__content"},c(t),d(t,e,"detail",e.newCommentCount>0&&r.DOM.span(null," ","(",r.DOM.em(null,e.newCommentCount," new")," in the last ",n(e.lastVisit),") | ",r.DOM.span({className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),t.text&&r.DOM.div({className:"Item__text"},r.DOM.div({dangerouslySetInnerHTML:{__html:t.text}})),"poll"==t.type&&r.DOM.div({className:"Item__poll"},t.parts.map(function(e){return l({key:e,id:e})}))),t.kids&&r.DOM.div({className:"Item__kids"},t.kids.map(function(t,n){return i({key:t,id:t,level:0,showSpinner:0===n,maxCommentId:e.maxCommentId})}))):r.DOM.div({className:"Item Item--loading"},m({size:"20"}))}});t.exports=h},{"./Comment":2,"./PollOption":7,"./Spinner":8,"./renderItemMeta":10,"./renderItemTitle":11,"./stores/CommentThreadStore":12,"./stores/ItemStore":13,"./utils/buildClassName":14,"./utils/setTitle":17,react:"react",reactfire:"reactfire"}],4:[function(e,t){"use strict";var n=e("react"),r=e("reactfire"),s=e("./stores/ItemStore"),i=e("./ListItem"),a=e("./Paginator"),o=e("./Spinner"),l=e("./utils/setTitle"),m=30,u=n.createClass({displayName:"Items",mixins:[r],getInitialState:function(){return{items:[]}},componentWillMount:function(){this.bindAsObject(s.topStoriesRef(),"items"),l()},getPage:function(){return this.props.query.page&&/^\d+$/.test(this.props.query.page)?Math.max(1,Number(this.props.query.page)):1},render:function(){var e=this.getPage(),t=(e-1)*m,r=t+m,s=r<this.state.items.length-1;if(0===this.state.items.length){for(var l=[],u=0;m>u;u++)l.push(n.DOM.li({className:"ListItem ListItem--loading"},o(null)));return n.DOM.div({className:"Items Items--loading"},n.DOM.ol({className:"Items__list",start:t+1},l),a({route:"news",page:e,hasNext:s}))}var c=this.state.items.slice(t,r);return n.DOM.div({className:"Items"},n.DOM.ol({className:"Items__list",start:t+1},c.map(function(e){return i({key:e,id:e})})),a({route:"news",page:e,hasNext:s}))}});t.exports=u},{"./ListItem":5,"./Paginator":6,"./Spinner":8,"./stores/ItemStore":13,"./utils/setTitle":17,react:"react",reactfire:"reactfire"}],5:[function(e,t){"use strict";var n=e("react"),r=e("reactfire"),s=e("react-router"),i=e("./stores/CommentThreadStore"),a=e("./stores/ItemStore"),o=e("./Spinner"),l=e("./utils/buildClassName"),m=e("./utils/pluralise"),u=e("./renderItemTitle"),c=e("./renderItemMeta"),d=s.Link,p=n.createClass({displayName:"ListItem",mixins:[r],getInitialState:function(){return{item:{},lastVisit:null,commentCount:null,maxCommentId:null}},componentWillMount:function(){this.bindAsObject(a.itemRef(this.props.id),"item"),this.setState(i.getCommentData(this.props.id))},render:function(){var e=this.state,t=e.item;if(!t.id)return n.DOM.li({className:"ListItem ListItem--loading"},o(null));if(t.deleted)return null;var r=null===e.lastVisit?0:t.kids.filter(function(t){return t>e.maxCommentId}).length,s=r>0;return n.DOM.li({className:l("ListItem",{"ListItem--dead":t.dead})},u(t),c(t,e,"list",null!==e.lastVisit&&n.DOM.span(null," ","(",e.lastVisit.fromNow(),")",s&&" | ",s&&d({to:"item",params:{id:t.id}},n.DOM.em(null,r," new thread",m(r))))))}});t.exports=p},{"./Spinner":8,"./renderItemMeta":10,"./renderItemTitle":11,"./stores/CommentThreadStore":12,"./stores/ItemStore":13,"./utils/buildClassName":14,"./utils/pluralise":16,react:"react","react-router":"react-router",reactfire:"reactfire"}],6:[function(e,t){"use strict";var n=e("react"),r=e("react-router"),s=r.Link,i=n.createClass({displayName:"Paginator",render:function(){return n.DOM.div({className:"Paginator"},this.props.page>1&&n.DOM.span({className:"Paginator__prev"},s({to:this.props.route,query:{page:this.props.page-1}},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&n.DOM.span({className:"Paginator__next"},s({to:this.props.route,query:{page:this.props.page+1}},"More")))}});t.exports=i},{react:"react","react-router":"react-router"}],7:[function(e,t){"use strict";var n=e("react"),r=e("reactfire"),s=e("./stores/ItemStore"),i=e("./Spinner"),a=e("./utils/pluralise"),o=n.createClass({displayName:"PollOption",mixins:[r],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(s.itemRef(this.props.id),"pollopt")},render:function(){var e=this.state.pollopt;return e.id?n.DOM.div({className:"PollOption"},n.DOM.div({className:"PollOption__text"},e.text),n.DOM.div({className:"PollOption__score"},e.score," point",a(e.score))):n.DOM.div({className:"PollOption PollOption--loading"},i({size:"20"}))}});t.exports=o},{"./Spinner":8,"./stores/ItemStore":13,"./utils/pluralise":16,react:"react",reactfire:"reactfire"}],8:[function(e,t){"use strict";var n=e("react"),r=n.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var e=this.props.size+"px",t={height:e,width:e,marginRight:this.props.spacing+"px"};return n.DOM.div({className:"Spinner",style:{width:3*(this.props.size+this.props.spacing)+"px"}},n.DOM.div({className:"bounce1",style:t}),n.DOM.div({className:"bounce2",style:t}),n.DOM.div({className:"bounce3",style:t}))}});t.exports=r},{react:"react"}],9:[function(e,t){"use strict";var n=e("moment"),r=e("react"),s=e("reactfire"),i=e("./stores/ItemStore"),a=e("./Spinner"),o=e("./utils/setTitle"),l=r.createClass({displayName:"UserProfile",mixins:[s],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(i.userRef(this.props.params.id),"user")},componentWillUpdate:function(e,t){this.state.user.id!=t.user.id&&o("Profile: "+t.user.id)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("user"),this.bindAsObject(i.userRef(e.params.id),"user"))},render:function(){var e=this.state.user;if(!e.id)return r.DOM.div({className:"UserProfile UserProfile--loading"},r.DOM.h4(null,this.props.params.id),a({size:"20"}));var t=n(1e3*e.created);return r.DOM.div({className:"UserProfile"},r.DOM.h4(null,e.id),r.DOM.dl(null,r.DOM.dt(null,"Created"),r.DOM.dd(null,t.fromNow()," (",t.format("LL"),")"),r.DOM.dt(null,"Karma"),r.DOM.dd(null,e.karma),r.DOM.dt(null,"Delay"),r.DOM.dd(null,e.delay),e.about&&r.DOM.dt(null,"About"),e.about&&r.DOM.dd(null,r.DOM.div({className:"UserProfile__about",dangerouslySetInnerHTML:{__html:e.about}}))))}});t.exports=l},{"./Spinner":8,"./stores/ItemStore":13,"./utils/setTitle":17,moment:"moment",react:"react",reactfire:"reactfire"}],10:[function(e,t){"use strict";function n(e,t,n,i){var l=s(1e3*e.time),m="job"!=e.type,u=e.kids&&e.kids.length>0?"comments":"discuss";return null!==t.lastVisit&&(u=t.commentCount+" comment"+a(t.commentCount)),"list"==n&&(u=o({to:e.type,params:{id:e.id}},u)),r.DOM.div({className:"Item__meta"},m&&r.DOM.span({className:"Item__score"},e.score," point",a(e.score))," ",m&&r.DOM.span({className:"Item__by"},"by ",o({to:"user",params:{id:e.by}},e.by))," ",r.DOM.span({className:"Item__time"},l.fromNow()),m&&" | ",m&&u,i)}var r=e("react"),s=e("moment"),i=e("react-router"),a=e("./utils/pluralise"),o=i.Link;t.exports=n},{"./utils/pluralise":16,moment:"moment",react:"react","react-router":"react-router"}],11:[function(e,t){"use strict";function n(e){var t,n=!!e.url;return t=e.dead?"[dead] "+e.title:n?r.DOM.a({href:e.url},e.title):i({to:e.type,params:{id:e.id}},e.title),r.DOM.div({className:"Item__title"},t,n&&" ",n&&r.DOM.span({className:"Item__host"},"(",a(e.url),")"))}var r=e("react"),s=e("react-router"),i=s.Link,a=function(){var e=document.createElement("a");return function(t){e.href=t;var n=e.hostname.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}}();t.exports=n},{react:"react","react-router":"react-router"}],12:[function(e,t){"use strict";function n(){i.set(m+a,c),i.set(m+o,Date.now()),i.set(m+l,h)}var r=e("moment"),s=e("../utils/cancellableDebounce"),i=e("../utils/storage"),a=":cc",o=":lv",l=":mc",m=null,u=null,c=null,d=null,p=null,h=null,f=null,v=null,C=s(function(){u({commentCount:c,newCommentCount:d})},100),O=s(function(){f=h,v=!1},5e3);t.exports={init:function(e,t){m=e,u=t,c=0,d=0,p={},h=0;var n=this.getCommentData(m);return f=n.maxCommentId,v=null===n.lastVisit,n},dispose:function(){null!==m&&(C.cancel(),n(),m=null,u=null,p=null)},markAsRead:function(){return d=0,f=h,p={},n(),{lastVisit:r(),maxCommentId:h,newCommentCount:d}},addComment:function(e){c++,null!==f&&e>f&&(d++,p[e]=!0),e>h&&(h=e),C(),v&&O()},deleteComment:function(e){c--,"undefined"!=typeof p[e]&&d--,C()},getCommentData:function(e){var t=i.get(e+o,null);return{lastVisit:null!==t?r(Number(t)):null,commentCount:Number(i.get(e+a,"0")),maxCommentId:Number(i.get(e+l,"0"))}}}},{"../utils/cancellableDebounce":15,"../utils/storage":18,moment:"moment"}],13:[function(e,t){"use strict";var n=e("firebase"),r=new n("https://hacker-news.firebaseio.com/v0");t.exports={topStoriesRef:function(){return r.child("topstories")},itemRef:function(e){return r.child("item/"+e)},userRef:function(e){return r.child("user/"+e)},fetchItem:function(e,t){this.itemRef(e).once("value",function(e){t(e.val())})}}},{firebase:"firebase"}],14:[function(e,t){"use strict";function n(e,t){var n=[];"undefined"==typeof t?t=e:n.push(e);for(var r=Object.keys(t),s=0,i=r.length;i>s;s++)t[r[s]]&&n.push(r[s]);return n.join(" ")}t.exports=n},{}],15:[function(e,t){"use strict";function n(e,t,n){var r,s,i,a,o,l=function(){var m=Date.now()-a;t>m&&m>0?r=setTimeout(l,t-m):(r=null,n||(o=e.apply(i,s),r||(i=s=null)))},m=function(){i=this,s=arguments,a=Date.now();var m=n&&!r;return r||(r=setTimeout(l,t)),m&&(o=e.apply(i,s),i=s=null),o};return m.cancel=function(){r&&clearTimeout(r)},m}t.exports=n},{}],16:[function(e,t){"use strict";function n(e){return 1==e?"":"s"}t.exports=n},{}],17:[function(e,t){"use strict";function n(e){document.title=e?e+" | "+r:r}var r="React Hacker News";t.exports=n},{}],18:[function(e,t){"use strict";t.exports={get:function(e,t){var n=localStorage[e];return"undefined"!=typeof n?n:t},set:function(e,t){localStorage[e]=t}}},{}]},{},[1]);