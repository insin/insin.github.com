!function e(t,n,s){function i(r,a){if(!n[r]){if(!t[r]){var m="function"==typeof require&&require;if(!a&&m)return m(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){var n=t[r][1][e];return i(n?n:e)},c,c.exports,e,t,n,s)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)i(s[r]);return i}({1:[function(e){"use strict";e("setimmediate");var t=e("react"),n=e("react-router"),s=e("./stores/TopStore"),i=e("./stores/UpdatesStore"),o=e("./PermalinkedComment"),r=e("./Item"),a=e("./TopStories"),m=e("./Updates"),l=e("./UserProfile"),c=n.DefaultRoute,d=n.Link,u=n.NotFoundRoute,p=n.Route,h=n.Routes,f=t.createClass({displayName:"App",componentWillMount:function(){window.addEventListener("beforeunload",this.handleBeforeUnload),s.loadSession(),i.loadSession()},componentWillUnmount:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},handleBeforeUnload:function(){s.stop(),s.saveSession(),i.saveSession()},render:function(){return t.DOM.div({className:"App"},t.DOM.div({className:"App__header"},t.DOM.img({src:"logo.png",width:"16",height:"16",alt:""})," ",d({to:"news",className:"App__homelink"},"React HN")," ",d({to:"newest"},"new")," | ",d({to:"newcomments"},"comments")),t.DOM.div({className:"App__content"},this.props.activeRouteHandler(null)),t.DOM.div({className:"App__footer"},"react-hn v","0.1.0"," | ",t.DOM.a({href:"https://github.com/insin/react-hn"},"insin/react-hn")))}}),C=t.createClass({displayName:"NotFound",render:function(){return t.DOM.h2(null,"Not found")}}),v=h({location:"hash"},p({name:"app",path:"/",handler:f},c({handler:a}),u({handler:C}),p({name:"news",path:"news",handler:a}),p({name:"item",path:"item/:id",handler:r}),p({name:"job",path:"job/:id",handler:r}),p({name:"poll",path:"poll/:id",handler:r}),p({name:"story",path:"story/:id",handler:r}),p({name:"comment",path:"comment/:id",handler:o}),p({name:"newest",path:"newest",handler:m,type:"links"}),p({name:"newcomments",path:"newcomments",handler:m,type:"comments"}),p({name:"user",path:"user/:id",handler:l})));window.React=t,t.renderComponent(v,document.getElementById("app"))},{"./Item":5,"./PermalinkedComment":7,"./TopStories":10,"./Updates":12,"./UserProfile":13,"./stores/TopStore":22,"./stores/UpdatesStore":23,react:"react","react-router":"react-router",setimmediate:32}],2:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./stores/CommentThreadStore"),o=e("./services/HNService"),r=e("./stores/UpdatesStore"),a=e("./mixins/CommentMixin"),m=e("./utils/buildClassName"),l=n.createClass({displayName:"Comment",mixins:[a,s],propTypes:{id:n.PropTypes.number.isRequired,level:n.PropTypes.number.isRequired,loadingSpinner:n.PropTypes.bool,threadStore:n.PropTypes.instanceOf(i).isRequired},getDefaultProps:function(){return{loadingSpinner:!1}},getInitialState:function(){return{comment:r.getComment(this.props.id)||{}}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.id),"comment"),this.state.comment.id&&this.props.threadStore.commentAdded(this.state.comment)},componentDidUpdate:function(e,t){t.comment.id||!this.state.comment.id||this.state.comment.deleted?t.comment.id&&!t.comment.deleted&&this.state.comment.deleted&&this.props.threadStore.commentDeleted(this.state.comment):this.props.threadStore.commentAdded(this.state.comment)},toggleCollapse:function(e){e.preventDefault(),this.props.threadStore.toggleCollapse(this.state.comment.id)},render:function(){var e=this.state.comment,t=this.props;if(!e.id)return this.renderCommentLoading(e);if(e.deleted)return this.renderCommentDeleted(e,{className:"Comment Comment--deleted Comment--level"+t.level});var s=t.threadStore.isNew[e.id],i=!!t.threadStore.isCollapsed[e.id],o=i&&t.threadStore.getChildCounts(e);i&&s&&(o.newComments=0);var r=m("Comment Comment--level"+t.level,{"Comment--collapsed":i,"Comment--dead":e.dead,"Comment--new":s});return n.DOM.div({className:r},n.DOM.div({className:"Comment__content"},this.renderCommentMeta(e,{collapsible:!0,collapsed:i,link:!0,childCounts:o}),this.renderCommentText(e)),e.kids&&n.DOM.div({className:"Comment__kids"},e.kids.map(function(e){return l({key:e,id:e,level:t.level+1,loadingSpinner:t.loadingSpinner,threadStore:t.threadStore})})))}});t.exports=l},{"./mixins/CommentMixin":14,"./services/HNService":18,"./stores/CommentThreadStore":19,"./stores/UpdatesStore":23,"./utils/buildClassName":24,react:"react",reactfire:"reactfire"}],3:[function(e,t){"use strict";var n=e("react"),s=e("./mixins/CommentMixin"),i=e("./utils/buildClassName"),o=n.createClass({displayName:"DisplayComment",mixins:[s],propTypes:{comment:n.PropTypes.object.isRequired},getInitialState:function(){return{op:{},parent:{type:"comment"}}},componentWillMount:function(){this.fetchAncestors(this.props.comment)},render:function(){if(this.props.comment.deleted)return null;var e=this.props.comment,t=i("Comment Comment--level0",{"Comment--dead":e.dead});return n.DOM.div({className:t},n.DOM.div({className:"Comment__content"},this.renderCommentMeta(e,{link:!0,parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!=this.state.op.id,op:!!this.state.op.id}),this.renderCommentText(e)))}});t.exports=o},{"./mixins/CommentMixin":14,"./utils/buildClassName":24,react:"react"}],4:[function(e,t){"use strict";var n=e("react"),s=e("./stores/StoryCommentThreadStore"),i=e("./mixins/ItemMixin"),o=e("./mixins/ListItemMixin"),r=n.createClass({displayName:"DisplayListItem",mixins:[i,o],propTypes:{item:n.PropTypes.object.isRequired},getInitialState:function(){return s.loadState(this.props.item.id)},render:function(){return this.renderListItem(this.props.item)}});t.exports=r},{"./mixins/ItemMixin":15,"./mixins/ListItemMixin":16,"./stores/StoryCommentThreadStore":21,react:"react"}],5:[function(e,t){"use strict";function n(e){return e.fromNow(!0).replace(/^an? /,"")}var s=e("react"),i=e("reactfire"),o=e("./services/HNService"),r=e("./stores/StoryCommentThreadStore"),a=e("./stores/ItemStore"),m=e("./Comment"),l=e("./PollOption"),c=e("./Spinner"),d=e("./mixins/ItemMixin"),u=e("./utils/buildClassName"),p=e("./utils/setTitle"),h=s.createClass({displayName:"Item",mixins:[d,i],getInitialState:function(){return{item:a.getCachedStory(Number(this.props.params.id))||{},lastVisit:null,commentCount:0,maxCommentId:0,newCommentCount:0}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.params.id),"item"),this.initThreadStore(),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){this.threadStore.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillUpdate:function(e,t){this.state.item.id!=t.item.id&&p(t.item.title)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("item"),this.bindAsObject(o.itemRef(e.params.id),"item"),this.initThreadStore())},initThreadStore:function(){this.threadStore&&this.threadStore.dispose(),this.threadStore=new r(this.props.params.id,this.handleCommentsChanged),this.setState(this.threadStore.initialState)},handleBeforeUnload:function(){this.threadStore.dispose()},handleCommentsChanged:function(e){"collapse"!=e.type?this.setState(e.data):this.forceUpdate()},autoCollapse:function(e){e.preventDefault(),this.threadStore.collapseThreadsWithoutNewComments()},markAsRead:function(e){e.preventDefault(),this.setState(this.threadStore.markAsRead())},render:function(){var e=this.state,t=e.item,i=this.threadStore;return t.id?s.DOM.div({className:u("Item",{"Item--dead":t.dead})},s.DOM.div({className:"Item__content"},this.renderItemTitle(t),this.renderItemMeta(t,null!==e.lastVisit&&e.newCommentCount>0&&s.DOM.span(null," ","(",s.DOM.em(null,e.newCommentCount," new")," in the last ",n(e.lastVisit),") | ",s.DOM.span({className:"control",tabIndex:"0",onClick:this.autoCollapse,onKeyPress:this.autoCollapse,title:"Collapse threads without new comments"},"auto collapse")," | ",s.DOM.span({className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),t.text&&s.DOM.div({className:"Item__text"},s.DOM.div({dangerouslySetInnerHTML:{__html:t.text}})),"poll"==t.type&&s.DOM.div({className:"Item__poll"},t.parts.map(function(e){return l({key:e,id:e})}))),t.kids&&s.DOM.div({className:"Item__kids"},t.kids.map(function(e,t){return m({key:e,id:e,level:0,loadingSpinner:0===t,threadStore:i})}))):s.DOM.div({className:"Item Item--loading"},c({size:"20"}))}});t.exports=h},{"./Comment":2,"./PollOption":8,"./Spinner":9,"./mixins/ItemMixin":15,"./services/HNService":18,"./stores/ItemStore":20,"./stores/StoryCommentThreadStore":21,"./utils/buildClassName":24,"./utils/setTitle":30,react:"react",reactfire:"reactfire"}],6:[function(e,t){"use strict";var n=e("react"),s=e("react-router"),i=s.Link,o=n.createClass({displayName:"Paginator",render:function(){return 1!=this.props.page||this.props.hasNext?n.DOM.div({className:"Paginator"},this.props.page>1&&n.DOM.span({className:"Paginator__prev"},i({to:this.props.route,query:{page:this.props.page-1}},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&n.DOM.span({className:"Paginator__next"},i({to:this.props.route,query:{page:this.props.page+1}},"More"))):null}});t.exports=o},{react:"react","react-router":"react-router"}],7:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("react-router"),o=e("./stores/CommentThreadStore"),r=e("./services/HNService"),a=e("./stores/UpdatesStore"),m=e("./Comment"),l=e("./mixins/CommentMixin"),c=e("./utils/buildClassName"),d=e("./utils/setTitle"),u=i.Navigation,p=n.createClass({displayName:"PermalinkedComment",mixins:[l,s,u],getDefaultProps:function(){return{level:0}},getInitialState:function(){return{comment:a.getComment(this.props.params.id)||{},parent:{type:"comment"},op:{}}},componentWillMount:function(){this.bindAsObject(r.itemRef(this.props.params.id),"comment"),this.threadStore=new o(this.props.params.id,this.handleCommentsChanged),this.state.comment.id&&this.fetchAncestors(this.state.comment)},componentWillUpdate:function(e,t){return this.state.comment.id==t.comment.id||t.comment.deleted||"comment"==t.comment.type?void 0:void this.replaceWith(t.comment.type,{id:t.comment.id})},componentDidUpdate:function(e,t){this.state.comment.id==t.comment.id||this.state.comment.deleted||this.fetchAncestors(this.state.comment),this.setTitle()},componentWillReceiveProps:function(e){if(this.props.params.id!=e.params.id){this.unbind("comment"),this.bindAsObject(r.itemRef(e.params.id),"comment"),this.threadStore=new o(e.params.id,this.handleCommentsChanged);var t=a.getComment(e.params.id);t&&this.setState({comment:t})}},setTitle:function(){if(this.state.comment.deleted)return d("Deleted comment");var e="Comment by "+this.state.comment.by;this.state.op.id&&(e+=" | "+this.state.op.title),d(e)},handleCommentsChanged:function(e){"collapse"==e.type&&this.forceUpdate()},render:function(){var e=this.state.comment;if(!e.id)return this.renderCommentLoading(e);if(e.deleted)return this.renderCommentDeleted(e,{className:"Comment Comment--level0 Comment--deleted"});if("comment"!=e.type)return null;var t=c("Comment Comment--level0",{"Comment--dead":e.dead}),s=this.threadStore;return n.DOM.div({className:t},n.DOM.div({className:"Comment__content"},this.renderCommentMeta(e,{parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!=this.state.op.id,op:!!this.state.op.id}),this.renderCommentText(e)),e.kids&&n.DOM.div({className:"Comment__kids"},e.kids.map(function(e,t){return m({key:e,id:e,level:1,loadingSpinner:0===t,threadStore:s})})))}});t.exports=p},{"./Comment":2,"./mixins/CommentMixin":14,"./services/HNService":18,"./stores/CommentThreadStore":19,"./stores/UpdatesStore":23,"./utils/buildClassName":24,"./utils/setTitle":30,react:"react","react-router":"react-router",reactfire:"reactfire"}],8:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./services/HNService"),o=e("./Spinner"),r=e("./utils/pluralise"),a=n.createClass({displayName:"PollOption",mixins:[s],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(i.itemRef(this.props.id),"pollopt")},render:function(){var e=this.state.pollopt;return e.id?n.DOM.div({className:"PollOption"},n.DOM.div({className:"PollOption__text"},e.text),n.DOM.div({className:"PollOption__score"},e.score," point",r(e.score))):n.DOM.div({className:"PollOption PollOption--loading"},o({size:"20"}))}});t.exports=a},{"./Spinner":9,"./services/HNService":18,"./utils/pluralise":29,react:"react",reactfire:"reactfire"}],9:[function(e,t){"use strict";var n=e("react"),s=n.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var e=this.props.size+"px",t={height:e,width:e,marginRight:this.props.spacing+"px"};return n.DOM.div({className:"Spinner",style:{width:3*(this.props.size+this.props.spacing)+"px"}},n.DOM.div({className:"bounce1",style:t}),n.DOM.div({className:"bounce2",style:t}),n.DOM.div({className:"bounce3",style:t}))}});t.exports=s},{react:"react"}],10:[function(e,t){"use strict";var n=e("react"),s=e("./stores/TopStore"),i=e("./mixins/PageNumberMixin"),o=e("./Paginator"),r=e("./Spinner"),a=e("./TopStoryListItem"),m=e("./utils/constants"),l=e("./utils/pageCalc"),c=e("./utils/setTitle"),d=m.ITEMS_PER_PAGE,u=m.TOP_STORIES,p=n.createClass({displayName:"TopStories",mixins:[i],getInitialState:function(){return s.getTopStories()},componentWillMount:function(){s.on("update",this.handleUpdate),s.start(),c()},componentWillUnmount:function(){s.off("update",this.handleUpdate)},handleUpdate:function(e){this.isMounted()&&this.setState(e)},render:function(){var e=l(this.getPageNumber(),d,u);if(0===this.state.topStories.length&&0===this.state.topStoryIds.length){for(var t=[],s=e.startIndex;s<e.endIndex;s++)t.push(n.DOM.li({className:"ListItem ListItem--loading"},r(null)));return n.DOM.div({className:"Items Items--loading"},n.DOM.ol({className:"Items__list",start:e.startIndex+1},t),o({route:"news",page:e.pageNum,hasNext:e.hasNext}))}return n.DOM.div({className:"Items"},n.DOM.ol({className:"Items__list",start:e.startIndex+1},this.renderItems(e.startIndex,e.endIndex)),o({route:"news",page:e.pageNum,hasNext:e.hasNext}))},renderItems:function(e,t){for(var n=[],s=e;t>s;s++){var i=this.state.topStories[s],o=this.state.topStoryIds[s];n.push(o?a({key:o,id:o,topIndex:s,cachedItem:i}):a({cachedItem:i}))}return n}});t.exports=p},{"./Paginator":6,"./Spinner":9,"./TopStoryListItem":11,"./mixins/PageNumberMixin":17,"./stores/TopStore":22,"./utils/constants":26,"./utils/pageCalc":28,"./utils/setTitle":30,react:"react"}],11:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),i=e("./stores/StoryCommentThreadStore"),o=e("./services/HNService"),r=e("./stores/TopStore"),a=e("./mixins/ItemMixin"),m=e("./mixins/ListItemMixin"),l=e("./Spinner"),c=n.createClass({displayName:"TopStoryListItem",mixins:[a,m,s],propTypes:{id:n.PropTypes.number,cachedItem:n.PropTypes.object,topIndex:n.PropTypes.number},getDefaultProps:function(){return{id:null,cachedItem:null,topIndex:null}},getInitialState:function(){return{item:this.props.cachedItem||{},lastVisit:null,commentCount:null,maxCommentId:null}},componentWillMount:function(){null!==this.props.id?this.initLiveItem():this.state.item.id&&this.setState(i.loadState(this.state.item.id))},componentWillReceiveProps:function(e){null===this.props.id&&null!==e.id&&this.initLiveItem()},componentWillUpdate:function(e,t){this.state.item!==t.item&&r.setItem(this.props.topIndex,t.item)},initLiveItem:function(){this.bindAsObject(o.itemRef(this.props.id),"item"),this.setState(i.loadState(this.props.id))},render:function(){var e=this.state.item;return e.id?this.renderListItem(e):n.DOM.li({className:"ListItem ListItem--loading"},l(null))}});t.exports=c},{"./Spinner":9,"./mixins/ItemMixin":15,"./mixins/ListItemMixin":16,"./services/HNService":18,"./stores/StoryCommentThreadStore":21,"./stores/TopStore":22,react:"react",reactfire:"reactfire"}],12:[function(e,t){"use strict";var n=e("react"),s=e("./stores/UpdatesStore"),i=e("./DisplayListItem"),o=e("./DisplayComment"),r=e("./Paginator"),a=e("./Spinner"),m=e("./mixins/PageNumberMixin"),l=e("./utils/constants"),c=e("./utils/pageCalc"),d=e("./utils/setTitle"),u=l.ITEMS_PER_PAGE,p=n.createClass({displayName:"Updates",mixins:[m],getInitialState:function(){return s.getUpdates()},componentWillMount:function(){this.setTitle(this.props.type),s.start(),s.on("updates",this.handleUpdates)},componentWillUnmount:function(){s.off("updates",this.handleUpdates),s.stop()},componentWillReceiveProps:function(e){this.props.type!=e.type&&this.setTitle(e.type)},setTitle:function(e){d("New "+("comments"==e?"Comments":"Links"))},handleUpdates:function(e){this.isMounted()&&this.setState(e)},render:function(){var e="comments"==this.props.type?this.state.comments:this.state.stories;if(0===e.length)return n.DOM.div({className:"Updates Updates--loading"},a({size:"20"}));var t=c(this.getPageNumber(),u,e.length),s=1==t.pageNum&&n.DOM.p({className:"Updates__notice"},"This view will currently only update while you have it open - this will be configurable sometime…");return"comments"==this.props.type?n.DOM.div({className:"Updates Comments"},s,e.slice(t.startIndex,t.endIndex).map(function(e){return o({key:e.id,id:e.id,comment:e})}),r({route:"newcomments",page:t.pageNum,hasNext:t.hasNext})):n.DOM.div({className:"Updates Items"},s,n.DOM.ol({className:"Items__list",start:t.startIndex+1},e.slice(t.startIndex,t.endIndex).map(function(e){return i({key:e.id,item:e})})),r({route:"newest",page:t.pageNum,hasNext:t.hasNext}))}});t.exports=p},{"./DisplayComment":3,"./DisplayListItem":4,"./Paginator":6,"./Spinner":9,"./mixins/PageNumberMixin":17,"./stores/UpdatesStore":23,"./utils/constants":26,"./utils/pageCalc":28,"./utils/setTitle":30,react:"react"}],13:[function(e,t){"use strict";var n=e("moment"),s=e("react"),i=e("reactfire"),o=e("./services/HNService"),r=e("./Spinner"),a=e("./utils/setTitle"),m=s.createClass({displayName:"UserProfile",mixins:[i],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(o.userRef(this.props.params.id),"user")},componentWillUpdate:function(e,t){this.state.user.id!=t.user.id&&a("Profile: "+t.user.id)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("user"),this.bindAsObject(o.userRef(e.params.id),"user"))},render:function(){var e=this.state.user;if(!e.id)return s.DOM.div({className:"UserProfile UserProfile--loading"},s.DOM.h4(null,this.props.params.id),r({size:"20"}));var t=n(1e3*e.created);return s.DOM.div({className:"UserProfile"},s.DOM.h4(null,e.id),s.DOM.dl(null,s.DOM.dt(null,"Created"),s.DOM.dd(null,t.fromNow()," (",t.format("LL"),")"),s.DOM.dt(null,"Karma"),s.DOM.dd(null,e.karma),s.DOM.dt(null,"Delay"),s.DOM.dd(null,e.delay),e.about&&s.DOM.dt(null,"About"),e.about&&s.DOM.dd(null,s.DOM.div({className:"UserProfile__about",dangerouslySetInnerHTML:{__html:e.about}}))))}});t.exports=m},{"./Spinner":9,"./services/HNService":18,"./utils/setTitle":30,moment:"moment",react:"react",reactfire:"reactfire"}],14:[function(e,t){"use strict";var n=e("moment"),s=e("react"),i=e("react-router"),o=e("../stores/ItemStore"),r=e("../Spinner"),a=e("../utils/pluralise"),m=i.Link,l={fetchAncestors:function(e){o.fetchCommentAncestors(e,function(e){this.isMounted()&&this.setState({parent:e.parent,op:e.op})}.bind(this))},renderCommentLoading:function(e){return s.DOM.div({className:"Comment Comment--loading Comment--level"+this.props.level},this.props.loadingSpinner&&r({size:"20"}),e.error&&s.DOM.p(null,"Error loading comment - this may be because the author has configured a delay."))},renderCommentDeleted:function(e,t){return s.DOM.div({className:t.className},s.DOM.div({className:"Comment__content"},s.DOM.div({className:"Comment__meta"},"[deleted] | ",s.DOM.a({href:"https://news.ycombinator.com/item?id="+e.id},"view on Hacker News"))))},renderCollapseControl:function(e){return s.DOM.span({className:"Comment__collapse",onClick:this.toggleCollapse,onKeyPress:this.toggleCollapse,tabIndex:"0"},"[",e?"+":"–","]")},renderCommentMeta:function(e,t){return s.DOM.div({className:"Comment__meta"},t.collapsible&&this.renderCollapseControl(t.collapsed),t.collapsible&&" ",m({to:"user",params:{id:e.by},className:"Comment__user"},e.by)," ",n(1e3*e.time).fromNow(),t.link&&" | ",t.link&&m({to:"comment",params:{id:e.id}},"link"),t.parent&&" | ",t.parent&&m({to:this.state.parent.type,params:{id:e.parent}},"parent"),t.op&&" | on: ",t.op&&m({to:this.state.op.type,params:{id:this.state.op.id}},this.state.op.title),e.dead&&" | [dead]",t.childCounts&&" | ("+t.childCounts.children+" child"+a(t.childCounts.children,",ren"),t.childCounts&&t.childCounts.newComments>0&&", ",t.childCounts&&t.childCounts.newComments>0&&s.DOM.em(null,t.childCounts.newComments," new"),t.childCounts&&")")},renderCommentText:function(e){return s.DOM.div({className:"Comment__text"},s.DOM.div({dangerouslySetInnerHTML:{__html:e.text}}))}};t.exports=l},{"../Spinner":9,"../stores/ItemStore":20,"../utils/pluralise":29,moment:"moment",react:"react","react-router":"react-router"}],15:[function(e,t){"use strict";var n=e("react"),s=e("moment"),i=e("react-router"),o=e("../utils/pluralise"),r=i.Link,a=function(){var e=document.createElement("a");return function(t){e.href=t;var n=e.hostname.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}}(),m={renderItemMeta:function(e,t){var i=s(1e3*e.time),a=e.kids&&e.kids.length>0?"comments":"discuss";return this.state.commentCount>0&&(a=this.state.commentCount+" comment"+o(this.state.commentCount)),-1!=this.constructor.displayName.indexOf("ListItem")&&(a=r({to:e.type,params:{id:e.id}},a)),"job"==e.type?n.DOM.div({className:"Item__meta"},n.DOM.span({className:"Item__time"},i.fromNow())):n.DOM.div({className:"Item__meta"},n.DOM.span({className:"Item__score"},e.score," point",o(e.score))," ",n.DOM.span({className:"Item__by"},"by ",r({to:"user",params:{id:e.by}},e.by))," ",n.DOM.span({className:"Item__time"},i.fromNow())," | ",a,t)},renderItemTitle:function(e){var t,s=!!e.url;return t=e.dead?"[dead] "+e.title:s?n.DOM.a({href:e.url},e.title):r({to:e.type,params:{id:e.id}},e.title),n.DOM.div({className:"Item__title"},t,s&&" ",s&&n.DOM.span({className:"Item__host"},"(",a(e.url),")"))}};t.exports=m},{"../utils/pluralise":29,moment:"moment",react:"react","react-router":"react-router"}],16:[function(e,t){"use strict";function n(e,t){return e?e.filter(t):[]}var s=e("react"),i=e("react-router"),o=e("../utils/buildClassName"),r=e("../utils/pluralise"),a=i.Link,m={getNewThreadCount:function(e){return null===this.state.lastVisit?0:n(e.kids,function(e){return e>this.state.maxCommentId}.bind(this)).length},renderListItem:function(e){if(e.deleted)return null;var t=this.state,n=this.getNewThreadCount(e),i=n>0;return s.DOM.li({className:o("ListItem",{"ListItem--dead":e.dead})},this.renderItemTitle(e),this.renderItemMeta(e,null!==t.lastVisit&&s.DOM.span(null," ","(",t.lastVisit.fromNow(),")",i&&" | ",i&&a({to:"item",params:{id:e.id}},s.DOM.em(null,n," new thread",r(n))))))}};t.exports=m},{"../utils/buildClassName":24,"../utils/pluralise":29,react:"react","react-router":"react-router"}],17:[function(e,t){"use strict";var n={getPageNumber:function(e){return"undefined"==typeof e&&(e=this.props.query.page),e&&/^\d+$/.test(e)?Math.max(1,Number(e)):1}};t.exports=n},{}],18:[function(e,t){"use strict";function n(e,t){o(e).once("value",function(e){t(e.val())})}function s(e,t){function s(n){i.push(n),i.length>=e.length&&t(i)}var i=[];e.forEach(function(e){n(e,s)})}function i(){return l.child("topstories")}function o(e){return l.child("item/"+e)}function r(e){return l.child("user/"+e)}function a(){return l.child("updates/items")}var m=e("firebase"),l=new m("https://hacker-news.firebaseio.com/v0");t.exports={fetchItem:n,fetchItems:s,topStoriesRef:i,itemRef:o,userRef:r,updatesRef:a}},{firebase:"firebase"}],19:[function(e,t){"use strict";function n(e,t){this.itemId=e,this.onCommentsChanged=t,this.children={},this.children[e]=[],this.isNew={},this.isCollapsed={}}var s=e("../utils/extend");s(n.prototype,{getChildCounts:function(e){for(var t=0,n=0,s=[e.id];s.length;){for(var i=[],o=0,r=s.length;r>o;o++){var a=this.children[s[o]];a.length&&i.push.apply(i,a)}for(o=0,r=i.length;r>o;o++)this.isNew[i[o]]&&n++;t+=i.length,s=i}return{children:t,newComments:n}},commentAdded:function(e){this.children[e.id]=[],this.children[e.parent].push(e.id)},commentDeleted:function(e){var t=this.children[e.parent];t.splice(t.indexOf(e.id),1)},toggleCollapse:function(e){this.isCollapsed[e]=!this.isCollapsed[e],this.onCommentsChanged({type:"collapse"})}}),t.exports=n},{"../utils/extend":27}],20:[function(e,t){"use strict";function n(e,t,n){for(var i=e.id,o=e.parent;a[o]||m[o];){if(n.itemCount++,n.cacheHits++,m[o])return 1==n.itemCount&&(n.parent=m[o]),n.op=m[o],void t(n);a[o]&&(1==n.itemCount&&(n.parent={id:o,type:"comment"}),i=o,o=a[o])}l.getItem(o,function(e){n.itemCount++,a[i]=o,"comment"==e.type&&(a[e.id]=e.parent),s(e,t,n)},n)}function s(e,t,s){1==s.itemCount&&(s.parent=e),"comment"!=e.type?(s.op=e,m[e.id]={id:e.id,type:e.type,title:e.title},t(s)):n(e,t,s)}var i=e("../services/HNService"),o=e("./TopStore"),r=e("./UpdatesStore"),a={},m={},l={getItem:function(e,t,n){var s=this.getCachedItem(e);s?(n&&n.cacheHits++,setImmediate(t,s)):i.fetchItem(e,t)},getCachedItem:function(e){return o.getItem(e)||r.getItem(e)||null},getCachedStory:function(e){return o.getItem(e)||r.getStory(e)||null},fetchCommentAncestors:function(e,t){var s=Date.now(),i={itemCount:0,cacheHits:0};n(e,function(){i.timeTaken=Date.now()-s,setImmediate(t,i)},i)}};t.exports=l},{"../services/HNService":18,"./TopStore":22,"./UpdatesStore":23}],21:[function(e,t){"use strict";function n(e){var t=m.get(e+c,null);return{lastVisit:null!==t?i(Number(t)):null,commentCount:Number(m.get(e+l,"0")),maxCommentId:Number(m.get(e+d,"0"))}}function s(e,t){o.call(this,e,t),this.parents={},this.commentCount=0,this.newCommentCount=0,this.maxCommentId=0,this.initialState=n(e),this.prevMaxCommentId=this.initialState.maxCommentId,this.isFirstVisit=null===this.initialState.lastVisit,this.isFirstVisit&&this.firstLoadComplete()}var i=e("moment"),o=e("./CommentThreadStore"),r=e("../utils/cancellableDebounce"),a=e("../utils/extend"),m=e("../utils/storage"),l=":cc",c=":lv",d=":mc";s.loadState=n,s.prototype=a(Object.create(o.prototype),{constructor:s,numberOfCommentsChanged:r(function(){this.onCommentsChanged({type:"number",data:{commentCount:this.commentCount,newCommentCount:this.newCommentCount}})},100),firstLoadComplete:r(function(){this.prevMaxCommentId=this.maxCommentId,this.isFirstVisit=!1,this.onCommentsChanged({type:"load_complete",data:{lastVisit:i(Date.now()),maxCommentId:this.prevMaxCommentId}})},5e3),_storeState:function(){m.set(this.itemId+l,this.commentCount),m.set(this.itemId+c,Date.now()),m.set(this.itemId+d,this.maxCommentId)},commentAdded:function(e){o.prototype.commentAdded.call(this,e),this.commentCount++,this.prevMaxCommentId>0&&e.id>this.prevMaxCommentId&&(this.newCommentCount++,this.isNew[e.id]=!0),e.id>this.maxCommentId&&(this.maxCommentId=e.id),e.parent!=this.itemId&&(this.parents[e.id]=e.parent),this.numberOfCommentsChanged(),this.isFirstVisit&&this.firstLoadComplete()},commentDeleted:function(e){o.prototype.commentDeleted.call(this,e),this.commentCount--,this.isNew[e.id]&&(this.newCommentCount--,delete this.isNew[e.id]),delete this.parents[e.id],this.numberOfCommentsChanged()},collapseThreadsWithoutNewComments:function(){for(var e=Object.keys(this.isNew),t={},n=0,s=e.length;s>n;n++)for(var i=this.parents[e[n]];i&&!t[i];)t[i]=!0,i=this.parents[i];for(var o={},r=this.children[this.itemId];r.length;){var a=[];for(n=0,s=r.length;s>n;n++){var m=r[n];if(t[m]){var l=this.children[m];l.length&&a.push.apply(a,l)}else this.isNew[m]||(o[m]=!0)}r=a}this.isCollapsed=o,this.onCommentsChanged({type:"collapse"})},markAsRead:function(){return this.newCommentCount=0,this.prevMaxCommentId=this.maxCommentId,this.isNew={},this._storeState(),{lastVisit:i(Date.now()),maxCommentId:this.maxCommentId,newCommentCount:this.newCommentCount}},dispose:function(){this.numberOfCommentsChanged.cancel(),this.firstLoadComplete.cancel(),this._storeState()}}),t.exports=s},{"../utils/cancellableDebounce":25,"../utils/extend":27,"../utils/storage":31,"./CommentThreadStore":19,moment:"moment"}],22:[function(e,t){"use strict";function n(){for(var e=0,t=m.length;t>e;e++)c[e]=l[m[e]]||null}function s(e){m=e.val(),n(),d.emit("update",d.getTopStories())}var i=e("events").EventEmitter,o=e("../services/HNService"),r=e("../utils/extend"),a=null,m=null,l=null,c=[],d=r(new i,{loadSession:function(){var e=sessionStorage.topStories;l=e?JSON.parse(e):{},e=sessionStorage.topStoryIds,m=e?JSON.parse(e):[],n()},saveSession:function(){sessionStorage.topStories=JSON.stringify(l),sessionStorage.topStoryIds=JSON.stringify(m)},start:function(){null===a&&(a=o.topStoriesRef(),a.on("value",s))},stop:function(){null!==a&&(a.off(),a=null)},getItem:function(e){return l[e]||null},getTopStories:function(){return{topStories:c,topStoryIds:m}},setItem:function(e,t){c[e]=t,l[t.id]=t}});d.off=d.removeListener,t.exports=d},{"../services/HNService":18,"../utils/extend":27,events:"events"}],23:[function(e,t){"use strict";function n(e,t){return t.time-e.time}function s(e){var t=Object.keys(e).map(function(t){return e[t]});return t.sort(n),t}function i(){h.comments=o(p.comments),h.stories=o(p.stories)}function o(e){var t=s(e);return t.splice(d,Math.max(0,t.length-d)).forEach(function(t){delete e[t.id]}),t}function r(e){for(var t=0,n=e.length;n>t;t++){var s=e[t];s.deleted||"undefined"==typeof s.error&&"undefined"!=typeof f[s.type]&&("comment"==s.type?p.comments[s.id]=s:p.stories[s.id]=s)}i(),C.emit("updates",h)}var a=e("events").EventEmitter,m=e("../services/HNService"),l=e("../utils/constants"),c=e("../utils/extend"),d=l.UPDATES_CACHE_SIZE,u=null,p=null,h={},f={comment:!0,job:!0,poll:!0,story:!0},C=c(new a,{loadSession:function(){var e=sessionStorage.updates;p=e?JSON.parse(e):{comments:{},stories:{}},i()},saveSession:function(){sessionStorage.updates=JSON.stringify(p)},start:function(){null===u&&(u=m.updatesRef(),u.on("value",function(e){m.fetchItems(e.val(),r)}))},stop:function(){u.off(),u=null},getUpdates:function(){return h},getItem:function(e){return p.comments[e]||p.stories[e]||null},getComment:function(e){return p.comments[e]||null},getStory:function(e){return p.stories[e]||null}});C.off=C.removeListener,t.exports=C},{"../services/HNService":18,"../utils/constants":26,"../utils/extend":27,events:"events"}],24:[function(e,t){"use strict";function n(e,t){var n=[];"undefined"==typeof t?t=e:n.push(e);for(var s=Object.keys(t),i=0,o=s.length;o>i;i++)t[s[i]]&&n.push(s[i]);return n.join(" ")}t.exports=n},{}],25:[function(e,t){"use strict";function n(e,t,n){var s,i,o,r,a,m=function(){var l=Date.now()-r;t>l&&l>0?s=setTimeout(m,t-l):(s=null,n||(a=e.apply(o,i),s||(o=i=null)))},l=function(){o=this,i=arguments,r=Date.now();var l=n&&!s;return s||(s=setTimeout(m,t)),l&&(a=e.apply(o,i),o=i=null),a};return l.cancel=function(){s&&clearTimeout(s)},l}t.exports=n},{}],26:[function(e,t){"use strict";t.exports={ITEMS_PER_PAGE:30,SITE_TITLE:"React HN",TOP_STORIES:100,UPDATES_CACHE_SIZE:200}},{}],27:[function(e,t){"use strict";function n(e,t,n){for(var s=Object.keys(t),i=0,o=s.length;o>i;i++)e[s[i]]=t[s[i]];if(n)for(s=Object.keys(n),i=0,o=s.length;o>i;i++)e[s[i]]=n[s[i]];return e}t.exports=n},{}],28:[function(e,t){"use strict";function n(e,t,n){var s=(e-1)*t,i=Math.min(n,s+t),o=n-1>i;return{pageNum:e,startIndex:s,endIndex:i,hasNext:o}}t.exports=n},{}],29:[function(e,t){"use strict";function n(e,t){return(t||",s").split(",")[1==e?0:1]}t.exports=n},{}],30:[function(e,t){"use strict";function n(e){document.title=e?e+" | "+s:s}var s=e("./constants").SITE_TITLE;t.exports=n},{"./constants":26}],31:[function(e,t){"use strict";
t.exports={get:function(e,t){var n=localStorage[e];return"undefined"!=typeof n?n:t},set:function(e,t){localStorage[e]=t}}},{}],32:[function(){!function(e,t){"use strict";function n(e){return h[p]=s.apply(t,e),p++}function s(e){var n=[].slice.call(arguments,1);return function(){"function"==typeof e?e.apply(t,n):new Function(""+e)()}}function i(e){if(f)setTimeout(s(i,e),0);else{var t=h[e];if(t){f=!0;try{t()}finally{o(e),f=!1}}}}function o(e){delete h[e]}function r(){u=function(){var e=n(arguments);return process.nextTick(s(i,e)),e}}function a(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function m(){var t="setImmediate$"+Math.random()+"$",s=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&i(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),u=function(){var s=n(arguments);return e.postMessage(t+s,"*"),s}}function l(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;i(t)},u=function(){var t=n(arguments);return e.port2.postMessage(t),t}}function c(){var e=C.documentElement;u=function(){var t=n(arguments),s=C.createElement("script");return s.onreadystatechange=function(){i(t),s.onreadystatechange=null,e.removeChild(s),s=null},e.appendChild(s),t}}function d(){u=function(){var e=n(arguments);return setTimeout(s(i,e),0),e}}if(!e.setImmediate){var u,p=1,h={},f=!1,C=e.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(e);v=v&&v.setTimeout?v:e,"[object process]"==={}.toString.call(e.process)?r():a()?m():e.MessageChannel?l():C&&"onreadystatechange"in C.createElement("script")?c():d(),v.setImmediate=u,v.clearImmediate=o}}(new Function("return this")())},{}]},{},[1]);