!function e(t,n,s){function r(a,o){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!o&&l)return l(a,!0);if(i)return i(a,!0);var m=new Error("Cannot find module '"+a+"'");throw m.code="MODULE_NOT_FOUND",m}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n?n:e)},u,u.exports,e,t,n,s)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<s.length;a++)r(s[a]);return r}({1:[function(e){"use strict";var t=e("react"),n=e("react-router"),s=e("./Comment"),r=e("./Item"),i=e("./Items"),a=e("./UserProfile"),o=n.DefaultRoute,l=n.Link,m=n.NotFoundRoute,u=n.Route,c=n.Routes,d=t.createClass({displayName:"App",render:function(){return t.DOM.div({className:"App"},t.DOM.div({className:"App__header"},t.DOM.img({src:"logo.png",width:"16",height:"16",alt:""})," ",l({to:"news",className:"App__homelink"},"React Hacker News")),t.DOM.div({className:"App__content"},this.props.activeRouteHandler(null)),t.DOM.div({className:"App__footer"},t.DOM.a({href:"https://github.com/insin/react-hn"},"Source on GitHub")))}}),p=t.createClass({displayName:"NotFound",render:function(){return t.DOM.h2(null,"Not found")}}),h=c({location:"hash"},u({name:"app",path:"/",handler:d},o({handler:i}),m({handler:p}),u({name:"news",path:"news",handler:i}),u({name:"item",path:"item/:id",handler:r}),u({name:"job",path:"job/:id",handler:r}),u({name:"poll",path:"poll/:id",handler:r}),u({name:"story",path:"story/:id",handler:r}),u({name:"comment",path:"comment/:id",handler:s,permalinked:!0}),u({name:"user",path:"user/:id",handler:a})));window.React=t,t.renderComponent(h,document.getElementById("app"))},{"./Comment":2,"./Item":3,"./Items":4,"./UserProfile":9,react:"react","react-router":"react-router"}],2:[function(e,t){"use strict";var n=e("moment"),s=e("react"),r=e("reactfire"),i=e("react-router"),a=e("./stores/CommentThreadStore"),o=e("./stores/ItemStore"),l=e("./Spinner"),m=e("./utils/buildClassName"),u=e("./utils/setTitle"),c=i.Link,d=i.Navigation,p=s.createClass({displayName:"Comment",mixins:[r,d],getDefaultProps:function(){return{showSpinner:!1,permalink:!1,permalinkThread:!1,level:0,maxCommentId:0}},getInitialState:function(){return{comment:{},parent:{type:"comment"},collapsed:!1}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.id||this.props.params.id),"comment"),this.isInPermalinkThread()||a.addComment(this.props.id)},componentWillUpdate:function(e,t){if(this.props.permalinked&&this.state.comment.id!=t.comment.id){if("comment"!=t.comment.type)return void this.replaceWith(t.comment.type,{id:t.comment.id});u("Comment by "+t.comment.by)}},componentDidUpdate:function(e,t){this.props.permalinked&&this.state.comment.parent!=t.comment.parent&&o.fetchItem(this.state.comment.parent,function(e){this.setState({parent:e})}.bind(this))},componentWillReceiveProps:function(e){this.props.permalinked&&this.props.params.id!=e.params.id&&(this.unbind("comment"),this.bindAsObject(o.itemRef(e.params.id),"comment"))},isInPermalinkThread:function(){return this.props.permalinked||this.props.permalinkThread},isNew:function(){return this.props.maxCommentId>0&&this.props.id>this.props.maxCommentId},toggleCollapsed:function(){this.setState({collapsed:!this.state.collapsed})},render:function(){var e=this.props,t=this.state.comment;return t.id?"comment"!=t.type?null:t.deleted&&!t.kids?null:s.DOM.div({className:m("Comment Comment--level"+e.level,{"Comment--collapsed":this.state.collapsed,"Comment--dead":t.dead,"Comment--deleted":t.deleted,"Comment--new":this.isNew()})},s.DOM.div({className:"Comment__content"},t.deleted&&s.DOM.div({className:"Comment__meta"},this.renderCollapseControl()," ","[deleted]"),!t.deleted&&s.DOM.div({className:"Comment__meta"},s.DOM.span({className:"Comment__collapse",onClick:this.toggleCollapsed,onKeyPress:this.toggleCollapsed,tabIndex:"0"},"[",this.state.collapsed?"+":"â€“","]")," ",c({to:"user",params:{id:t.by},className:"Comment__user"},t.by)," ",n(1e3*t.time).fromNow()," | ",!e.permalinked&&c({to:"comment",params:{id:t.id}},"link"),e.permalinked&&c({to:this.state.parent.type,params:{id:t.parent}},"parent"),t.dead&&" | [dead]"),!t.deleted&&s.DOM.div({className:"Comment__text"},s.DOM.div({dangerouslySetInnerHTML:{__html:t.text}}))),t.kids&&s.DOM.div({className:"Comment__kids"},t.kids.map(function(t,n){return p({key:t,id:t,level:e.level+1,showSpinner:e.showSpinner||e.permalinked&&0===n,permalinkThread:e.permalinkThread||e.permalinked,maxCommentId:e.maxCommentId})}))):s.DOM.div({className:m("Comment Comment--loading Comment--level"+e.level,{"Comment--new":this.isNew()})},(e.permalinked||e.showSpinner)&&l({size:"20"}),t.error&&s.DOM.p(null,"Error loading comment - this may be because the author has configured a delay."))}});t.exports=p},{"./Spinner":8,"./stores/CommentThreadStore":12,"./stores/ItemStore":13,"./utils/buildClassName":14,"./utils/setTitle":17,moment:"moment",react:"react","react-router":"react-router",reactfire:"reactfire"}],3:[function(e,t){"use strict";function n(e){return e.fromNow(!0).replace(/^an? /,"")}var s=e("react"),r=e("reactfire"),i=e("./Comment"),a=e("./stores/CommentThreadStore"),o=e("./stores/ItemStore"),l=e("./PollOption"),m=e("./Spinner"),u=e("./utils/buildClassName"),c=e("./renderItemTitle"),d=e("./renderItemMeta"),p=e("./utils/setTitle"),h=s.createClass({displayName:"Item",mixins:[r],getInitialState:function(){var e=a.getCommentStats(this.props.params.id);return{item:{},lastVisit:e.lastVisit,commentCount:e.commentCount,prevMaxCommentId:e.prevMaxCommentId,newCommentCount:0}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.params.id),"item"),this.setState(a.init(this.props.params.id,this.handleCommentsAdded)),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){a.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillUpdate:function(e,t){this.state.item.id!=t.item.id&&p(t.item.title)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("item"),this.bindAsObject(o.itemRef(e.params.id),"item"),a.dispose(),this.setState(a.init(e.params.id,this.handleCommentsAdded)))},handleBeforeUnload:function(){a.dispose()},isInitialLoad:function(){return null===this.state.lastVisit},handleCommentsAdded:function(e){var t={newCommentCount:e.newCommentCount};e.commentCount>this.state.commentCount&&(t.commentCount=e.commentCount),this.setState(t)},markAsRead:function(){this.setState(a.markAsRead())},render:function(){var e=this.state,t=e.item,r=e.newCommentCount;return t.id?s.DOM.div({className:u("Item",{"Item--dead":t.dead})},s.DOM.div({className:"Item__content"},c(t),d(t,e,"detail",r>0&&s.DOM.span(null," ","(",s.DOM.em(null,r," new")," in the last ",n(e.lastVisit),") | ",s.DOM.span({className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),t.text&&s.DOM.div({className:"Item__text"},s.DOM.div({dangerouslySetInnerHTML:{__html:t.text}})),"poll"==t.type&&s.DOM.div({className:"Item__poll"},t.parts.map(function(e){return l({key:e,id:e})}))),t.kids&&s.DOM.div({className:"Item__kids"},t.kids.map(function(t,n){return i({key:t,id:t,level:0,showSpinner:0===n,maxCommentId:e.prevMaxCommentId})}))):s.DOM.div({className:"Item Item--loading"},m({size:"20"}))}});t.exports=h},{"./Comment":2,"./PollOption":7,"./Spinner":8,"./renderItemMeta":10,"./renderItemTitle":11,"./stores/CommentThreadStore":12,"./stores/ItemStore":13,"./utils/buildClassName":14,"./utils/setTitle":17,react:"react",reactfire:"reactfire"}],4:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),r=e("./stores/ItemStore"),i=e("./ListItem"),a=e("./Paginator"),o=e("./Spinner"),l=e("./utils/setTitle"),m=30,u=n.createClass({displayName:"Items",mixins:[s],getInitialState:function(){return{items:[]}},componentWillMount:function(){this.bindAsObject(r.topStoriesRef(),"items"),l()},getPage:function(){return this.props.query.page&&/^\d+$/.test(this.props.query.page)?Math.max(1,Number(this.props.query.page)):1},render:function(){var e=this.getPage(),t=(e-1)*m,s=t+m,r=s<this.state.items.length-1;if(0===this.state.items.length){for(var l=[],u=0;m>u;u++)l.push(n.DOM.li({className:"ListItem ListItem--loading"},o(null)));return n.DOM.div({className:"Items Items--loading"},n.DOM.ol({className:"Items__list",start:t+1},l),a({route:"news",page:e,hasNext:r}))}var c=this.state.items.slice(t,s);return n.DOM.div({className:"Items"},n.DOM.ol({className:"Items__list",start:t+1},c.map(function(e){return i({key:e,id:e})})),a({route:"news",page:e,hasNext:r}))}});t.exports=u},{"./ListItem":5,"./Paginator":6,"./Spinner":8,"./stores/ItemStore":13,"./utils/setTitle":17,react:"react",reactfire:"reactfire"}],5:[function(e,t){"use strict";function n(e){return Math.max.apply(Math,e)}var s=e("react"),r=e("reactfire"),i=e("react-router"),a=e("./stores/CommentThreadStore"),o=e("./stores/ItemStore"),l=e("./Spinner"),m=e("./utils/buildClassName"),u=e("./renderItemTitle"),c=e("./renderItemMeta"),d=i.Link,p=s.createClass({displayName:"ListItem",mixins:[r],getInitialState:function(){return{item:{},lastVisit:null,commentCount:null,prevMaxCommentId:null}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.id),"item"),this.setState(a.getCommentStats(this.props.id))},render:function(){var e=this.state.item;if(!e.id)return s.DOM.li({className:"ListItem ListItem--loading"},l(null));if(e.deleted)return null;var t=null!==this.state.lastVisit&&n(e.kids)>this.state.prevMaxCommentId;return s.DOM.li({className:m("ListItem",{"ListItem--dead":e.dead})},u(e),c(e,this.state,"list",null!==this.state.lastVisit&&s.DOM.span(null," ","(",this.state.lastVisit.fromNow(),")",t&&" | ",t&&d({to:"item",params:{id:e.id}},s.DOM.em(null,"new threads")))))}});t.exports=p},{"./Spinner":8,"./renderItemMeta":10,"./renderItemTitle":11,"./stores/CommentThreadStore":12,"./stores/ItemStore":13,"./utils/buildClassName":14,react:"react","react-router":"react-router",reactfire:"reactfire"}],6:[function(e,t){"use strict";var n=e("react"),s=e("react-router"),r=s.Link,i=n.createClass({displayName:"Paginator",render:function(){return n.DOM.div({className:"Paginator"},this.props.page>1&&n.DOM.span({className:"Paginator__prev"},r({to:this.props.route,query:{page:this.props.page-1}},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&n.DOM.span({className:"Paginator__next"},r({to:this.props.route,query:{page:this.props.page+1}},"More")))}});t.exports=i},{react:"react","react-router":"react-router"}],7:[function(e,t){"use strict";var n=e("react"),s=e("reactfire"),r=e("./stores/ItemStore"),i=e("./Spinner"),a=e("./utils/pluralise"),o=n.createClass({displayName:"PollOption",mixins:[s],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(r.itemRef(this.props.id),"pollopt")},render:function(){var e=this.state.pollopt;return e.id?n.DOM.div({className:"PollOption"},n.DOM.div({className:"PollOption__text"},e.text),n.DOM.div({className:"PollOption__score"},e.score," point",a(e.score))):n.DOM.div({className:"PollOption PollOption--loading"},i({size:"20"}))}});t.expors=o},{"./Spinner":8,"./stores/ItemStore":13,"./utils/pluralise":16,react:"react",reactfire:"reactfire"}],8:[function(e,t){"use strict";var n=e("react"),s=n.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var e=this.props.size+"px",t={height:e,width:e,marginRight:this.props.spacing+"px"};return n.DOM.div({className:"Spinner",style:{width:3*(this.props.size+this.props.spacing)+"px"}},n.DOM.div({className:"bounce1",style:t}),n.DOM.div({className:"bounce2",style:t}),n.DOM.div({className:"bounce3",style:t}))}});t.exports=s},{react:"react"}],9:[function(e,t){"use strict";var n=e("moment"),s=e("react"),r=e("reactfire"),i=e("./stores/ItemStore"),a=e("./Spinner"),o=e("./utils/setTitle"),l=s.createClass({displayName:"UserProfile",mixins:[r],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(i.userRef(this.props.params.id),"user")},componentWillUpdate:function(e,t){this.state.user.id!=t.user.id&&o("Profile: "+t.user.id)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("user"),this.bindAsObject(i.userRef(e.params.id),"user"))},render:function(){var e=this.state.user;if(!e.id)return s.DOM.div({className:"UserProfile UserProfile--loading"},s.DOM.h4(null,this.props.params.id),a({size:"20"}));var t=n(1e3*e.created);return s.DOM.div({className:"UserProfile"},s.DOM.h4(null,e.id),s.DOM.dl(null,s.DOM.dt(null,"Created"),s.DOM.dd(null,t.fromNow()," (",t.format("LL"),")"),s.DOM.dt(null,"Karma"),s.DOM.dd(null,e.karma),s.DOM.dt(null,"Delay"),s.DOM.dd(null,e.delay),e.about&&s.DOM.dt(null,"About"),e.about&&s.DOM.dd(null,s.DOM.div({className:"UserProfile__about",dangerouslySetInnerHTML:{__html:e.about}}))))}});t.exports=l},{"./Spinner":8,"./stores/ItemStore":13,"./utils/setTitle":17,moment:"moment",react:"react",reactfire:"reactfire"}],10:[function(e,t){"use strict";function n(e,t,n,i){var l=r(1e3*e.time),m="job"!=e.type,u=e.kids&&e.kids.length>0?"comments":"discuss";return null!==t.lastVisit&&(u=t.commentCount+" comment"+a(t.commentCount)),"list"==n&&(u=o({to:e.type,params:{id:e.id}},u)),s.DOM.div({className:"Item__meta"},m&&s.DOM.span({className:"Item__score"},e.score," point",a(e.score))," ",m&&s.DOM.span({className:"Item__by"},"by ",o({to:"user",params:{id:e.by}},e.by))," ",s.DOM.span({className:"Item__time"},l.fromNow()),m&&" | ",m&&u,i)}var s=e("react"),r=e("moment"),i=e("react-router"),a=e("./utils/pluralise"),o=i.Link;t.exports=n},{"./utils/pluralise":16,moment:"moment",react:"react","react-router":"react-router"}],11:[function(e,t){"use strict";function n(e){var t,n=!!e.url;return t=e.dead?"[dead] "+e.title:n?s.DOM.a({href:e.url},e.title):i({to:e.type,params:{id:e.id}},e.title),s.DOM.div({className:"Item__title"},t,n&&" ",n&&s.DOM.span({className:"Item__host"},"(",a(e.url),")"))}var s=e("react"),r=e("react-router"),i=r.Link,a=function(){var e=document.createElement("a");return function(t){e.href=t;var n=e.hostname.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}}();t.exports=n},{react:"react","react-router":"react-router"}],12:[function(e,t){"use strict";function n(){i.set(m+a,c),i.set(m+o,Date.now()),i.set(m+l,p)}var s=e("moment"),r=e("../utils/cancellableDebounce"),i=e("../utils/storage"),a=":cc",o=":lv",l=":mc",m=null,u=null,c=null,d=null,p=null,h=null,f=null,v=r(function(){u({commentCount:c,newCommentCount:d})},100),C=r(function(){h=p,f=!1},5e3);t.exports={init:function(e,t){m=e,u=t,c=0,d=0,p=0,h=i.get(m+l,null),f=null===h,null!==h&&(h=Number(h));var n=i.get(m+o,null);return{lastVisit:null!==n?s(Number(n)):s()}},dispose:function(){null!==m&&(v.cancel(),n(),m=null,u=null)},markAsRead:function(){return d=0,h=p,n(),{lastVisit:s(),prevMaxCommentId:h,newCommentCount:d}},addComment:function(e){c++;var t=null!==h&&e>h;t&&d++,e>p&&(p=e),v(),f&&C()},getCommentStats:function(e){var t=i.get(e+o,null);return{lastVisit:null!==t?s(Number(t)):null,commentCount:Number(i.get(e+a,"0")),prevMaxCommentId:Number(i.get(e+l,"0"))}}}},{"../utils/cancellableDebounce":15,"../utils/storage":18,moment:"moment"}],13:[function(e,t){"use strict";var n=e("firebase"),s=new n("https://hacker-news.firebaseio.com/v0");t.exports={topStoriesRef:function(){return s.child("topstories")},itemRef:function(e){return s.child("item/"+e)},userRef:function(e){return s.child("user/"+e)},fetchItem:function(e,t){this.itemRef(e).once("value",function(e){t(e.val())})}}},{firebase:"firebase"}],14:[function(e,t){"use strict";function n(e,t){var n=[];"undefined"==typeof t?t=e:n.push(e);for(var s=Object.keys(t),r=0,i=s.length;i>r;r++)t[s[r]]&&n.push(s[r]);return n.join(" ")}t.exports=n},{}],15:[function(e,t){"use strict";function n(e,t,n){var s,r,i,a,o,l=function(){var m=Date.now()-a;t>m&&m>0?s=setTimeout(l,t-m):(s=null,n||(o=e.apply(i,r),s||(i=r=null)))},m=function(){i=this,r=arguments,a=Date.now();var m=n&&!s;return s||(s=setTimeout(l,t)),m&&(o=e.apply(i,r),i=r=null),o};return m.cancel=function(){s&&clearTimeout(s)},m}t.exports=n},{}],16:[function(e,t){"use strict";function n(e){return 1==e?"":"s"}t.exports=n},{}],17:[function(e,t){"use strict";function n(e){document.title=e?e+" | "+s:s}var s="React Hacker News";t.exports=n},{}],18:[function(e,t){"use strict";t.exports={get:function(e,t){var n=localStorage[e];return"undefined"!=typeof n?n:t},set:function(e,t){localStorage[e]=t}}},{}]},{},[1]);