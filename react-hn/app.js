webpackJsonp([1],[function(t,e,n){"use strict";function r(t,e,n,r){return a.createClass({render:function(){return a.createElement(y,i({},this.props,{key:t,route:t,type:e,limit:n,title:r}))}})}function o(t){return a.createClass({render:function(){return a.createElement(b,i({},this.props,{key:t,type:t}))}})}var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};n(122);var a=n(2),s=n(26),u=s.IndexRoute,c=s.Link,l=s.Route,h=s.Router,f=n(44),p=n(45),d=n(7),m=n(127),g=n(126),v=n(129),y=n(130),b=n(132),w=n(133),E=a.createClass({displayName:"App",getInitialState:function(){return{showSettings:!1}},componentWillMount:function(){d.load(),f.loadSession(),p.loadSession(),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},handleBeforeUnload:function(){f.saveSession(),p.saveSession()},toggleSettings:function(t){t.preventDefault(),this.setState({showSettings:!this.state.showSettings})},render:function(){return a.createElement("div",{className:"App",onClick:this.state.showSettings&&this.toggleSettings},a.createElement("div",{className:"App__wrap"},a.createElement("div",{className:"App__header"},a.createElement("img",{src:"logo.png",width:"16",height:"16",alt:""})," ",a.createElement(c,{to:"/news",activeClassName:"active",className:"App__homelink"},"React HN")," ",a.createElement(c,{to:"/newest",activeClassName:"active"},"new")," | ",a.createElement(c,{to:"/newcomments",activeClassName:"active"},"comments")," "," | ",a.createElement(c,{to:"/show",activeClassName:"active"},"show")," | ",a.createElement(c,{to:"/ask",activeClassName:"active"},"ask")," | ",a.createElement(c,{to:"/jobs",activeClassName:"active"},"jobs"),a.createElement("a",{className:"App__settings",tabIndex:"0",onClick:this.toggleSettings,onKeyPress:this.toggleSettings},this.state.showSettings?"hide settings":"settings"),this.state.showSettings&&a.createElement(v,{key:"settings"})),a.createElement("div",{className:"App__content"},this.props.children),a.createElement("div",{className:"App__footer"},"react-hn v1.2.0 | ",a.createElement("a",{href:"https://github.com/insin/react-hn"},"insin/react-hn"))))}}),C=a.createClass({displayName:"NotFound",render:function(){return a.createElement("h2",null,"Not found")}}),_=r("ask","askstories",200,"Ask"),x=o("comments"),S=r("jobs","jobstories",200,"Jobs"),T=r("newest","newstories",500,"New Links"),M=r("show","showstories",200,"Show"),k=r("news","topstories",500),N=a.createElement(l,{path:"/",component:E},a.createElement(u,{component:k}),a.createElement(l,{path:"news",component:k}),a.createElement(l,{path:"newest",component:T}),a.createElement(l,{path:"show",component:M}),a.createElement(l,{path:"ask",component:_}),a.createElement(l,{path:"jobs",component:S}),a.createElement(l,{path:"item/:id",component:g}),a.createElement(l,{path:"job/:id",component:g}),a.createElement(l,{path:"poll/:id",component:g}),a.createElement(l,{path:"story/:id",component:g}),a.createElement(l,{path:"comment/:id",component:m}),a.createElement(l,{path:"newcomments",component:x}),a.createElement(l,{path:"user/:id",component:w}),a.createElement(l,{path:"*",component:C}));a.render(a.createElement(h,{routes:N}),document.getElementById("app"))},,,,,,,function(t,e,n){"use strict";var r=n(33),o=n(92),i="settings",a={autoCollapse:!0,replyLinks:!0,showDead:!1,showDeleted:!1,titleFontSize:18,listSpacing:16,load:function(){var t=o.get(i);t&&r(this,JSON.parse(t))},save:function(){o.set(i,JSON.stringify({autoCollapse:this.autoCollapse,replyLinks:this.replyLinks,showDead:this.showDead,showDeleted:this.showDeleted,titleFontSize:this.titleFontSize,listSpacing:this.listSpacing}))}};t.exports=a},,,,,function(t,e,n){"use strict";function r(t,e){a(t).once("value",function(t){e(t.val())})}function o(t,e){function n(n){o.push(n),o.length>=t.length&&e(o)}var o=[];t.forEach(function(t){r(t,n)})}function i(t){return l.child(t)}function a(t){return l.child("item/"+t)}function s(t){return l.child("user/"+t)}function u(){return l.child("updates/items")}var c=n(93),l=new c("https://hacker-news.firebaseio.com/v0");t.exports={fetchItem:r,fetchItems:o,storiesRef:i,itemRef:a,userRef:s,updatesRef:u}},,,,,,,,function(t,e,n){"use strict";var r=n(2),o=r.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var t=this.props.size+"px",e={height:t,width:t,marginRight:this.props.spacing+"px"};return r.createElement("div",{className:"Spinner",style:{width:3*(Number(this.props.size)+Number(this.props.spacing))+"px"}},r.createElement("div",{className:"bounce1",style:e}),r.createElement("div",{className:"bounce2",style:e}),r.createElement("div",{className:"bounce3",style:e}))}});t.exports=o},,,,,,,,,,,,function(t,e){"use strict";function n(t,e){var n=[];"undefined"==typeof e?e=t:n.push(t);for(var r=Object.keys(e),o=0,i=r.length;i>o;o++)e[r[o]]&&n.push(r[o]);return n.join(" ")}t.exports=n},function(t,e){"use strict";function n(t,e,n){for(var r=Object.keys(e),o=0,i=r.length;i>o;o++)t[r[o]]=e[r[o]];if(n)for(r=Object.keys(n),o=0,i=r.length;i>o;o++)t[r[o]]=n[r[o]];return t}t.exports=n},function(t,e,n){"use strict";function r(t){document.title=t?t+" | "+i:i}var o=n(46),i=o.SITE_TITLE;t.exports=r},,,,,,,,,,function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t){for(var e=d[t],n=g[t],r=0,o=e.length;o>r;r++)n[r]=m[e[r]]||null}function a(t,e){return t?JSON.parse(t):e}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,a=n;s=c=u=void 0,r=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(a)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=i,n=a,r=!0}},c=n(62),l=c.EventEmitter,h=n(12),f=n(33),p=null,d={},m={},g={},v=function(t){function e(t){r(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.type=t,t in d||(d[t]=[]),t in g||(g[t]=[],i(t)),this.onStorage=this.onStorage.bind(this),this.onStoriesUpdated=this.onStoriesUpdated.bind(this)}return o(e,t),s(e,[{key:"getState",value:function(){return{ids:d[this.type],stories:g[this.type]}}},{key:"itemUpdated",value:function(t,e){g[this.type][e]=t,m[t.id]=t}},{key:"onStorage",value:function(t){m[t.key]&&this.emit(t.key)}},{key:"onStoriesUpdated",value:function(t){d[this.type]=t.val(),i(this.type),this.emit("update",this.getState())}},{key:"start",value:function(){p=h.storiesRef(this.type),p.on("value",this.onStoriesUpdated),window.addEventListener("storage",this.onStorage)}},{key:"stop",value:function(){null!==p&&(p.off(),p=null),window.removeEventListener("storage",this.onStorage)}}]),e}(l);f(v,{getItem:function(t){return m[t]||null},loadSession:function(){d=a(window.sessionStorage.idCache,{}),m=a(window.sessionStorage.itemCache,{})},saveSession:function(){window.sessionStorage.idCache=JSON.stringify(d),window.sessionStorage.itemCache=JSON.stringify(m)}}),t.exports=v},function(t,e,n){"use strict";function r(t,e){return e.time-t.time}function o(t){var e=Object.keys(t).map(function(e){return t[e]});return e.sort(r),e}function i(){m.comments=a(d.comments),m.stories=a(d.stories)}function a(t){var e=o(t);return e.splice(h,Math.max(0,e.length-h)).forEach(function(e){delete t[e.id]}),e}function s(t){for(var e=0,n=t.length;n>e;e++){var r=t[e];r.deleted||"undefined"!=typeof g[r.type]&&("comment"===r.type?d.comments[r.id]=r:d.stories[r.id]=r)}i(),v.emit("updates",m)}var u=n(62).EventEmitter,c=n(12),l=n(46),h=l.UPDATES_CACHE_SIZE,f=n(33),p=null,d=null,m={},g={comment:!0,job:!0,poll:!0,story:!0},v=f(new u,{loadSession:function(){var t=window.sessionStorage.updates;d=t?JSON.parse(t):{comments:{},stories:{}},i()},saveSession:function(){window.sessionStorage.updates=JSON.stringify(d)},start:function(){null===p&&(p=c.updatesRef(),p.on("value",function(t){c.fetchItems(t.val(),s)}))},stop:function(){p.off(),p=null},getUpdates:function(){return m},getItem:function(t){return d.comments[t]||d.stories[t]||null},getComment:function(t){return d.comments[t]||null},getStory:function(t){return d.stories[t]||null}});v.off=v.removeListener,t.exports=v},function(t,e){"use strict";t.exports={ITEMS_PER_PAGE:30,SITE_TITLE:"React HN",UPDATES_CACHE_SIZE:500}},function(t,e){"use strict";function n(t,e){return(e||",s").split(",")[1===t?0:1]}t.exports=n},,,,,,,,,,,function(t,e,n){"use strict";var r=n(2),o=n(26),i=o.Link,a=n(37),s=n(90),u=n(7),c=n(20),l=n(47),h={fetchAncestors:function(t){var e=this;s.fetchCommentAncestors(t,function(t){e.isMounted()&&e.setState({parent:t.parent,op:t.op})})},renderCommentLoading:function(t){return r.createElement("div",{className:"Comment Comment--loading Comment--level"+this.props.level},(this.props.loadingSpinner||t.delayed)&&r.createElement(c,{size:"20"}),t.delayed&&r.createElement("div",{className:"Comment__text"},"Unable to load comment â€“ this usually indicates the author has configured a delay. Trying again in 30 seconds."))},renderCommentDeleted:function(t,e){return r.createElement("div",{className:e.className},r.createElement("div",{className:"Comment__content"},r.createElement("div",{className:"Comment__meta"},"[deleted] | ",r.createElement("a",{href:"https://news.ycombinator.com/item?id="+t.id},"view on Hacker News"))))},renderError:function(t,e){return r.createElement("div",{className:e.className},r.createElement("div",{className:"Comment__content"},r.createElement("div",{className:"Comment__meta"},"[error] | comment is ",JSON.stringify(t)," | ",r.createElement("a",{href:"https://news.ycombinator.com/item?id="+e.id},"view on Hacker News"))))},renderCollapseControl:function(t){return r.createElement("span",{className:"Comment__collapse",onClick:this.toggleCollapse,onKeyPress:this.toggleCollapse,tabIndex:"0"},"[",t?"+":"â€“","]")},renderCommentMeta:function(t,e){return t.dead&&!u.showDead?r.createElement("div",{className:"Comment__meta"},e.collapsible&&this.renderCollapseControl(e.collapsed),e.collapsible&&" ","[dead]",e.childCounts&&" | ("+e.childCounts.children+" child"+l(e.childCounts.children,",ren"),e.childCounts&&e.childCounts.newComments>0&&", ",e.childCounts&&e.childCounts.newComments>0&&r.createElement("em",null,e.childCounts.newComments," new"),e.childCounts&&")"):r.createElement("div",{className:"Comment__meta"},e.collapsible&&this.renderCollapseControl(e.collapsed),e.collapsible&&" ",r.createElement(i,{to:"/user/"+t.by,className:"Comment__user"},t.by)," ",r.createElement(a,{date:1e3*t.time}),e.link&&" | ",e.link&&r.createElement(i,{to:"/comment/"+t.id},"link"),e.parent&&" | ",e.parent&&r.createElement(i,{to:"/"+this.state.parent.type+"/"+t.parent},"parent"),e.op&&" | on: ",e.op&&r.createElement(i,{to:"/"+this.state.op.type+"/"+this.state.op.id},this.state.op.title),t.dead&&" | [dead]",e.childCounts&&" | ("+e.childCounts.children+" child"+l(e.childCounts.children,",ren"),e.childCounts&&e.childCounts.newComments>0&&", ",e.childCounts&&e.childCounts.newComments>0&&r.createElement("em",null,e.childCounts.newComments," new"),e.childCounts&&")")},renderCommentText:function(t,e){return r.createElement("div",{className:"Comment__text"},!t.dead||u.showDead?r.createElement("div",{dangerouslySetInnerHTML:{__html:t.text}}):"[dead]",u.replyLinks&&e.replyLink&&!t.dead&&r.createElement("p",null,r.createElement("a",{href:"https://news.ycombinator.com/reply?id="+t.id},"reply")))}};t.exports=h},function(t,e,n){"use strict";var r=n(2),o=n(26),i=o.Link,a=n(37),s=n(7),u=n(47),c=function(){var t=document.createElement("a");return function(e){t.href=e;var n=t.hostname.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}}(),l={renderItemMeta:function(t,e){var n=new Date(1e3*t.time);return"job"==t.type?r.createElement("div",{className:"Item__meta"},r.createElement(a,{date:n,className:"Item__time"})):r.createElement("div",{className:"Item__meta"},r.createElement("span",{className:"Item__score"},t.score," point",u(t.score))," ",r.createElement("span",{className:"Item__by"},"by ",r.createElement(i,{to:"/user/"+t.by},t.by))," ",r.createElement(a,{date:n,className:"Item__time"})," | ",r.createElement(i,{to:"/"+t.type+"/"+t.id},t.descendants>0?t.descendants+" comment"+u(t.descendants):"discuss"),e)},renderItemTitle:function(t){var e,n=!!t.url;return e=t.dead?"[dead] "+t.title:n?r.createElement("a",{href:t.url},t.title):r.createElement(i,{to:"/"+t.type+"/"+t.id},t.title),r.createElement("div",{className:"Item__title",style:{fontSize:s.titleFontSize}},e,n&&" ",n&&r.createElement("span",{className:"Item__host"},"(",c(t.url),")"))}};t.exports=l},function(t,e,n){"use strict";function r(t,e){this.itemId=t.id,this.onCommentsChanged=e,this.children={},this.children[t.id]=[],this.isNew={},this.isCollapsed={}}var o=n(33);o(r.prototype,{getChildCounts:function(t){for(var e=0,n=0,r=[t.id];r.length;){for(var o=[],i=0,a=r.length;a>i;i++){var s=this.children[r[i]];s.length&&o.push.apply(o,s)}for(i=0,a=o.length;a>i;i++)this.isNew[o[i]]&&n++;e+=o.length,r=o}return{children:e,newComments:n}},commentAdded:function(t){t.deleted||(this.children[t.id]=[],this.children[t.parent].push(t.id))},commentDeleted:function(t){if(t){var e=this.children[t.parent];e.splice(e.indexOf(t.id),1)}},toggleCollapse:function(t){this.isCollapsed[t]=!this.isCollapsed[t],this.onCommentsChanged({type:"collapse"})}}),t.exports=r},function(t,e,n){"use strict";function r(t){var e=c.get(t);return e?JSON.parse(e):{lastVisit:null,commentCount:0,maxCommentId:0}}function o(t,e,n){i.call(this,t,e),this.startedLoading=Date.now(),this.parents={},this.commentCount=0,this.newCommentCount=0,this.maxCommentId=0,this.loading=!0,this.expectedComments=t.kids?t.kids.length:0,this.itemDescendantCount=t.descendants;var o=r(t.id);this.lastVisit=o.lastVisit,this.prevMaxCommentId=o.maxCommentId,this.isFirstVisit=null===o.lastVisit,n.cached||this.checkLoadCompletion()}var i=n(60),a=n(7),s=n(134),u=n(33),c=(n(47),n(92));o.loadState=r,o.prototype=u(Object.create(i.prototype),{constructor:o,numberOfCommentsChanged:s(function(){this.onCommentsChanged({type:"number"})},123),firstLoadComplete:function(){this.lastVisit=Date.now(),this.prevMaxCommentId=this.maxCommentId,this.isFirstVisit=!1,this.onCommentsChanged({type:"first_load_complete"})},checkLoadCompletion:function(){this.loading&&this.commentCount>=this.expectedComments&&(this.loading=!1,this.isFirstVisit?this.firstLoadComplete():a.autoCollapse&&this.newCommentCount>0&&this.collapseThreadsWithoutNewComments(),this._storeState())},_storeState:function(){c.set(this.itemId,JSON.stringify({lastVisit:Date.now(),commentCount:this.itemDescendantCount,maxCommentId:this.maxCommentId}))},itemUpdated:function(t){this.itemDescendantCount=t.descendants},commentAdded:function(t){return t.deleted?void(this.loading&&(this.expectedComments--,this.checkLoadCompletion())):(i.prototype.commentAdded.call(this,t),t.dead&&!a.showDead?this.expectedComments--:this.commentCount++,this.loading&&t.kids&&(this.expectedComments+=t.kids.length),this.prevMaxCommentId>0&&t.id>this.prevMaxCommentId&&(!t.dead||a.showDead)&&(this.newCommentCount++,this.isNew[t.id]=!0),t.id>this.maxCommentId&&(this.maxCommentId=t.id),t.parent!==this.itemId&&(this.parents[t.id]=t.parent),this.numberOfCommentsChanged(),void(this.loading&&this.checkLoadCompletion()))},commentDelayed:function(t){this.expectedComments--},commentDeleted:function(t){i.prototype.commentDeleted.call(this,t),this.commentCount--,this.isNew[t.id]&&(this.newCommentCount--,delete this.isNew[t.id]),delete this.parents[t.id],this.numberOfCommentsChanged()},commentDied:function(t){a.showDead||(this.commentCount--,this.isNew[t.id]&&(this.newCommentCount--,delete this.isNew[t.id]))},adjustExpectedComments:function(t){this.expectedComments+=t,this.checkLoadCompletion()},collapseThreadsWithoutNewComments:function(){for(var t=Object.keys(this.isNew),e={},n=0,r=t.length;r>n;n++)for(var o=this.parents[t[n]];o&&!e[o];)e[o]=!0,o=this.parents[o];for(var i={},a=this.children[this.itemId];a.length;){var s=[];for(n=0,r=a.length;r>n;n++){var u=a[n];if(e[u]){var c=this.children[u];c.length&&s.push.apply(s,c)}else this.isNew[u]||(i[u]=!0)}a=s}this.isCollapsed=i,this.onCommentsChanged({type:"collapse"})},markAsRead:function(){this.lastVisit=Date.now(),this.newCommentCount=0,this.prevMaxCommentId=this.maxCommentId,this.isNew={},this._storeState()},dispose:function(){this.numberOfCommentsChanged.cancel(),this._storeState()}}),t.exports=o},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(2),o=n(24),i=n(60),a=n(12),s=n(7),u=n(58),c=n(32),l=r.createClass({displayName:"Comment",mixins:[u,o],propTypes:{id:r.PropTypes.number.isRequired,level:r.PropTypes.number.isRequired,loadingSpinner:r.PropTypes.bool,threadStore:r.PropTypes.instanceOf(i).isRequired},getDefaultProps:function(){return{loadingSpinner:!1}},getInitialState:function(){return{comment:{}}},componentWillMount:function(){this.bindFirebaseRef()},componentWillUnmount:function(){this.clearDelayTimeout()},componentDidUpdate:function(t,e){if(!this.state.comment)return void this.props.threadStore.adjustExpectedComments(-1);if(e.comment&&e.comment.id){if(!e.comment.deleted&&this.state.comment.deleted&&this.props.threadStore.commentDeleted(this.state.comment),!e.comment.dead&&this.state.comment.dead)this.props.threadStore.commentDied(this.state.comment);else if(e.comment!==this.state.comment&&this.props.threadStore.loading){var n=this.state.comment.kids?this.state.comment.kids.length:0,r=e.comment.kids?e.comment.kids.length:0;this.props.threadStore.adjustExpectedComments(n-r)}}else this.state.comment.id&&(e.comment&&e.comment.delayed&&this.clearDelayTimeout(),this.props.threadStore.commentAdded(this.state.comment)),e.comment&&!e.comment.delayed&&this.state.comment.delayed&&this.props.threadStore.commentDelayed(this.props.id)},bindFirebaseRef:function(){this.bindAsObject(a.itemRef(this.props.id),"comment",this.handleFirebaseRefCancelled),this.timeout&&(this.timeout=null)},handleFirebaseRefCancelled:function(t){this.unbind("comment"),this.timeout=setTimeout(this.bindFirebaseRef,3e4),this.state.comment&&!this.state.comment.delayed&&(this.state.comment.delayed=!0,this.forceUpdate())},clearDelayTimeout:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},toggleCollapse:function(t){t.preventDefault(),this.props.threadStore.toggleCollapse(this.state.comment.id)},render:function(){var t=this.state.comment,e=this.props;if(!t)return this.renderError(t,{id:this.props.id,className:"Comment Comment--error Comment--level"+e.level});if(!t.id)return this.renderCommentLoading(t);if(t.dead&&!s.showDead)return null;if(t.deleted)return s.showDeleted?this.renderCommentDeleted(t,{className:"Comment Comment--deleted Comment--level"+e.level}):null;var n=e.threadStore.isNew[t.id],o=!!e.threadStore.isCollapsed[t.id],i=o&&e.threadStore.getChildCounts(t);o&&n&&(i.newComments=0);var a=c("Comment Comment--level"+e.level,{"Comment--collapsed":o,"Comment--dead":t.dead,"Comment--new":n});return r.createElement("div",{className:a},r.createElement("div",{className:"Comment__content"},this.renderCommentMeta(t,{collapsible:!0,collapsed:o,link:!0,childCounts:i}),this.renderCommentText(t,{replyLink:!0})),t.kids&&r.createElement("div",{className:"Comment__kids"},t.kids.map(function(t){return r.createElement(l,{key:t,id:t,level:e.level+1,loadingSpinner:e.loadingSpinner,threadStore:e.threadStore})})))}});t.exports=l},function(t,e,n){"use strict";var r=n(2),o=n(26),i=o.Link,a=r.createClass({displayName:"Paginator",_onClick:function(t){setTimeout(function(){window.scrollTo(0,0)},0)},render:function(){return 1!=this.props.page||this.props.hasNext?r.createElement("div",{className:"Paginator"},this.props.page>1&&r.createElement("span",{className:"Paginator__prev"},r.createElement(i,{to:"/"+this.props.route,query:{page:this.props.page-1},onClick:this._onClick},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&r.createElement("span",{className:"Paginator__next"},r.createElement(i,{to:"/"+this.props.route,query:{page:this.props.page+1},onClick:this._onClick},"More"))):null}});t.exports=a},function(t,e,n){"use strict";var r=n(2),o=n(26),i=o.Link,a=n(7),s=n(32),u={getNewCommentCount:function(t,e){return null===e.lastVisit?0:t.descendants-e.commentCount},renderListItem:function(t,e){if(t.deleted)return null;var n=this.getNewCommentCount(t,e);return r.createElement("li",{className:s("ListItem",{"ListItem--dead":t.dead}),style:{marginBottom:a.listSpacing}},this.renderItemTitle(t),this.renderItemMeta(t,n>0&&r.createElement("span",{className:"ListItem__newcomments"}," ","(",r.createElement(i,{to:"/"+t.type+"/"+t.id},n," new"),")")))}};t.exports=u},function(t,e){"use strict";var n={getPageNumber:function(t){return"undefined"==typeof t&&(t=this.props.location.query.page),t&&/^\d+$/.test(t)?Math.max(1,Number(t)):1}};t.exports=n},function(t,e,n){(function(e){"use strict";function r(t,e,n){for(var r=t.id,i=t.parent;u[i]||c[i];){if(n.itemCount++,n.cacheHits++,c[i])return 1===n.itemCount&&(n.parent=c[i]),n.op=c[i],void e(n);u[i]&&(1===n.itemCount&&(n.parent={id:i,type:"comment"}),r=i,i=u[i])}l.getItem(i,function(t){n.itemCount++,u[r]=i,"comment"===t.type&&(u[t.id]=t.parent),o(t,e,n)},n)}function o(t,e,n){1===n.itemCount&&(n.parent=t),"comment"!==t.type?(n.op=t,c[t.id]={id:t.id,type:t.type,title:t.title},e(n)):r(t,e,n)}var i=n(12),a=n(44),s=n(45),u={},c={},l={getItem:function(t,n,r){var o=this.getCachedItem(t);o?(r&&r.cacheHits++,e(n,o)):i.fetchItem(t,n)},getCachedItem:function(t){return a.getItem(t)||s.getItem(t)||null},getCachedStory:function(t){return a.getItem(t)||s.getStory(t)||null},fetchCommentAncestors:function(t,n){var o=Date.now(),i={itemCount:0,cacheHits:0};r(t,function(){i.timeTaken=Date.now()-o,e(n,i)},i)}};t.exports=l}).call(e,n(57).setImmediate)},function(t,e){"use strict";function n(t,e,n){var r=(t-1)*e,o=Math.min(n,r+e),i=n-1>o;return{pageNum:t,startIndex:r,endIndex:o,hasNext:i}}t.exports=n},function(t,e){"use strict";t.exports={get:function(t,e){var n=window.localStorage[t];return"undefined"!=typeof n?n:e},set:function(t,e){window.localStorage[t]=e}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(2),o=n(7),i=n(58),a=n(32),s=r.createClass({displayName:"DisplayComment",mixins:[i],propTypes:{comment:r.PropTypes.object.isRequired},getInitialState:function(){return{op:{},parent:{type:"comment"}}},componentWillMount:function(){this.fetchAncestors(this.props.comment)},render:function(){if(this.props.comment.deleted)return null;if(this.props.comment.dead&&!o.showDead)return null;var t=this.props.comment,e=a("Comment Comment--level0",{"Comment--dead":t.dead});return r.createElement("div",{className:e},r.createElement("div",{className:"Comment__content"},this.renderCommentMeta(t,{link:!0,parent:!!this.state.parent.id&&!!this.state.op.id&&t.parent!=this.state.op.id,op:!!this.state.op.id}),this.renderCommentText(t,{replyLink:!1})))}});t.exports=s},function(t,e,n){"use strict";var r=n(2),o=n(61),i=n(59),a=n(88),s=r.createClass({displayName:"DisplayListItem",mixins:[i,a],propTypes:{item:r.PropTypes.object.isRequired},componentWillMount:function(){this.threadState=o.loadState(this.props.item.id)},render:function(){return this.renderListItem(this.props.item,this.threadState)}});t.exports=s},function(t,e,n){"use strict";function r(t,e,n){return 1==t?e:t+" "+e+"s"}var o=n(2),i=n(24),a=n(37),s=n(12),u=n(61),c=n(90),l=n(86),h=n(128),f=n(20),p=n(59),d=n(32),m=n(34),g=o.createClass({displayName:"Item",mixins:[p,i],getInitialState:function(){return{item:c.getCachedStory(Number(this.props.params.id))||{}}},componentWillMount:function(){this.bindAsObject(s.itemRef(this.props.params.id),"item"),this.state.item.id&&(this.threadStore=new u(this.state.item,this.handleCommentsChanged,{cached:!0}),m(this.state.item.title)),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){this.threadStore&&this.threadStore.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillReceiveProps:function(t){if(this.props.params.id!=t.params.id){this.threadStore.dispose(),this.threadStore=null,this.unbind("item");var e=c.getCachedStory(Number(t.params.id));e&&(this.threadStore=new u(e,this.handleCommentsChanged,{cached:!0}),m(e.title)),this.bindAsObject(s.itemRef(t.params.id),"item"),this.setState({item:e||{}})}},componentWillUpdate:function(t,e){!this.state.item.id&&e.item.id&&m(e.item.title)},componentDidUpdate:function(t,e){if(e.item.id!=this.state.item.id)this.threadStore&&this.threadStore.itemId==this.state.item.id||(this.threadStore=new u(this.state.item,this.handleCommentsChanged,{cached:!1}),m(this.state.item.title),this.forceUpdate());else if(e.item!==this.state.item){if(this.threadStore.loading){var n=this.state.item.kids?this.state.item.kids.length:0,r=e.item.kids?e.item.kids.length:0,o=n-r;0!==o&&this.threadStore.adjustExpectedComments(o)}this.threadStore.itemUpdated(this.state.item)}},handleBeforeUnload:function(){this.threadStore&&this.threadStore.dispose()},handleCommentsChanged:function(t){this.forceUpdate()},autoCollapse:function(t){t.preventDefault(),this.threadStore.collapseThreadsWithoutNewComments()},markAsRead:function(t){t.preventDefault(),this.threadStore.markAsRead(),this.forceUpdate()},render:function(){var t=this.state,e=t.item,n=this.threadStore;return e.id&&n?o.createElement("div",{className:d("Item",{"Item--dead":e.dead})},o.createElement("div",{className:"Item__content"},this.renderItemTitle(e),this.renderItemMeta(e,null!==n.lastVisit&&n.newCommentCount>0&&o.createElement("span",null," ","(",o.createElement("em",null,n.newCommentCount," new")," in the last ",o.createElement(a,{date:n.lastVisit,formatter:r}),") | ",o.createElement("span",{className:"control",tabIndex:"0",onClick:this.autoCollapse,onKeyPress:this.autoCollapse,title:"Collapse threads without new comments"},"auto collapse")," | ",o.createElement("span",{className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),e.text&&o.createElement("div",{className:"Item__text"},o.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})),"poll"==e.type&&o.createElement("div",{className:"Item__poll"},e.parts.map(function(t){return o.createElement(h,{key:t,id:t})}))),e.kids&&o.createElement("div",{className:"Item__kids"},e.kids.map(function(t,e){return o.createElement(l,{key:t,id:t,level:0,loadingSpinner:0===e,threadStore:n})}))):o.createElement("div",{className:"Item Item--loading"},o.createElement(f,{size:"20"}))}});t.exports=g},function(t,e,n){"use strict";var r=n(2),o=n(24),i=n(60),a=n(12),s=n(7),u=n(45),c=n(86),l=n(58),h=n(32),f=n(34),p=r.createClass({displayName:"PermalinkedComment",mixins:[l,o],getDefaultProps:function(){return{level:0,loadingSpinner:!0}},getInitialState:function(){return{comment:u.getComment(this.props.params.id)||{},parent:{type:"comment"},op:{}}},componentWillMount:function(){this.bindAsObject(a.itemRef(this.props.params.id),"comment"),this.state.comment.id&&this.commentLoaded(this.state.comment)},componentWillReceiveProps:function(t){if(t.params.id!=this.props.params.id){var e=u.getComment(t.params.id);e&&(this.commentLoaded(e),this.setState({comment:e})),this.unbind("comment"),this.bindAsObject(a.itemRef(t.params.id),"comment")}},componentWillUpdate:function(t,e){if(e.comment&&this.state.comment.id!=e.comment.id){if(!e.comment.deleted&&"comment"!=e.comment.type)return void this.context.router.replaceWith(e.comment.type,{id:e.comment.id});this.threadStore&&this.threadStore.itemId==e.comment.id||this.commentLoaded(e.comment)}},commentLoaded:function(t){this.setTitle(t),t.deleted||(this.threadStore=new i(t,this.handleCommentsChanged),this.fetchAncestors(t))},setTitle:function(t){if(t.deleted)return f("Deleted comment");var e="Comment by "+t.by;this.state.op.id&&(e+=" | "+this.state.op.title),f(e)},handleCommentsChanged:function(t){"collapse"==t.type&&this.forceUpdate()},render:function(){var t=this.state.comment;if(!t)return this.renderError(t,{id:this.props.params.id,className:"Comment Comment--level0 Comment--error"});if(!t.id)return this.renderCommentLoading(t);if(t.deleted)return this.renderCommentDeleted(t,{className:"Comment Comment--level0 Comment--deleted"});if("comment"!=t.type)return null;var e=h("PermalinkedComment Comment Comment--level0",{"Comment--dead":t.dead}),n=this.threadStore;return r.createElement("div",{className:e},r.createElement("div",{className:"Comment__content"},this.renderCommentMeta(t,{parent:!!this.state.parent.id&&!!this.state.op.id&&t.parent!=this.state.op.id,op:!!this.state.op.id}),(!t.dead||s.showDead)&&this.renderCommentText(t,{replyLink:!0})),t.kids&&r.createElement("div",{className:"Comment__kids"},t.kids.map(function(t,e){return r.createElement(c,{key:t,id:t,level:0,loadingSpinner:0===e,threadStore:n})})))}});t.exports=p},function(t,e,n){"use strict";var r=n(2),o=n(24),i=n(12),a=n(20),s=n(47),u=r.createClass({displayName:"PollOption",mixins:[o],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(i.itemRef(this.props.id),"pollopt")},render:function(){var t=this.state.pollopt;return t.id?r.createElement("div",{className:"PollOption"},r.createElement("div",{className:"PollOption__text"},t.text),r.createElement("div",{className:"PollOption__score"},t.score," point",s(t.score))):r.createElement("div",{className:"PollOption PollOption--loading"},r.createElement(a,{size:"20"}))}});t.exports=u},function(t,e,n){"use strict";var r=n(2),o=n(7),i=r.createClass({displayName:"Settings",componentDidMount:function(){this.refs.container.getDOMNode().focus()},onChange:function(t){var e=t.target;"checkbox"===e.type?o[e.name]=e.checked:"number"===e.type&&e.value&&(o[e.name]=e.value),this.forceUpdate(),o.save()},onClick:function(t){t.stopPropagation()},render:function(){return r.createElement("div",{ref:"container",className:"Settings",tabIndex:"-1",onClick:this.onClick},r.createElement("form",{onChange:this.onChange},r.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},r.createElement("label",{htmlFor:"autoCollapse"},r.createElement("input",{type:"checkbox",name:"autoCollapse",id:"autoCollapse",checked:o.autoCollapse})," auto collapse"),r.createElement("p",null,"Automatically collapse comment threads without new comments on page load.")),r.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},r.createElement("label",{htmlFor:"replyLinks"},r.createElement("input",{type:"checkbox",name:"replyLinks",id:"replyLinks",checked:o.replyLinks})," show reply links"),r.createElement("p",null,'Show "reply" links to Hacker News')),r.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},r.createElement("label",{htmlFor:"showDead"},r.createElement("input",{type:"checkbox",name:"showDead",id:"showDead",checked:o.showDead})," show dead"),r.createElement("p",null,"Show items flagged as dead.")),r.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},r.createElement("label",{htmlFor:"showDeleted"},r.createElement("input",{type:"checkbox",name:"showDeleted",id:"showDeleted",checked:o.showDeleted})," show deleted"),r.createElement("p",null,"Show comments flagged as deleted in threads.")),r.createElement("div",{
className:"Settings__setting"},r.createElement("table",null,r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,r.createElement("label",{htmlFor:"titleFontSize"},"title font size:")),r.createElement("td",null,r.createElement("input",{type:"number",min:"13.333",step:"1",name:"titleFontSize",id:"titleFontSize",value:o.titleFontSize}))),r.createElement("tr",null,r.createElement("td",null,r.createElement("label",{htmlFor:"listSpacing"},"list spacing:")),r.createElement("td",null,r.createElement("input",{type:"number",min:"0",name:"listSpacing",id:"listSpacing",value:o.listSpacing}))))))))}});t.exports=i},function(t,e,n){"use strict";var r=n(2),o=n(44),i=n(89),a=n(87),s=n(20),u=n(131),c=n(7),l=n(46),h=l.ITEMS_PER_PAGE,f=n(91),p=n(34),d=r.createClass({displayName:"Stories",mixins:[i],propTypes:{limit:r.PropTypes.number.isRequired,route:r.PropTypes.string.isRequired,type:r.PropTypes.string.isRequired,title:r.PropTypes.string},getInitialState:function(){return{ids:[],limit:this.props.limit,stories:[]}},componentWillMount:function(){p(this.props.title),this.store=new o(this.props.type),this.store.addListener("update",this.handleUpdate),this.store.start(),this.setState(this.store.getState())},componentWillUnmount:function(){this.store.removeListener("update",this.handleUpdate),this.store.stop(),this.store=null},handleUpdate:function(t){this.isMounted()&&(t.limit=t.ids.length,this.setState(t))},render:function(){var t=f(this.getPageNumber(),h,this.state.limit);if(0===this.state.stories.length&&0===this.state.ids.length){for(var e=[],n=t.startIndex;n<t.endIndex;n++)e.push(r.createElement("li",{key:n,className:"ListItem ListItem--loading",style:{marginBottom:c.listSpacing}},r.createElement(s,null)));return r.createElement("div",{className:"Items Items--loading"},r.createElement("ol",{className:"Items__list",start:t.startIndex+1},e),r.createElement(a,{route:this.props.route,page:t.pageNum,hasNext:t.hasNext}))}return r.createElement("div",{className:"Items"},r.createElement("ol",{className:"Items__list",start:t.startIndex+1},this.renderItems(t.startIndex,t.endIndex)),r.createElement(a,{route:this.props.route,page:t.pageNum,hasNext:t.hasNext}))},renderItems:function(t,e){for(var n=[],o=t;e>o;o++){var i=this.state.stories[o],a=this.state.ids[o];a?n.push(r.createElement(u,{key:a,id:a,index:o,cachedItem:i,store:this.store})):n.push(r.createElement(u,{cachedItem:i,store:this.store}))}return n}});t.exports=d},function(t,e,n){"use strict";var r=n(2),o=n(24),i=n(61),a=n(12),s=n(7),u=n(44),c=n(59),l=n(88),h=n(20),f=r.createClass({displayName:"StoryListItem",mixins:[c,l,o],propTypes:{store:r.PropTypes.instanceOf(u).isRequired,id:r.PropTypes.number,cachedItem:r.PropTypes.object,index:r.PropTypes.number},getDefaultProps:function(){return{id:null,cachedItem:null,index:null}},getInitialState:function(){return{item:this.props.cachedItem||{}}},componentWillMount:function(){null!=this.props.id?this.initLiveItem(this.props):null!=this.props.cachedItem&&(this.threadState=i.loadState(this.state.item.id))},componentWillUnmount:function(){null!=this.props.id&&this.props.store.removeListener(this.props.id,this.updateThreadState)},componentWillReceiveProps:function(t){null==this.props.id&&null!=t.id&&this.initLiveItem(t)},componentWillUpdate:function(t,e){this.state.item!==e.item&&null!=e.item&&this.props.store.itemUpdated(e.item,this.props.index)},initLiveItem:function(t){this.bindAsObject(a.itemRef(t.id),"item"),this.threadState=i.loadState(t.id),this.props.store.addListener(t.id,this.updateThreadState)},updateThreadState:function(){this.threadState=i.loadState(this.props.id),this.forceUpdate()},render:function(){return this.state.item&&this.state.item.id?this.renderListItem(this.state.item,this.threadState):r.createElement("li",{className:"ListItem ListItem--loading",style:{marginBottom:s.listSpacing}},r.createElement(h,null))}});t.exports=f},function(t,e,n){"use strict";function r(t){return!t.dead}function o(t){return a.showDead?t:{comments:t.comments.filter(r),stories:t.stories.filter(r)}}var i=n(2),a=n(7),s=n(45),u=n(125),c=n(124),l=n(87),h=n(20),f=n(89),p=n(46),d=p.ITEMS_PER_PAGE,m=n(91),g=n(34),v=i.createClass({displayName:"Updates",mixins:[f],getInitialState:function(){return o(s.getUpdates())},componentWillMount:function(){this.setTitle(this.props.type),s.start(),s.on("updates",this.handleUpdates)},componentWillUnmount:function(){s.off("updates",this.handleUpdates),s.stop()},componentWillReceiveProps:function(t){this.props.type!=t.type&&this.setTitle(t.type)},setTitle:function(t){g("New "+("comments"==t?"Comments":"Links"))},handleUpdates:function(t){this.isMounted()&&this.setState(o(t))},render:function(){var t="comments"==this.props.type?this.state.comments:this.state.stories;if(0===t.length)return i.createElement("div",{className:"Updates Updates--loading"},i.createElement(h,{size:"20"}));var e=m(this.getPageNumber(),d,t.length);return"comments"==this.props.type?i.createElement("div",{className:"Updates Comments"},t.slice(e.startIndex,e.endIndex).map(function(t){return i.createElement(c,{key:t.id,id:t.id,comment:t})}),i.createElement(l,{route:"newcomments",page:e.pageNum,hasNext:e.hasNext})):i.createElement("div",{className:"Updates Items"},i.createElement("ol",{className:"Items__list",start:e.startIndex+1},t.slice(e.startIndex,e.endIndex).map(function(t){return i.createElement(u,{key:t.id,item:t})})),i.createElement(l,{route:"newest",page:e.pageNum,hasNext:e.hasNext}))}});t.exports=v},function(t,e,n){"use strict";var r=n(2),o=n(24),i=n(37),a=n(12),s=n(20),u=n(34),c=r.createClass({displayName:"UserProfile",mixins:[o],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(a.userRef(this.props.params.id),"user")},componentWillUpdate:function(t,e){this.state.user.id!=e.user.id&&u("Profile: "+e.user.id)},componentWillReceiveProps:function(t){this.props.params.id!=t.params.id&&(this.unbind("user"),this.bindAsObject(a.userRef(t.params.id),"user"))},render:function(){var t=this.state.user;if(!t.id)return r.createElement("div",{className:"UserProfile UserProfile--loading"},r.createElement("h4",null,this.props.params.id),r.createElement(s,{size:"20"}));var e=new Date(1e3*t.created);return r.createElement("div",{className:"UserProfile"},r.createElement("h4",null,t.id),r.createElement("dl",null,r.createElement("dt",null,"Created"),r.createElement("dd",null,r.createElement(i,{date:e})," (",e.toDateString(),")"),r.createElement("dt",null,"Karma"),r.createElement("dd",null,t.karma),r.createElement("dt",null,"Delay"),r.createElement("dd",null,t.delay),t.about&&r.createElement("dt",null,"About"),t.about&&r.createElement("dd",null,r.createElement("div",{className:"UserProfile__about",dangerouslySetInnerHTML:{__html:t.about}}))))}});t.exports=c},function(t,e){"use strict";function n(t,e,n){var r,o,i,a,s,u=function l(){var u=Date.now()-a;e>u&&u>0?r=setTimeout(l,e-u):(r=null,n||(s=t.apply(i,o),r||(i=o=null)))},c=function(){i=this,o=arguments,a=Date.now();var c=n&&!r;return r||(r=setTimeout(u,e)),c&&(s=t.apply(i,o),i=o=null),s};return c.cancel=function(){r&&clearTimeout(r)},c}t.exports=n}]);
//# sourceMappingURL=app.js.map